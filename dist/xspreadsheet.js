!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.x_data_spreadsheet=e():t.x_data_spreadsheet=e()}(window,function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=22)}([function(t,e,n){"use strict";function r(t){return function(t){if(Array.isArray(t))return t}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}n.d(e,"a",function(){return o}),n.d(e,"b",function(){return a});var o=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),"string"==typeof e?(this.el=document.createElement(e),this.el.className=n):this.el=e,this.data={}}var e,n,o;return e=t,(n=[{key:"data",value:function(t,e){return void 0!==e?(this.data[t]=e,this):this.data[t]}},{key:"on",value:function(t,e){var n=r(t.split(".")),i=n[0],o=n.slice(1),a=i;return"mousewheel"===a&&/Firefox/i.test(window.navigator.userAgent)&&(a="DOMMouseScroll"),this.el.addEventListener(a,function(t){e(t);for(var n=0;n<o.length;n+=1){var r=o[n];if("left"===r&&0!==t.button)return;if("right"===r&&2!==t.button)return;"stop"===r&&t.stopPropagation()}}),this}},{key:"offset",value:function(t){var e=this;if(void 0!==t)return Object.keys(t).forEach(function(n){e.css(n,"".concat(t[n],"px"))}),this;var n=this.el;return{top:n.offsetTop,left:n.offsetLeft,height:n.offsetHeight,width:n.offsetWidth}}},{key:"scroll",value:function(t){var e=this.el;return void 0!==t&&(void 0!==t.left&&(e.scrollLeft=t.left),void 0!==t.top&&(e.scrollTop=t.top)),{left:e.scrollLeft,top:e.scrollTop}}},{key:"box",value:function(){return this.el.getBoundingClientRect()}},{key:"parent",value:function(){return new t(this.el.parentNode)}},{key:"children",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return 0===arguments.length?this.el.childNodes:(n.forEach(function(e){return t.child(e)}),this)}},{key:"removeChild",value:function(t){this.el.removeChild(t)}},{key:"child",value:function(e){var n=e;return"string"==typeof e?n=document.createTextNode(e):e instanceof t&&(n=e.el),this.el.appendChild(n),this}},{key:"contains",value:function(t){return this.el.contains(t)}},{key:"className",value:function(t){return void 0!==t?(this.el.className=t,this):this.el.className}},{key:"addClass",value:function(t){return this.el.classList.add(t),this}},{key:"hasClass",value:function(t){return this.el.classList.contains(t)}},{key:"removeClass",value:function(t){return this.el.classList.remove(t),this}},{key:"toggle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"active";return this.toggleClass(t)}},{key:"toggleClass",value:function(t){return this.el.classList.toggle(t)}},{key:"active",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"active";return t?this.addClass(e):this.removeClass(e),this}},{key:"checked",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.active(t,"checked"),this}},{key:"disabled",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return t?this.addClass("disabled"):this.removeClass("disabled"),this}},{key:"attr",value:function(t,e){var n=this;if(void 0!==e)this.el.setAttribute(t,e);else{if("string"==typeof t)return this.el.getAttribute(t);Object.keys(t).forEach(function(e){n.el.setAttribute(e,t[e])})}return this}},{key:"removeAttr",value:function(t){return this.el.removeAttribute(t),this}},{key:"html",value:function(t){return void 0!==t?(this.el.innerHTML=t,this):this.el.innerHTML}},{key:"val",value:function(t){return void 0!==t?(this.el.value=t,this):this.el.value}},{key:"focus",value:function(){this.el.focus()}},{key:"cssRemoveKeys",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return n.forEach(function(e){return t.el.style.removeProperty(e)}),this}},{key:"css",value:function(t,e){var n=this;return void 0===e&&"string"!=typeof t?(Object.keys(t).forEach(function(e){n.el.style[e]=t[e]}),this):void 0!==e?(this.el.style[t]=e,this):this.el.style[t]}},{key:"computedStyle",value:function(){return window.getComputedStyle(this.el,null)}},{key:"show",value:function(){return this.css("display","block"),this}},{key:"hide",value:function(){return this.css("display","none"),this}}])&&i(e.prototype,n),o&&i(e,o),t}(),a=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new o(t,e)}},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r="x-spreadsheet";window.devicePixelRatio},function(t,e,n){"use strict";n.d(e,"a",function(){return s}),n.d(e,"b",function(){return a}),n.d(e,"c",function(){return l});var r=["en"],i={en:{toolbar:{undo:"Undo",redo:"Redo",print:"Print",paintformat:"Paint format",clearformat:"Clear format",format:"Format",fontName:"Font",fontSize:"Font size",fontBold:"Font bold",fontItalic:"Font italic",underline:"Underline",strike:"Strike",color:"Text color",bgcolor:"Fill color",border:"Borders",merge:"Merge cells",align:"Horizontal align",valign:"Vertical align",textwrap:"Text wrapping",freeze:"Freeze cell",autofilter:"Filter",formula:"Functions",more:"More"},contextmenu:{copy:"Copy",cut:"Cut",paste:"Paste",pasteValue:"Paste values only",pasteFormat:"Paste format only",hide:"Hide",insertRow:"Insert row",insertColumn:"Insert column",deleteSheet:"Delete",deleteRow:"Delete row",deleteColumn:"Delete column",deleteCell:"Delete cell",deleteCellText:"Delete cell text",validation:"Data validations",cellprintable:"Enable export",cellnonprintable:"Disable export",celleditable:"Enable editing",cellnoneditable:"Disable editing"},print:{size:"Paper size",orientation:"Page orientation",orientations:["Landscape","Portrait"]},format:{general:"General",text:"Plain Text",number:"Number",percent:"Percent",rmb:"RMB",usd:"USD",eur:"EUR",date:"Date",time:"Time",datetime:"Date time",duration:"Duration",longdate:"Long Date",dateformat:"mm/dd/yyyy"},formula:{sum:"Sum",average:"Average",max:"Max",min:"Min",_if:"IF",and:"AND",or:"OR",concat:"Concat",product:"Product",count:"Count",mod:"Mod",power:"Power",ceiling:"Ceiling",floor:"Floor",len:"Length",replace:"Replace",substitute:"Substitute",vlookup:"Vertical Lookup"},validation:{required:"it must be required",notMatch:"it not match its validation rule",between:"it is between {} and {}",notBetween:"it is not between {} and {}",notIn:"it is not in list",equal:"it equal to {}",notEqual:"it not equal to {}",lessThan:"it less than {}",lessThanEqual:"it less than or equal to {}",greaterThan:"it greater than {}",greaterThanEqual:"it greater than or equal to {}"},error:{pasteForMergedCell:"Unable to do this for merged cells"},calendar:{weeks:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"]},button:{next:"Next",cancel:"Cancel",remove:"Remove",save:"Save",ok:"OK"},sort:{desc:"Sort Z -> A",asc:"Sort A -> Z"},filter:{empty:"empty"},dataValidation:{mode:"Mode",range:"Cell Range",criteria:"Criteria",modeType:{cell:"Cell",column:"Colun",row:"Row"},type:{list:"List",number:"Number",date:"Date",phone:"Phone",email:"Email"},operator:{be:"between",nbe:"not betwwen",lt:"less than",lte:"less than or equal to",gt:"greater than",gte:"greater than or equal to",eq:"equal to",neq:"not equal to"}}}};function o(t,e){if(e)for(var n=0,i=r;n<i.length;n++){var o=i[n];if(!e[o])break;for(var a=e[o],l=t.match(/(?:\\.|[^.])+/g),s=0;s<l.length;s+=1){var c=a[l[s]];if(!c)break;if(s===l.length-1)return c;a=c}}}function a(t){var e=o(t,i);return!e&&window&&window.x_spreadsheet&&window.x_spreadsheet.$messages&&(e=o(t,window.x_spreadsheet.$messages)),e||t}function l(t){return function(){return a(t)}}function s(t,e){arguments.length>2&&void 0!==arguments[2]&&arguments[2]?r=[t]:r.unshift(t),e&&(i[t]=e)}},function(t,e,n){"use strict";function r(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function i(t,e,n){t.addEventListener(e,n)}function o(t,e,n){t.removeEventListener(e,n)}function a(t){t.xclickoutside&&(o(window.document.body,"click",t.xclickoutside),delete t.xclickoutside)}function l(t,e){t.xclickoutside=function(n){2===n.detail||t.contains(n.target)||(e?e(t):(t.hide(),a(t)))},i(window.document.body,"click",t.xclickoutside)}function s(t,e,n){i(t,"mousemove",e),t.xEvtUp=function(r){o(t,"mousemove",e),o(t,"mouseup",t.xEvtUp),n(r)},i(t,"mouseup",t.xEvtUp)}function c(t,e,n,r){Math.abs(t)>Math.abs(e)?r(t>0?"right":"left",t,n):r(e>0?"down":"up",e,n)}function u(t,e){var n=e.move,r=e.end,o=0,a=0;i(t,"touchstart",function(t){var e=t.touches[0],n=e.pageX,r=e.pageY;o=n,a=r}),i(t,"touchmove",function(t){if(n){var e=t.changedTouches[0],r=e.pageX,i=e.pageY,l=r-o,s=i-a;(Math.abs(l)>10||Math.abs(s)>10)&&(c(l,s,t,n),o=r,a=i),t.preventDefault()}}),i(t,"touchend",function(t){if(r){var e=t.changedTouches[0],n=e.pageX,i=e.pageY;c(n-o,i-a,t,r)}})}function f(){var t=new Map;function e(e,n){var r;return t.has(e)&&(r=t.get(e),Array.isArray(r)&&r.push(n)||!1)||t.set(e,[].concat(n))}function n(e,n){var r,i;return t.has(e)&&(r=t.get(e),(i=r.indexOf(n))>=0&&r.splice(i,1)&&0===t.get(e).length&&t.delete(e))}return{get current(){return t},on:e,once:function(t,r){return e(t,function e(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];r.call.apply(r,[null].concat(o)),n(t,e)})},fire:function(e,n){return t.has(e)&&function(){var i=t.get(e),o=!0,a=!1,l=void 0;try{for(var s,c=i[Symbol.iterator]();!(o=(s=c.next()).done);o=!0){var u=s.value;u.call.apply(u,[null].concat(r(n)))}}catch(t){a=!0,l=t}finally{try{o||null==c.return||c.return()}finally{if(a)throw l}}}()},removeListener:n,removeAllListeners:function(){t.clear()}}}n.d(e,"a",function(){return i}),n.d(e,"f",function(){return o}),n.d(e,"g",function(){return a}),n.d(e,"b",function(){return l}),n.d(e,"e",function(){return s}),n.d(e,"c",function(){return u}),n.d(e,"d",function(){return f})},function(t,e,n){"use strict";var r=n(0),i=n(1);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function l(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}n.d(e,"a",function(){return h});var u={undo:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" version="1.1">\n    <g><path  fill-rule="evenodd" d="M11.5656391,4.43436088 L9,7 L16,7 L16,0 L13.0418424,2.95815758 C11.5936787,1.73635959 9.72260775,1 7.67955083,1 C4.22126258,1 1.25575599,3.10984908 0,6 L2,7 C2.93658775,4.60974406 5.12943697,3.08011229 7.67955083,3 C9.14881247,3.0528747 10.4994783,3.57862053 11.5656391,4.43436088 Z" transform="matrix(-1 0 0 1 17 5)"/>\n    </g>\n</svg>',redo:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" version="1.1">\n    <g>\n        <path fill-rule="evenodd"\n            d="M11.5656391,4.43436088 L9,7 L16,7 L16,0 L13.0418424,2.95815758 C11.5936787,1.73635959 9.72260775,1 7.67955083,1 C4.22126258,1 1.25575599,3.10984908 0,6 L2,7 C2.93658775,4.60974406 5.12943697,3.08011229 7.67955083,3 C9.14881247,3.0528747 10.4994783,3.57862053 11.5656391,4.43436088 Z"\n            transform="translate(1 5)" />\n    </g>\n</svg>',print:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" version="1.1">\n    <g>\n        <path fill-rule="evenodd"\n            d="M13,14 L3,14 L3,11 L0,11 L0,6.00591905 C0,4.89808055 0.894513756,4 1.99406028,4 L14.0059397,4 C15.1072288,4 16,4.88655484 16,6.00591905 L16,11 L13,11 L13,14 Z M5,9 L11,9 L11,12 L5,12 L5,9 Z M3,0 L13,0 L13,3 L3,3 L3,0 Z M12,6 L14,6 L14,8 L12,8 L12,6 Z"\n            transform="translate(1 2)" />\n    </g>\n</svg>\n    ',paintformat:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" version="1.1">\n    <g>\n        <path fill-rule="evenodd"\n            d="M9,0 L1,0 C0.45,0 0,0.45 0,1 L0,4 C0,4.55 0.45,5 1,5 L9,5 C9.55,5 10,4.55 10,4 L10,3 L11,3 L11,6 L4,6 L4,14 L6,14 L6,8 L13,8 L13,2 L10,2 L10,1 C10,0.45 9.55,0 9,0 Z"\n            transform="translate(3 2)" />\n    </g>\n</svg>',clearformat:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" version="1.1">\n    <g>\n        <path fill-rule="evenodd"\n            d="M0.27,1.55 L5.43,6.7 L3,12 L5.5,12 L7.14,8.42 L11.73,13 L13,11.73 L1.55,0.27 L0.27,1.55 L0.27,1.55 Z M3.82,0 L5.82,2 L7.58,2 L7.03,3.21 L8.74,4.92 L10.08,2 L14,2 L14,0 L3.82,0 L3.82,0 Z"\n            transform="translate(2 3)" />\n    </g>\n</svg>',"font-bold":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" version="1.1">\n    <g>\n        <path fill-rule="evenodd"\n            d="M9,3.5 C9,1.57 7.43,0 5.5,0 L1.77635684e-15,0 L1.77635684e-15,12 L6.25,12 C8.04,12 9.5,10.54 9.5,8.75 C9.5,7.45 8.73,6.34 7.63,5.82 C8.46,5.24 9,4.38 9,3.5 Z M5,2 C5.82999992,2 6.5,2.67 6.5,3.5 C6.5,4.33 5.82999992,5 5,5 L3,5 L3,2 L5,2 Z M3,10 L3,7 L5.5,7 C6.32999992,7 7,7.67 7,8.5 C7,9.33 6.32999992,10 5.5,10 L3,10 Z"\n            transform="translate(4 3)" />\n    </g>\n</svg>',"font-italic":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" version="1.1">\n    <g>\n        <polygon fill-rule="evenodd"\n            points="4 0 4 2 6.58 2 2.92 10 0 10 0 12 8 12 8 10 5.42 10 9.08 2 12 2 12 0"\n            transform="translate(3 3)" />\n    </g>\n</svg>\n    ',underline:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" version="1.1">\n    <g>\n        <path\n            d="M6,12 C8.76,12 11,9.76 11,7 L11,0 L9,0 L9,7 C9,8.75029916 7.49912807,10 6,10 C4.50087193,10 3,8.75837486 3,7 L3,0 L1,0 L1,7 C1,9.76 3.24,12 6,12 Z M0,13 L0,15 L12,15 L12,13 L0,13 Z"\n            transform="translate(3 3)" />\n    </g>\n</svg>',strike:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" version="1.1">\n    <g>\n        <path fill-rule="evenodd"\n            d="M2.8875,3.06 C2.8875,2.6025 2.985,2.18625 3.18375,1.8075 C3.3825,1.42875 3.66,1.10625 4.02,0.84 C4.38,0.57375 4.80375,0.3675 5.29875,0.22125 C5.79375,0.075 6.33375,0 6.92625,0 C7.53375,0 8.085,0.0825 8.58,0.25125 C9.075,0.42 9.49875,0.6525 9.85125,0.95625 C10.20375,1.25625 10.47375,1.6125 10.665,2.02875 C10.85625,2.44125 10.95,2.895 10.95,3.38625 L8.6925,3.38625 C8.6925,3.1575 8.655,2.94375 8.58375,2.74875 C8.5125,2.55 8.4,2.38125 8.25,2.2425 C8.1,2.10375 7.9125,1.99125 7.6875,1.91625 C7.4625,1.8375 7.19625,1.8 6.88875,1.8 C6.5925,1.8 6.3375,1.83375 6.11625,1.8975 C5.89875,1.96125 5.71875,2.05125 5.57625,2.1675 C5.43375,2.28375 5.325,2.41875 5.25375,2.5725 C5.1825,2.72625 5.145,2.895 5.145,3.0675 C5.145,3.4275 5.32875,3.73125 5.69625,3.975 C5.71780203,3.98908066 5.73942012,4.00311728 5.76118357,4.01733315 C6.02342923,4.18863185 6.5,4.5 7,5 L4,5 C4,5 3.21375,4.37625 3.17625,4.30875 C2.985,3.9525 2.8875,3.53625 2.8875,3.06 Z M14,6 L0,6 L0,8 L7.21875,8 C7.35375,8.0525 7.51875,8.105 7.63125,8.15375 C7.90875,8.2775 8.12625,8.40875 8.28375,8.53625 C8.44125,8.6675 8.54625,8.81 8.6025,8.96 C8.65875,9.11375 8.685,9.28625 8.685,9.47375 C8.685,9.65 8.65125,9.815 8.58375,9.965 C8.51625,10.11875 8.41125,10.25 8.2725,10.35875 C8.13375,10.4675 7.95375,10.55375 7.74,10.6175 C7.5225,10.68125 7.27125,10.71125 6.97875,10.71125 C6.6525,10.71125 6.35625,10.6775 6.09,10.61375 C5.82375,10.55 5.59875,10.445 5.41125,10.3025 C5.22375,10.16 5.0775,9.9725 4.9725,9.74375 C4.8675,9.515 4.78125,9.17 4.78125,9 L2.55,9 C2.55,9.2525 2.61,9.6875 2.72625,10.025 C2.8425,10.3625 3.0075,10.66625 3.21375,10.9325 C3.42,11.19875 3.6675,11.4275 3.94875,11.6225 C4.23,11.8175 4.53375,11.9825 4.86375,12.11 C5.19375,12.24125 5.535,12.33875 5.89875,12.39875 C6.25875,12.4625 6.6225,12.4925 6.9825,12.4925 C7.5825,12.4925 8.13,12.425 8.6175,12.28625 C9.105,12.1475 9.525,11.94875 9.87,11.69375 C10.215,11.435 10.48125,11.12 10.6725,10.74125 C10.86375,10.3625 10.95375,9.935 10.95375,9.455 C10.95375,9.005 10.875,8.6 10.72125,8.24375 C10.68375,8.1575 10.6425,8.075 10.59375,7.9925 L14,8 L14,6 Z"\n            transform="translate(2 3)" />\n    </g>\n</svg>\n    ',color:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" version="1.1">\n    <g>\n        <path fill-rule="evenodd"\n            d="M7,0 L5,0 L0.5,12 L2.5,12 L3.62,9 L8.37,9 L9.49,12 L11.49,12 L7,0 L7,0 Z M4.38,7 L6,2.67 L7.62,7 L4.38,7 L4.38,7 Z"\n            transform="translate(3 1)" />\n    </g>\n</svg>',bgcolor:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" version="1.1">\n    <g fill-rule="evenodd">\n        <path\n            d="M14.5,8.87 C14.5,8.87 13,10.49 13,11.49 C13,12.32 13.67,12.99 14.5,12.99 C15.33,12.99 16,12.32 16,11.49 C16,10.5 14.5,8.87 14.5,8.87 L14.5,8.87 Z M12.71,6.79 L5.91,0 L4.85,1.06 L6.44,2.65 L2.29,6.79 C1.9,7.18 1.9,7.81 2.29,8.2 L6.79,12.7 C6.99,12.9 7.24,13 7.5,13 C7.76,13 8.01,12.9 8.21,12.71 L12.71,8.21 C13.1,7.82 13.1,7.18 12.71,6.79 L12.71,6.79 Z M4.21,7 L7.5,3.71 L10.79,7 L4.21,7 L4.21,7 Z" />\n    </g>\n</svg>\n    ',merge:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" version="1.1">\n    <g>\n        <path fill-rule="evenodd"\n            d="M3,6 L1,6 L1,2 L8,2 L8,4 L3,4 L3,6 Z M10,4 L10,2 L17,2 L17,6 L15,6 L15,4 L10,4 Z M10,14 L15,14 L15,12 L17,12 L17,16 L10,16 L10,14 Z M1,12 L3,12 L3,14 L8,14 L8,16 L1,16 L1,12 Z M1,8 L5,8 L5,6 L8,9 L5,12 L5,10 L1,10 L1,8 Z M10,9 L13,6 L13,8 L17,8 L17,10 L13,10 L13,12 L10,9 Z" />\n    </g>\n</svg>',"align-left":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" version="1.1">\n    <g>\n        <path fill-rule="evenodd"\n            d="M0,14 L10,14 L10,12 L0,12 L0,14 Z M10,4 L0,4 L0,6 L10,6 L10,4 Z M0,0 L0,2 L14,2 L14,0 L0,0 Z M0,10 L14,10 L14,8 L0,8 L0,10 Z"\n            transform="translate(2)" />\n    </g>\n</svg>',"align-center":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" version="1.1">\n    <g>\n        <path fill-rule="evenodd"\n            d="M2,12 L2,14 L12,14 L12,12 L2,12 Z M2,4 L2,6 L12,6 L12,4 L2,4 Z M0,10 L14,10 L14,8 L0,8 L0,10 Z M0,0 L0,2 L14,2 L14,0 L0,0 Z"\n            transform="translate(2 2)" />\n    </g>\n</svg>',"align-right":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" version="1.1">\n    <g>\n        <path fill-rule="evenodd"\n            d="M4,14 L14,14 L14,12 L4,12 L4,14 Z M0,10 L14,10 L14,8 L0,8 L0,10 Z M0,0 L0,2 L14,2 L14,0 L0,0 Z M4,6 L14,6 L14,4 L4,4 L4,6 Z"\n            transform="translate(2 2)" />\n    </g>\n</svg>',"align-top":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" version="1.1">\n    <g>\n        <path fill-rule="evenodd"\n            d="M0,0 L0,2 L12,2 L12,0 L0,0 L0,0 Z M2.5,7 L5,7 L5,14 L7,14 L7,7 L9.5,7 L6,3.5 L2.5,7 L2.5,7 Z"\n            transform="translate(3 2)" />\n    </g>\n</svg>',"align-middle":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="18" version="1.1">\n    <g>\n        <path fill-rule="evenodd"\n            d="M9.5,3 L7,3 L7,0 L5,0 L5,3 L2.5,3 L6,6.5 L9.5,3 L9.5,3 Z M0,8 L0,10 L12,10 L12,8 L0,8 L0,8 Z M2.5,15 L5,15 L5,18 L7,18 L7,15 L9.5,15 L6,11.5 L2.5,15 L2.5,15 Z"\n            transform="translate(3)" />\n    </g>\n</svg>\n    ',"align-bottom":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" version="1.1">\n    <g>\n        <path fill-rule="evenodd"\n            d="M9.5,7 L7,7 L7,0 L5,0 L5,7 L2.5,7 L6,10.5 L9.5,7 L9.5,7 Z M0,12 L0,14 L12,14 L12,12 L0,12 L0,12 Z"\n            transform="translate(3 2)" />\n    </g>\n</svg>\n    ',textwrap:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" version="1.1">\n    <g>\n        <path fill-rule="evenodd"\n            d="M14,0 L0,0 L0,2 L14,2 L14,0 Z M0,12 L4,12 L4,10 L0,10 L0,12 Z M11.5,5 L0,5 L0,7 L11.75,7 C12.58,7 13.25,7.67 13.25,8.5 C13.25,9.33 12.58,10 11.75,10 L9,10 L9,8 L6,11 L9,14 L9,12 L11.5,12 C13.43,12 15,10.43 15,8.5 C15,6.57 13.43,5 11.5,5 Z"\n            transform="translate(2 3)" />\n    </g>\n</svg>',autofilter:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" version="1.1">\n    <g>\n        <path fill-rule="evenodd"\n            d="M0,0 L0,1 L6,7 L6,12 L8,11 L8,7 L14,1 L14,0 L0,0 Z M4,3 L10,3 L7,6 L4,3 Z"\n            transform="translate(2 3)" />\n    </g>\n</svg>\n    ',formula:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" version="1.1">\n    <g>\n        <polygon fill-rule="evenodd"\n            points="10 0 0 0 0 1.8 5.5 7 0 12.2 0 14 10 14 10 12 3.1 12 8 7 3.1 2 10 2"\n            transform="translate(4 2)" />\n    </g>\n</svg>',"arrow-down":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" version="1.1">\n    <g>\n        <polygon fill-rule="evenodd" points="0 0 4 4 8 0" transform="translate(0 7)" />\n    </g>\n</svg>',"arrow-right":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" version="1.1">\n    <g>\n        <polygon fill-rule="evenodd" points="-2 2 2 6 6 2" transform="rotate(-90 8 3)" />\n    </g>\n</svg>\n    ',link:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" version="1.1">\n    <g>\n        <path fill-rule="evenodd"\n            d="M1.9,4 C1.9,2.84 2.84,1.9 4,1.9 L8,1.9 L8,0 L4,0 C1.79,0 0,1.79 0,4 C0,6.21 1.79,8 4,8 L8,8 L8,6.1 L4,6.1 C2.84,6.1 1.9,5.16 1.9,4 L1.9,4 Z M14,0 L10,0 L10,1.9 L14,1.9 C15.16,1.9 16.1,2.84 16.1,4 C16.1,5.16 15.16,6.1 14,6.1 L10,6.1 L10,8 L14,8 C16.21,8 18,6.21 18,4 C18,1.79 16.21,0 14,0 L14,0 Z M6,5 L12,5 L12,3 L6,3 L6,5 L6,5 Z"\n            transform="translate(-1 5)" />\n    </g>\n</svg>',graph:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" version="1.1">\n    <g>\n        <path fill-rule="evenodd"\n            d="M15,0 C15.55,0 16,0.45 16,1 L16,15 C16,15.55 15.55,16 15,16 L1,16 C0.45,16 0,15.55 0,15 L0,1 C0,0.45 0.45,0 1,0 L15,0 Z M2,2 L2,14 L14,14 L14,2 L2,2 Z M6,12 L4,12 L4,7 L6,7 L6,12 L6,12 Z M9,12 L7,12 L7,4 L9,4 L9,12 L9,12 Z M12,12 L10,12 L10,8 L12,8 L12,12 L12,12 Z"\n            transform="translate(1 1)" />\n    </g>\n</svg>\n    ',freeze:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" version="1.1">\n    <g fill="none" fill-rule="evenodd">\n        <path stroke="#000000" d="M1.5 3.5H16.5V15.5H1.5z" />\n        <path fill="#000000" d="M6 8H7V15H6z" />\n        <path fill="#D8D8D8" d="M2 4H16V7H2z" />\n        <path fill="#000000" d="M2 7H16V8H2zM2 11H16V12H2z" />\n    </g>\n</svg>',ellipsis:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" version="1.1">\n    <g>\n        <path fill-rule="evenodd"\n            d="M2,0.5 C1.17,0.5 0.5,1.17 0.5,2 C0.5,2.83 1.17,3.5 2,3.5 C2.83,3.5 3.5,2.83 3.5,2 C3.5,1.17 2.83,0.5 2,0.5 L2,0.5 Z M12,0.5 C11.17,0.5 10.5,1.17 10.5,2 C10.5,2.83 11.17,3.5 12,3.5 C12.83,3.5 13.5,2.83 13.5,2 C13.5,1.17 12.83,0.5 12,0.5 L12,0.5 Z M7,0.5 C6.17,0.5 5.5,1.17 5.5,2 C5.5,2.83 6.17,3.5 7,3.5 C7.83,3.5 8.5,2.83 8.5,2 C8.5,1.17 7.83,0.5 7,0.5 L7,0.5 Z"\n            transform="translate(2 7)" />\n    </g>\n</svg>',add:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" version="1.1">\n    <g>\n        <path fill-rule="evenodd"\n            d="M6,4 L6,0 L4,0 L4,4 L0,4 L0,6 L4,6 L4,10 L6,10 L6,6 L10,6 L10,4 L6,4 Z"\n            transform="translate(4 4)" />\n    </g>\n</svg>',"border-all":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" version="1.1">\n    <g>\n        <path fill-rule="evenodd"\n            d="M0,0 L0,14 L14,14 L14,0 L0,0 L0,0 Z M6,12 L2,12 L2,8 L6,8 L6,12 L6,12 Z M6,6 L2,6 L2,2 L6,2 L6,6 L6,6 Z M12,12 L8,12 L8,8 L12,8 L12,12 L12,12 Z M12,6 L8,6 L8,2 L12,2 L12,6 L12,6 Z"\n            transform="translate(2 2)" />\n    </g>\n</svg>',"border-inside":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" version="1.1">\n    <g transform="translate(2 2)">\n        <path\n            d="M0,14 L2,14 L2,12 L0,12 L0,14 L0,14 Z M2,3 L0,3 L0,5 L2,5 L2,3 L2,3 Z M3,14 L5,14 L5,12 L3,12 L3,14 L3,14 Z M11,0 L9,0 L9,2 L11,2 L11,0 L11,0 Z M2,0 L0,0 L0,2 L2,2 L2,0 L2,0 Z M5,0 L3,0 L3,2 L5,2 L5,0 L5,0 Z M0,11 L2,11 L2,9 L0,9 L0,11 L0,11 Z M9,14 L11,14 L11,12 L9,12 L9,14 L9,14 Z M12,0 L12,2 L14,2 L14,0 L12,0 L12,0 Z M12,5 L14,5 L14,3 L12,3 L12,5 L12,5 Z M12,14 L14,14 L14,12 L12,12 L12,14 L12,14 Z M12,11 L14,11 L14,9 L12,9 L12,11 L12,11 Z"\n            opacity=".54" />\n        <polygon points="8 0 6 0 6 6 0 6 0 8 6 8 6 14 8 14 8 8 14 8 14 6 8 6" />\n    </g>\n</svg>',"border-horizontal":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" version="1.1">\n    <g transform="translate(2 2)">\n        <path\n            d="M6,14 L8,14 L8,12 L6,12 L6,14 L6,14 Z M3,2 L5,2 L5,0 L3,0 L3,2 L3,2 Z M6,11 L8,11 L8,9 L6,9 L6,11 L6,11 Z M3,14 L5,14 L5,12 L3,12 L3,14 L3,14 Z M0,5 L2,5 L2,3 L0,3 L0,5 L0,5 Z M0,14 L2,14 L2,12 L0,12 L0,14 L0,14 Z M0,2 L2,2 L2,0 L0,0 L0,2 L0,2 Z M0,11 L2,11 L2,9 L0,9 L0,11 L0,11 Z M12,11 L14,11 L14,9 L12,9 L12,11 L12,11 Z M12,14 L14,14 L14,12 L12,12 L12,14 L12,14 Z M12,5 L14,5 L14,3 L12,3 L12,5 L12,5 Z M12,0 L12,2 L14,2 L14,0 L12,0 L12,0 Z M6,2 L8,2 L8,0 L6,0 L6,2 L6,2 Z M9,2 L11,2 L11,0 L9,0 L9,2 L9,2 Z M6,5 L8,5 L8,3 L6,3 L6,5 L6,5 Z M9,14 L11,14 L11,12 L9,12 L9,14 L9,14 Z"\n            opacity=".54" />\n        <polygon points="0 8 14 8 14 6 0 6" />\n    </g>\n</svg>',"border-vertical":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" version="1.1">\n    <g transform="translate(2 2)">\n        <path\n            d="M3,14 L5,14 L5,12 L3,12 L3,14 L3,14 Z M0,5 L2,5 L2,3 L0,3 L0,5 L0,5 Z M0,2 L2,2 L2,0 L0,0 L0,2 L0,2 Z M3,8 L5,8 L5,6 L3,6 L3,8 L3,8 Z M3,2 L5,2 L5,0 L3,0 L3,2 L3,2 Z M0,14 L2,14 L2,12 L0,12 L0,14 L0,14 Z M0,8 L2,8 L2,6 L0,6 L0,8 L0,8 Z M0,11 L2,11 L2,9 L0,9 L0,11 L0,11 Z M12,0 L12,2 L14,2 L14,0 L12,0 L12,0 Z M12,8 L14,8 L14,6 L12,6 L12,8 L12,8 Z M12,14 L14,14 L14,12 L12,12 L12,14 L12,14 Z M12,5 L14,5 L14,3 L12,3 L12,5 L12,5 Z M12,11 L14,11 L14,9 L12,9 L12,11 L12,11 Z M9,14 L11,14 L11,12 L9,12 L9,14 L9,14 Z M9,8 L11,8 L11,6 L9,6 L9,8 L9,8 Z M9,2 L11,2 L11,0 L9,0 L9,2 L9,2 Z"\n            opacity=".54" />\n        <polygon points="6 14 8 14 8 0 6 0" />\n    </g>\n</svg>',"border-outside":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" version="1.1">\n    <g transform="translate(2 2)">\n        <path\n            d="M8,3 L6,3 L6,5 L8,5 L8,3 L8,3 Z M11,6 L9,6 L9,8 L11,8 L11,6 L11,6 Z M8,6 L6,6 L6,8 L8,8 L8,6 L8,6 Z M8,9 L6,9 L6,11 L8,11 L8,9 L8,9 Z M5,6 L3,6 L3,8 L5,8 L5,6 L5,6 Z"\n            opacity=".54" />\n        <path d="M0,0 L14,0 L14,14 L0,14 L0,0 Z M12,12 L12,2 L2,2 L2,12 L12,12 Z" />\n    </g>\n</svg>',"border-left":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" version="1.1">\n    <g transform="translate(2 2)">\n        <path\n            d="M6,8 L8,8 L8,6 L6,6 L6,8 L6,8 Z M6,5 L8,5 L8,3 L6,3 L6,5 L6,5 Z M6,11 L8,11 L8,9 L6,9 L6,11 L6,11 Z M6,14 L8,14 L8,12 L6,12 L6,14 L6,14 Z M3,14 L5,14 L5,12 L3,12 L3,14 L3,14 Z M3,2 L5,2 L5,0 L3,0 L3,2 L3,2 Z M3,8 L5,8 L5,6 L3,6 L3,8 L3,8 Z M12,14 L14,14 L14,12 L12,12 L12,14 L12,14 Z M12,8 L14,8 L14,6 L12,6 L12,8 L12,8 Z M12,11 L14,11 L14,9 L12,9 L12,11 L12,11 Z M12,5 L14,5 L14,3 L12,3 L12,5 L12,5 Z M6,2 L8,2 L8,0 L6,0 L6,2 L6,2 Z M12,0 L12,2 L14,2 L14,0 L12,0 L12,0 Z M9,14 L11,14 L11,12 L9,12 L9,14 L9,14 Z M9,8 L11,8 L11,6 L9,6 L9,8 L9,8 Z M9,2 L11,2 L11,0 L9,0 L9,2 L9,2 Z"\n            opacity=".54" />\n        <polygon points="0 14 2 14 2 0 0 0" />\n    </g>\n</svg>',"border-top":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" version="1.1">\n    <g transform="translate(2 2)">\n        <path\n            d="M3,8 L5,8 L5,6 L3,6 L3,8 L3,8 Z M0,14 L2,14 L2,12 L0,12 L0,14 L0,14 Z M6,14 L8,14 L8,12 L6,12 L6,14 L6,14 Z M6,11 L8,11 L8,9 L6,9 L6,11 L6,11 Z M3,14 L5,14 L5,12 L3,12 L3,14 L3,14 Z M0,11 L2,11 L2,9 L0,9 L0,11 L0,11 Z M6,8 L8,8 L8,6 L6,6 L6,8 L6,8 Z M0,5 L2,5 L2,3 L0,3 L0,5 L0,5 Z M0,8 L2,8 L2,6 L0,6 L0,8 L0,8 Z M12,8 L14,8 L14,6 L12,6 L12,8 L12,8 Z M12,11 L14,11 L14,9 L12,9 L12,11 L12,11 Z M12,5 L14,5 L14,3 L12,3 L12,5 L12,5 Z M6,5 L8,5 L8,3 L6,3 L6,5 L6,5 Z M9,14 L11,14 L11,12 L9,12 L9,14 L9,14 Z M9,8 L11,8 L11,6 L9,6 L9,8 L9,8 Z M12,14 L14,14 L14,12 L12,12 L12,14 L12,14 Z"\n            opacity=".54" />\n        <polygon points="0 0 0 2 14 2 14 0" />\n    </g>\n</svg>\n  ',"border-right":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" version="1.1">\n    <g transform="translate(2 2)">\n        <path\n            d="M0,2 L2,2 L2,0 L0,0 L0,2 L0,2 Z M3,2 L5,2 L5,0 L3,0 L3,2 L3,2 Z M3,8 L5,8 L5,6 L3,6 L3,8 L3,8 Z M3,14 L5,14 L5,12 L3,12 L3,14 L3,14 Z M0,5 L2,5 L2,3 L0,3 L0,5 L0,5 Z M0,8 L2,8 L2,6 L0,6 L0,8 L0,8 Z M0,14 L2,14 L2,12 L0,12 L0,14 L0,14 Z M0,11 L2,11 L2,9 L0,9 L0,11 L0,11 Z M9,8 L11,8 L11,6 L9,6 L9,8 L9,8 Z M6,14 L8,14 L8,12 L6,12 L6,14 L6,14 Z M9,14 L11,14 L11,12 L9,12 L9,14 L9,14 Z M6,2 L8,2 L8,0 L6,0 L6,2 L6,2 Z M9,2 L11,2 L11,0 L9,0 L9,2 L9,2 Z M6,11 L8,11 L8,9 L6,9 L6,11 L6,11 Z M6,5 L8,5 L8,3 L6,3 L6,5 L6,5 Z M6,8 L8,8 L8,6 L6,6 L6,8 L6,8 Z"\n            opacity=".54" />\n        <polygon points="12 0 12 14 14 14 14 0" />\n    </g>\n</svg>\n  ',"border-bottom":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" version="1.1">\n    <g transform="translate(2 2)">\n        <path\n            d="M5,0 L3,0 L3,2 L5,2 L5,0 L5,0 Z M8,6 L6,6 L6,8 L8,8 L8,6 L8,6 Z M8,9 L6,9 L6,11 L8,11 L8,9 L8,9 Z M11,6 L9,6 L9,8 L11,8 L11,6 L11,6 Z M5,6 L3,6 L3,8 L5,8 L5,6 L5,6 Z M11,0 L9,0 L9,2 L11,2 L11,0 L11,0 Z M8,3 L6,3 L6,5 L8,5 L8,3 L8,3 Z M8,0 L6,0 L6,2 L8,2 L8,0 L8,0 Z M2,9 L0,9 L0,11 L2,11 L2,9 L2,9 Z M12,11 L14,11 L14,9 L12,9 L12,11 L12,11 Z M12,5 L14,5 L14,3 L12,3 L12,5 L12,5 Z M12,8 L14,8 L14,6 L12,6 L12,8 L12,8 Z M12,0 L12,2 L14,2 L14,0 L12,0 L12,0 Z M2,0 L0,0 L0,2 L2,2 L2,0 L2,0 Z M2,3 L0,3 L0,5 L2,5 L2,3 L2,3 Z M2,6 L0,6 L0,8 L2,8 L2,6 L2,6 Z"\n            opacity=".54" />\n        <polygon points="0 14 14 14 14 12 0 12" />\n    </g>\n</svg>',"border-none":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" version="1.1">\n    <g>\n        <path fill-rule="evenodd"\n            d="M6,14 L8,14 L8,12 L6,12 L6,14 L6,14 Z M3,8 L5,8 L5,6 L3,6 L3,8 L3,8 Z M3,2 L5,2 L5,0 L3,0 L3,2 L3,2 Z M6,11 L8,11 L8,9 L6,9 L6,11 L6,11 Z M3,14 L5,14 L5,12 L3,12 L3,14 L3,14 Z M0,5 L2,5 L2,3 L0,3 L0,5 L0,5 Z M0,14 L2,14 L2,12 L0,12 L0,14 L0,14 Z M0,2 L2,2 L2,0 L0,0 L0,2 L0,2 Z M0,8 L2,8 L2,6 L0,6 L0,8 L0,8 Z M6,8 L8,8 L8,6 L6,6 L6,8 L6,8 Z M0,11 L2,11 L2,9 L0,9 L0,11 L0,11 Z M12,11 L14,11 L14,9 L12,9 L12,11 L12,11 Z M12,14 L14,14 L14,12 L12,12 L12,14 L12,14 Z M12,8 L14,8 L14,6 L12,6 L12,8 L12,8 Z M12,5 L14,5 L14,3 L12,3 L12,5 L12,5 Z M12,0 L12,2 L14,2 L14,0 L12,0 L12,0 Z M6,2 L8,2 L8,0 L6,0 L6,2 L6,2 Z M9,2 L11,2 L11,0 L9,0 L9,2 L9,2 Z M6,5 L8,5 L8,3 L6,3 L6,5 L6,5 Z M9,14 L11,14 L11,12 L9,12 L9,14 L9,14 Z M9,8 L11,8 L11,6 L9,6 L9,8 L9,8 Z"\n            transform="translate(2 2)" opacity=".54" />\n    </g>\n</svg>',"line-color":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" version="1.1">\n    <g>\n        <path fill-rule="evenodd"\n            d="M6.5,3.62 L0,10.12 L0,13 L2.88,13 L9.38,6.5 L6.5,3.62 Z M11.85,4.02 C12.05,3.82 12.05,3.51 11.85,3.31 L9.68,1.14 C9.48,0.94 9.17,0.94 8.97,1.14 L7.62,2.5 L10.5,5.38 L11.85,4.02 L11.85,4.02 Z"\n            transform="translate(4)" />\n    </g>\n</svg>',"line-type":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" version="1.1">\n    <g>\n        <path fill-rule="evenodd"\n            d="M0,0 L14,0 L14,2 L0,2 L0,0 Z M0,4 L6,4 L6,6 L0,6 L0,4 Z M0,8 L2,8 L2,10 L0,10 L0,8 Z M8,4 L14,4 L14,6 L8,6 L8,4 Z M4,8 L6,8 L6,10 L4,10 L4,8 Z M8,8 L10,8 L10,10 L8,10 L8,8 Z M12,8 L14,8 L14,10 L12,10 L12,8 Z"\n            transform="translate(2 4)" />\n    </g>\n</svg>',"chevron-left":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" version="1.1">\n    <g>\n        <polygon fill-rule="evenodd" points="-2 2 2 6 6 2" transform="rotate(90 3 10)" />\n    </g>\n</svg>',"chevron-right":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" version="1.1">\n    <g>\n        <polygon fill="#000000" fill-rule="evenodd" points="-2 2 2 6 6 2" transform="rotate(-90 8 3)" />\n    </g>\n</svg>',close:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" version="1.1">\n    <g>\n        <polygon fill-rule="evenodd"\n            points="7.53 1.53 6.47 .47 4 2.94 1.53 .47 .47 1.53 2.94 4 .47 6.47 1.53 7.53 4 5.06 6.47 7.53 7.53 6.47 5.06 4"\n            transform="translate(5 5)" />\n    </g>\n</svg>\n    '},f=function(t){return u[t]?u[t]:(console.log("icon ".concat(t," not found")),"")},h=function(t){function e(t){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=l(this,s(e).call(this,"div","".concat(i.a,"-icon icon-").concat(t)));var r=f(t);return n.el.innerHTML+=r,n.iconNameEl=n.el.firstChild,n}var n,o,u;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(e,r["a"]),n=e,(o=[{key:"setName",value:function(t){this.className(" icon-".concat(t))}}])&&a(n.prototype,o),u&&a(n,u),e}()},function(t,e,n){"use strict";n.d(e,"b",function(){return o});var r=function t(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return r.forEach(function(n){Object.keys(n).forEach(function(r){var i=n[r];"string"==typeof i||"number"==typeof i||"boolean"==typeof i?e[r]=i:"function"!=typeof i&&!Array.isArray(i)&&i instanceof Object?(e[r]=e[r]||{},t(e[r],i)):e[r]=i})}),e};function i(t){for(var e="".concat(t),n=0,r=!1,i=0;i<e.length;i+=1)!0===r&&(n+=1),"."===e.charAt(i)&&(r=!0);return n}function o(t,e,n){if(Number.isNaN(e)||Number.isNaN(n))return e+t+n;var r=i(e),o=i(n),a=Number(e),l=Number(n),s=0;if("-"===t)s=a-l;else if("+"===t)s=a+l;else if("*"===t)s=a*l;else if("/"===t)return i(s=a/l)>5?s.toFixed(2):s;return s.toFixed(Math.max(r,o))}e.a={cloneDeep:function(t){return JSON.parse(JSON.stringify(t))},merge:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.apply(void 0,[{}].concat(e))},equals:function t(e,n){var r=Object.keys(e);if(r.length!==Object.keys(n).length)return!1;for(var i=0;i<r.length;i+=1){var o=r[i],a=e[o],l=n[o];if(void 0===l)return!1;if("string"==typeof a||"number"==typeof a||"boolean"==typeof a){if(a!==l)return!1}else if(Array.isArray(a)){if(a.length!==l.length)return!1;for(var s=0;s<a.length;s+=1)if(!t(a[s],l[s]))return!1}else if("function"!=typeof a&&!Array.isArray(a)&&a instanceof Object&&!t(a,l))return!1}return!0},arrayEquals:function(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n+=1)if(t[n]!==e[n])return!1;return!0},sum:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t},n=0,r=0;return Object.keys(t).forEach(function(i){n+=e(t[i],i),r+=1}),[n,r]},rangeEach:function(t,e,n){for(var r=t;r<e;r+=1)n(r)},rangeSum:function(t,e,n){for(var r=0,i=t;i<e;i+=1)r+=n(i);return r},rangeReduceIf:function(t,e,n,r,i,o){for(var a=n,l=r,s=t;s<e&&!(a>i);s+=1)a+=l=o(s);return[s,a-l,l]},deleteProperty:function(t,e){var n=t["".concat(e)];return delete t["".concat(e)],n},numberCalc:o}},function(t,e,n){"use strict";n.d(e,"c",function(){return o}),n.d(e,"b",function(){return l}),n.d(e,"d",function(){return s}),n.d(e,"a",function(){return c});n(17);function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var i=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function o(t){for(var e="",n=t;n>=i.length;)n/=i.length,n-=1,e+=i[parseInt(n,10)%i.length];var r=t%i.length;return e+=i[r]}function a(t){for(var e=0,n=0;n!==t.length;++n)e=26*e+t.charCodeAt(n)-64;return e-1}function l(t){for(var e="",n="",r=!1,i=!1,o=0;o<t.length;o+=1)"$"===t.charAt(o)?e.length>0?i=!0:r=!0:t.charAt(o)>="0"&&t.charAt(o)<="9"?n+=t.charAt(o):e+=t.charAt(o);return[a(e),parseInt(n,10)-1,r,i]}function s(t,e,n,r){var i=r?"$":"";return"".concat(n?"$":"").concat(o(t)).concat(i).concat(e+1)}function c(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return!0};if(0===e&&0===n)return t;var o=r(l(t),4),a=o[0],c=o[1],u=o[2],f=o[3];return i(a,c)?s(a+(u?0:e),c+(f?0:n),u,f):t}},function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r=n(6);function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a=function(){function t(e,n,r,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sri=e,this.sci=n,this.eri=r,this.eci=i,this.w=o,this.h=a}var e,n,a;return e=t,a=[{key:"valueOf",value:function(e){var n=e.split(":"),o=i(Object(r.b)(n[0]),2),a=o[0],l=o[1],s=l,c=a;if(n.length>1){var u=i(Object(r.b)(n[1]),2);c=u[0],s=u[1]}return new t(l,a,s,c)}}],(n=[{key:"set",value:function(t,e,n,r){this.sri=t,this.sci=e,this.eri=n,this.eci=r}},{key:"multiple",value:function(){return this.eri-this.sri>0||this.eci-this.sci>0}},{key:"includes",value:function(){for(var t=0,e=0,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];if(1===o.length){var l=Object(r.b)(o[0]),s=i(l,2);e=s[0],t=s[1]}else 2===o.length&&(t=o[0],e=o[1]);var c=this.sri,u=this.sci,f=this.eri,h=this.eci;return c<=t&&t<=f&&u<=e&&e<=h}},{key:"each",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0},n=this.sri,r=this.sci,i=this.eri,o=this.eci,a=n;a<=i;a+=1)if(e(a))for(var l=r;l<=o;l+=1)t(a,l)}},{key:"contains",value:function(t){return this.sri<=t.sri&&this.sci<=t.sci&&this.eri>=t.eri&&this.eci>=t.eci}},{key:"within",value:function(t){return this.sri>=t.sri&&this.sci>=t.sci&&this.eri<=t.eri&&this.eci<=t.eci}},{key:"disjoint",value:function(t){return this.sri>t.eri||this.sci>t.eci||t.sri>this.eri||t.sci>this.eci}},{key:"intersects",value:function(t){return this.sri<=t.eri&&this.sci<=t.eci&&t.sri<=this.eri&&t.sci<=this.eci}},{key:"union",value:function(e){var n=this.sri,r=this.sci,i=this.eri,o=this.eci;return new t(e.sri<n?e.sri:n,e.sci<r?e.sci:r,e.eri>i?e.eri:i,e.eci>o?e.eci:o)}},{key:"difference",value:function(e){var n=[],r=function(e,r,i,o){n.push(new t(e,r,i,o))},i=this.sri,o=this.sci,a=this.eri,l=this.eci,s=e.sri-i,c=e.sci-o,u=a-e.eri,f=l-e.eci;return s>0?(r(i,o,e.sri-1,l),u>0?(r(e.eri+1,o,a,l),c>0&&r(e.sri,o,e.eri,e.sci-1),f>0&&r(e.sri,e.eci+1,e.eri,l)):(c>0&&r(e.sri,o,a,e.sci-1),f>0&&r(e.sri,e.eci+1,a,l))):u>0&&(r(e.eri+1,o,a,l),c>0&&r(i,o,e.eri,e.sci-1),f>0&&r(i,e.eci+1,e.eri,l)),c>0?(r(i,o,a,e.sci-1),f>0?(r(i,e.eri+1,a,l),s>0&&r(i,e.sci,e.sri-1,e.eci),u>0&&r(e.sri+1,e.sci,a,e.eci)):(s>0&&r(i,e.sci,e.sri-1,l),u>0&&r(e.sri+1,e.sci,a,l))):f>0&&(r(a,e.eci+1,a,l),s>0&&r(i,o,e.sri-1,e.eci),u>0&&r(e.eri+1,o,a,e.eci)),n}},{key:"size",value:function(){return[this.eri-this.sri+1,this.eci-this.sci+1]}},{key:"toString",value:function(){var t=this.sri,e=this.sci,n=this.eri,i=this.eci,o=Object(r.d)(e,t);return this.multiple()&&(o="".concat(o,":").concat(Object(r.d)(i,n))),o}},{key:"clone",value:function(){return new t(this.sri,this.sci,this.eri,this.eci,this.w,this.h)}},{key:"equals",value:function(t){return this.eri===t.eri&&this.eci===t.eci&&this.sri===t.sri&&this.sci===t.sci}}])&&o(e.prototype,n),a&&o(e,a),t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return h});var r=n(0),i=n(3),o=n(1),a=n(4);function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t,e){return!e||"object"!==l(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var h=function(t){function e(t,n,i,l,s){var f,h;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(h=c(this,u(e).call(this,"div","".concat(o.a,"-dropdown ").concat(l," ").concat(s||"")))).title=t,h.change=function(){},h.headerClick=function(){},"string"==typeof t?h.title=Object(r.b)("div","".concat(o.a,"-dropdown-title")).child(t):i&&h.title.addClass("arrow-left"),h.contentEl=Object(r.b)("div","".concat(o.a,"-dropdown-content")).css("width",n).hide();for(var d=arguments.length,p=new Array(d>5?d-5:0),v=5;v<d;v++)p[v-5]=arguments[v];return(f=h).setContentChildren.apply(f,p),h.headerEl=Object(r.b)("div","".concat(o.a,"-dropdown-header")),h.headerEl.on("click",function(){"block"!==h.contentEl.css("display")?h.show():h.hide()}).children(h.title,i?Object(r.b)("div","".concat(o.a,"-icon arrow-right")).child(new a.a("arrow-down")):""),h.children(h.headerEl,h.contentEl),h}var n,l,h;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(e,r["a"]),n=e,(l=[{key:"setContentChildren",value:function(){var t;(this.contentEl.html(""),arguments.length>0)&&(t=this.contentEl).children.apply(t,arguments)}},{key:"setTitle",value:function(t){this.title.html(t),this.hide()}},{key:"show",value:function(){var t=this;this.contentEl.show(),this.parent().active(),Object(i.b)(this.parent(),function(){t.hide()})}},{key:"hide",value:function(){this.parent().active(!1),this.contentEl.hide(),Object(i.g)(this.parent())}}])&&s(n.prototype,l),h&&s(n,h),e}()},function(t,e,n){t.exports=n(23)},function(t,e,n){"use strict";n.d(e,"b",function(){return i}),n.d(e,"a",function(){return r}),n.d(e,"c",function(){return o});n(17);var r=[{key:"Arial",title:"Arial"},{key:"Helvetica",title:"Helvetica"},{key:"Source Sans Pro",title:"Source Sans Pro"},{key:"Comic Sans MS",title:"Comic Sans MS"},{key:"Courier New",title:"Courier New"},{key:"Verdana",title:"Verdana"},{key:"Lato",title:"Lato"}],i=[{pt:7.5,px:10},{pt:8,px:11},{pt:9,px:12},{pt:10,px:13},{pt:10.5,px:14},{pt:11,px:15},{pt:12,px:16},{pt:14,px:18.7},{pt:15,px:20},{pt:16,px:21.3},{pt:18,px:24},{pt:22,px:29.3},{pt:24,px:32},{pt:26,px:34.7},{pt:36,px:48},{pt:42,px:56}];function o(t){for(var e=0;e<i.length;e+=1){var n=i[e];if(n.pt===t)return n.px}return t}},function(t,e,n){"use strict";function r(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function l(t,e,n){return e&&a(t.prototype,e),n&&a(t,n),t}function s(){return window.devicePixelRatio||1}function c(){return s()-.5}function u(t){return parseInt(t*s(),10)}function f(t){var e=u(t);return e>0?e-.5:.5}n.d(e,"a",function(){return p}),n.d(e,"b",function(){return h}),n.d(e,"d",function(){return c}),n.d(e,"c",function(){return u});var h=function(){function t(e,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;o(this,t),this.x=e,this.y=n,this.width=r,this.height=i,this.padding=a,this.bgcolor="#ffffff",this.borderTop=null,this.borderRight=null,this.borderBottom=null,this.borderLeft=null}return l(t,[{key:"setBorders",value:function(t){var e=t.top,n=t.bottom,r=t.left,i=t.right;e&&(this.borderTop=e),i&&(this.borderRight=i),n&&(this.borderBottom=n),r&&(this.borderLeft=r)}},{key:"innerWidth",value:function(){return this.width-2*this.padding-2}},{key:"innerHeight",value:function(){return this.height-2*this.padding-2}},{key:"textx",value:function(t){var e=this.width,n=this.padding,r=this.x;return"left"===t?r+=n:"center"===t?r+=e/2:"right"===t&&(r+=e-n),r}},{key:"texty",value:function(t,e){var n=this.height,r=this.padding,i=this.y;return"top"===t?i+=r:"middle"===t?i+=n/2-e/2:"bottom"===t&&(i+=n-r-e),i}},{key:"topxys",value:function(){var t=this.x,e=this.y;return[[t,e],[t+this.width,e]]}},{key:"rightxys",value:function(){var t=this.x,e=this.y,n=this.width;return[[t+n,e],[t+n,e+this.height]]}},{key:"bottomxys",value:function(){var t=this.x,e=this.y,n=this.width,r=this.height;return[[t,e+r],[t+n,e+r]]}},{key:"leftxys",value:function(){var t=this.x,e=this.y;return[[t,e],[t,e+this.height]]}}]),t}();function d(t,e,n,r,i,o,a){var l={x:0,y:0};"underline"===t?l.y="bottom"===i?0:"top"===i?-(o+2):-o/2:"strike"===t&&("bottom"===i?l.y=o/2:"top"===i&&(l.y=-(o/2+2))),"center"===r?l.x=a/2:"right"===r&&(l.x=a),this.line([e-l.x,n-l.y],[e-l.x+a,n-l.y])}var p=function(){function t(e,n,r){o(this,t),this.el=e,this.ctx=e.getContext("2d"),this.resize(n,r),this.ctx.scale(s(),s())}return l(t,[{key:"resize",value:function(t,e){this.el.style.width="".concat(t,"px"),this.el.style.height="".concat(e,"px"),this.el.width=u(t),this.el.height=u(e)}},{key:"clear",value:function(){var t=this.el,e=t.width,n=t.height;return this.ctx.clearRect(0,0,e,n),this}},{key:"attr",value:function(t){return Object.assign(this.ctx,t),this}},{key:"save",value:function(){return this.ctx.save(),this.ctx.beginPath(),this}},{key:"restore",value:function(){return this.ctx.restore(),this}},{key:"beginPath",value:function(){return this.ctx.beginPath(),this}},{key:"translate",value:function(t,e){return this.ctx.translate(u(t),u(e)),this}},{key:"scale",value:function(t,e){return this.ctx.scale(t,e),this}},{key:"clearRect",value:function(t,e,n,r){return this.ctx.clearRect(t,e,n,r),this}},{key:"fillRect",value:function(t,e,n,r){return this.ctx.fillRect(u(t)-.5,u(e)-.5,u(n),u(r)),this}},{key:"fillText",value:function(t,e,n){return this.ctx.fillText(t,u(e),u(n)),this}},{key:"text",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=this.ctx,a=r.align,l=r.valign,s=r.font,c=r.color,f=r.strike,h=r.underline,p=e.textx(a);o.save(),o.beginPath(),this.attr({textAlign:a,textBaseline:l,font:"".concat(s.italic?"italic":""," ").concat(s.bold?"bold":""," ").concat(u(s.size),"px ").concat(s.name),fillStyle:c,strokeStyle:c});var v="".concat(t).split("\n"),y=e.innerWidth(),b=[];v.forEach(function(t){var e=o.measureText(t).width;if(i&&e>u(y)){for(var n={w:0,len:0,start:0},r=0;r<t.length;r+=1)n.w>=u(y)&&(b.push(t.substr(n.start,n.len)),n={w:0,len:0,start:r}),n.len+=1,n.w+=o.measureText(t[r]).width+1;n.len>0&&b.push(t.substr(n.start,n.len))}else b.push(t)});var g=(b.length-1)*(s.size+2),m=e.texty(l,g);return b.forEach(function(t){var e=o.measureText(t).width;n.fillText(t,p,m),f&&d.call(n,"strike",p,m,a,l,s.size,e),h&&d.call(n,"underline",p,m,a,l,s.size,e),m+=s.size+2}),o.restore(),this}},{key:"border",value:function(t,e){var n=this.ctx;return n.lineWidth=c,n.strokeStyle=e,"medium"===t?n.lineWidth=u(2)-.5:"thick"===t?n.lineWidth=u(3):"dashed"===t?n.setLineDash([u(3),u(2)]):"dotted"===t?n.setLineDash([u(1),u(1)]):"double"===t&&n.setLineDash([u(2),0]),this}},{key:"line",value:function(){var t=this.ctx;if(arguments.length>1){t.beginPath();var e=arguments.length<=0?void 0:arguments[0],n=i(e,2),r=n[0],o=n[1];t.moveTo(f(r),f(o));for(var a=1;a<arguments.length;a+=1){var l=a<0||arguments.length<=a?void 0:arguments[a],s=i(l,2),c=s[0],u=s[1];t.lineTo(f(c),f(u))}t.stroke()}return this}},{key:"strokeBorders",value:function(t){var e=this.ctx;e.save();var n=t.borderTop,i=t.borderRight,o=t.borderBottom,a=t.borderLeft;n&&(this.border.apply(this,r(n)),this.line.apply(this,r(t.topxys()))),i&&(this.border.apply(this,r(i)),this.line.apply(this,r(t.rightxys()))),o&&(this.border.apply(this,r(o)),this.line.apply(this,r(t.bottomxys()))),a&&(this.border.apply(this,r(a)),this.line.apply(this,r(t.leftxys()))),e.restore()}},{key:"dropdown",value:function(t){var e=this.ctx,n=t.x,r=t.y,i=n+t.width-15,o=r+t.height-15;e.save(),e.beginPath(),e.moveTo(u(i),u(o)),e.lineTo(u(i+8),u(o)),e.lineTo(u(i+4),u(o+6)),e.closePath(),e.fillStyle=t.color||"rgba(0, 0, 0, .45)",e.fill(),e.restore()}},{key:"error",value:function(t){var e=this.ctx,n=t.x,r=t.y,i=n+t.width-1;e.save(),e.beginPath(),e.moveTo(u(i-8),u(r-1)),e.lineTo(u(i),u(r-1)),e.lineTo(u(i),u(r+8)),e.closePath(),e.fillStyle="rgba(255, 0, 0, .65)",e.fill(),e.restore()}},{key:"frozen",value:function(t){var e=this.ctx,n=t.x,r=t.y,i=n+t.width-1;e.save(),e.beginPath(),e.moveTo(u(i-8),u(r-1)),e.lineTo(u(i),u(r-1)),e.lineTo(u(i),u(r+8)),e.closePath(),e.fillStyle="rgba(0, 255, 0, .85)",e.fill(),e.restore()}},{key:"rect",value:function(t,e){var n=this.ctx,r=t.x,i=t.y,o=t.width,a=t.height,l=t.bgcolor;n.save(),n.beginPath(),n.fillStyle=l||"#fff",n.rect(f(r+1),f(i+1),u(o-2),u(a-2)),n.clip(),n.fill(),e(),n.restore()}}]),t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r=n(0),i=n(1);function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a=function(){function t(e,n){var o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.vchange=function(){},this.el=Object(r.b)("div","".concat(i.a,"-form-input")),this.input=Object(r.b)("input","").css("width",e).on("input",function(t){return o.vchange(t)}).attr("placeholder",n),this.el.child(this.input)}var e,n,a;return e=t,(n=[{key:"focus",value:function(){var t=this;setTimeout(function(){t.input.el.focus()},10)}},{key:"hint",value:function(t){this.input.attr("placeholder",t)}},{key:"val",value:function(t){return this.input.val(t)}}])&&o(e.prototype,n),a&&o(e,a),t}()},function(t,e,n){"use strict";n.d(e,"b",function(){return s}),n.d(e,"a",function(){return l});var r=n(9),i=n.n(r),o=n(2);var a=Object(o.c)("format.dateformat")()||"yyyy-mm-dd",l=[{numfmt:"",title:Object(o.c)("format.general"),type:"string",render:i()("")},{numfmt:"@",title:Object(o.c)("format.text"),type:"string",render:i()("@")},{numfmt:"#,##0.00",title:Object(o.c)("format.number"),type:"number",label:"1,000.12",render:i()("#,##0.00")},{numfmt:"#,##0.00%",title:Object(o.c)("format.percent"),type:"number",label:"10.12%",render:i()("#,##0.00%")},{numfmt:"#,##0.00",title:Object(o.c)("format.rmb"),type:"number",label:"10.00",render:i()("#,##0.00")},{numfmt:"$#,##0.00",title:Object(o.c)("format.usd"),type:"number",label:"$10.00",render:i()("$#,##0.00")},{numfmt:"#,##0.00",title:Object(o.c)("format.eur"),type:"number",label:"10.00",render:i()("#,##0.00")},{numfmt:a,title:Object(o.c)("format.date"),type:"date",label:"26/09/2008",render:i()(a)},{numfmt:"[$-F400]h:mm:ss AM/PM",title:Object(o.c)("format.time"),type:"date",label:"15:59:00",render:i()("[$-F400]h:mm:ss AM/PM")},{numfmt:"[$-F800]dddd, mmmm dd, yyyy",title:Object(o.c)("format.longdate"),type:"date",label:"24:01:00",render:i()("[$-F800]dddd, mmmm dd, yyyy")}],s={};l.forEach(function(t){s[t.key]=t});var c=new Map;s.render=function(t,e){var n,r=i.a.parseValue(e),o=r&&r.v||e;return s[t]?n=s[t].render:c.has(t)?n=c.get(t):(n=i()(t),c.set(t,n)),n(o)}},function(t,e,n){"use strict";n.d(e,"b",function(){return p}),n.d(e,"c",function(){return d}),n.d(e,"a",function(){return h});var r=n(2),i=n(5);function o(t,e){return u(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||s()}function a(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||c(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function l(t){return u(t)||c(t)||s()}function s(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function c(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function u(t){if(Array.isArray(t))return t}function f(t){return!Number.isNaN(parseFloat(t))&&isFinite(t)}var h=[{key:"SUM",title:Object(r.c)("formula.sum"),render:function(t){return t.flat().flat().filter(f).reduce(function(t,e){return Object(i.b)("+",t,e)},0)}},{key:"AVERAGE",title:Object(r.c)("formula.average"),render:function(t){var e=l(t).slice(0);return e.flat().flat().filter(f).reduce(function(t,e){return Number(t)+Number(e)},0)/e.flat().length}},{key:"MAX",title:Object(r.c)("formula.max"),render:function(t){var e=l(t).slice(0);return Math.max.apply(Math,a(e.flat().flat().filter(f).map(function(t){return Number(t)})))}},{key:"MIN",title:Object(r.c)("formula.min"),render:function(t){var e=l(t).slice(0);return Math.min.apply(Math,a(e.flat().flat().filter(f).map(function(t){return Number(t)})))}},{key:"IF",title:Object(r.c)("formula._if"),render:function(t){var e=o(t,3),n=e[0],r=e[1],i=e[2];return n?r:i}},{key:"AND",title:Object(r.c)("formula.and"),render:function(t){return l(t).slice(0).flat().flat().every(function(t){return t})}},{key:"OR",title:Object(r.c)("formula.or"),render:function(t){return l(t).slice(0).flat().flat().some(function(t){return t})}},{key:"CONCAT",title:Object(r.c)("formula.concat"),render:function(t){return l(t).slice(0).flat().flat().join("")}},{key:"PRODUCT",title:Object(r.c)("formula.product"),render:function(t){return l(t).slice(0).flat().flat().filter(f).reduce(function(t,e){return Number(t)*Number(e)},1)}},{key:"COUNT",title:Object(r.c)("formula.count"),render:function(t){return t.flat().flat().filter(f).length}},{key:"MOD",title:Object(r.c)("formula.mod"),render:function(t){var e=o(t,2),n=e[0],r=e[1];return Number(n)%Number(r)}},{key:"POWER",title:Object(r.c)("formula.power"),render:function(t){var e=o(t,2),n=e[0],r=e[1];return Math.pow(Number(n),Number(r))}},{key:"CEILING",title:Object(r.c)("formula.ceiling"),render:function(t){var e=o(t,2),n=e[0];e[1];return Math.ceil(Number(n))}},{key:"FLOOR",title:Object(r.c)("formula.floor"),render:function(t){var e=o(t,1)[0];return Math.floor(Number(e))}},{key:"LEN",title:Object(r.c)("formula.len"),render:function(t){var e=o(t,1)[0];return String(e).length}},{key:"REPLACE",title:Object(r.c)("formula.replace"),render:function(t){var e=o(t,4),n=e[0],r=e[1],i=e[2],a=e[3],l=r-1;return n.slice(0,l)+a+n.slice(l+i)}},{key:"SUBSTITUTE",title:Object(r.c)("formula.substitute"),render:function(t){var e=o(t,3),n=e[0],r=e[1],i=e[2];return String(n).replaceAll(r,i)}},{key:"VLOOKUP",title:Object(r.c)("formula.vlookup"),render:function(t){var e=o(t,4),n=e[0],r=e[1],i=e[2],a=e[3];console.log(n,r,i,a);var l=r[0].findIndex(function(t){return t==n});return l>=0&&i<=r.length?r[i-1][l]:"#N/A"}}],d=h,p={};h.forEach(function(t){p[t.key]=t})},function(t,e,n){"use strict";(function(t){n.d(e,"b",function(){return b});var r=n(6),i=n(10),o=n(18),a=n(14),l=n(13),s=n(11);function c(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var f=5;function h(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=t.cellRect(e,n),o=i.left,a=i.top,l=i.width,c=i.height;return new s.b(o,a+r,l,c,f)}function d(e){return t.getComputedStyle(e.ctx.canvas).getPropertyValue("--table-header")||"hsl(360deg 0% 88%)"}function p(e){return t.getComputedStyle(e.ctx.canvas).getPropertyValue("--table-stroke")||"hsl(220, 6%, 51%)"}function v(e){return t.getComputedStyle(e.ctx.canvas).getPropertyValue("--table-header-text")||"hsl(359deg 100% 0% / .6)"}function y(e,n){var r=t.getComputedStyle(e.ctx.canvas).getPropertyValue("--ss-accent-h")||"218",i=t.getComputedStyle(e.ctx.canvas).getPropertyValue("--ss-accent-s")||"100%",o=t.getComputedStyle(e.ctx.canvas).getPropertyValue("--ss-accent-l")||"65%";return"hsl( ".concat(r,", ").concat(i,", ").concat(o,", ").concat(n,")")}function b(t,e,n,r){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,c=e.sortedRowMap,u=e.rows,f=e.cols;if(!u.isHide(n)&&!f.isHide(r)){var d=n;c.has(n)&&(d=c.get(n));var p=e.getCell(d,r);if(null!==p){var v=!1;"editable"in p&&!1===p.editable&&(v=!0);var y=e.getCellStyleOrDefault(d,r),b=h(e,n,r,s);b.bgcolor=y.bgcolor,void 0!==y.border&&(b.setBorders(y.border),t.strokeBorders(b)),t.rect(b,function(){var s="";s=e.settings.evalPaused?p.text||"":o.a.render(p.text||"",a.b,function(t,n){return e.getCellTextOrDefault(n,t)}),void 0===y.format||"string"!=typeof s&&"number"!=typeof s||(s=l.b.render(y.format,s));var c=Object.assign({},y.font);c.size=Object(i.c)(c.size),t.text(s,b,{align:y.align,valign:y.valign,font:c,color:y.color,strike:y.strike,underline:y.underline},y.textwrap),e.validations.getError(n,r)&&t.error(b),v&&t.frozen(b)})}}}function g(t,e,n,r,i){var o=this.draw,a=this.data;o.save(),o.translate(e,n).translate(r,i);var l=a.exceptRowSet,s=a.exceptRowTotalHeight(t.sri,t.eri);o.save(),o.translate(0,-s),t.each(function(t,e){b(o,a,t,e)},function(t){return function(t){var e=l.has(t);if(e){var n=a.rows.getHeight(t);o.translate(0,-n)}return!e}(t)}),o.restore();var c=new Set;o.save(),o.translate(0,-s),a.eachMergesInView(t,function(t){var e=t.sri,n=t.sci,r=t.eri;if(l.has(e)){if(!c.has(e)){c.add(e);var i=a.rows.sumHeight(e,r+1);o.translate(0,-i)}}else b(o,a,e,n)}),o.restore(),function(t){var e=this.data,n=this.draw;if(t){var r=e.autoFilter;if(!r.active())return;var i=r.hrange();t.intersects(i)&&i.each(function(t,r){var i=h(e,t,r);i.color=v(n),n.dropdown(i)})}}.call(this,t),o.restore()}function m(t,e,n,r){var i=this.draw,o=y(i,"15%");i.save(),i.attr({fillStyle:"".concat(o)}).fillRect(t,e,n,r),i.restore()}function w(t,e,n,i,o,a){var l=this,c=this.draw,u=this.data,f=e.h,h=e.w,y=a+i,b=o+n;c.save();var g=d(c);c.attr({fillStyle:g}),"all"!==t&&"left"!==t||c.fillRect(0,y,n,f),"all"!==t&&"top"!==t||c.fillRect(b,0,h,i);var w=u.selector.range,L=w.sri,O=w.sci,k=w.eri,j=w.eci,x={textAlign:"center",textBaseline:"middle",font:"500 ".concat(Object(s.c)(12),"px Source Sans Pro"),fillStyle:"#585757",lineWidth:Object(s.d)(),strokeStyle:"#e6e6e6"},_=v(c),S=p(c);_&&(x.fillStyle=_),S&&(x.strokeStyle=S),c.attr(x),"all"!==t&&"left"!==t||(u.rowEach(e.sri,e.eri,function(t,e,r){var i=y+e,o=t;c.line([0,i],[n,i]),L<=o&&o<k+1&&m.call(l,0,i,n,r),c.fillText(o+1,n/2,i+r/2),t>0&&u.rows.isHide(t-1)&&(c.save(),c.attr({strokeStyle:S}),c.line([5,i+5],[n-5,i+5]),c.restore())}),c.line([0,f+y],[n,f+y]),c.line([n,y],[n,f+y])),"all"!==t&&"top"!==t||(u.colEach(e.sci,e.eci,function(t,e,n){var o=b+e,a=t;c.line([o,0],[o,i]),O<=a&&a<j+1&&m.call(l,o,0,n,i),c.fillText(Object(r.c)(a),o+n/2,i/2),t>0&&u.cols.isHide(t-1)&&(c.save(),c.attr({strokeStyle:S}),c.line([o+5,5],[o+5,i-5]),c.restore())}),c.line([h+b,0],[h+b,i]),c.line([0,i],[h+b,i])),c.restore()}function L(t,e,n,r,i){var o=t.sri,a=t.sci,l=t.eri,c=t.eci,u=t.w,f=t.h,h=this.draw,v=this.data,y=v.settings,b=d(h),g=p(h);h.save(),h.attr({fillStyle:b,lineWidth:s.d,strokeStyle:g}).translate(e+r,n+i),y.showGrid?(v.rowEach(o,l,function(t,e,n){t!==o&&h.line([0,e],[u,e]),t===l&&h.line([0,e+n],[u,e+n])}),v.colEach(a,c,function(t,e,n){t!==a&&h.line([e,0],[e,f]),t===c&&h.line([e+n,0],[e+n,f])}),h.restore()):h.restore()}var O=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.el=e,this.draw=new s.a(e,n.viewWidth(),n.viewHeight()),this.data=n}var e,n,r;return e=t,(n=[{key:"resetData",value:function(t){this.data=t,this.render()}},{key:"render",value:function(){var t=this.data,e=t.rows,n=t.cols.indexWidth,r=e.height;this.draw.resize(t.viewWidth(),t.viewHeight()),this.clear();var i=t.viewRange(),o=t.freezeTotalWidth(),a=t.freezeTotalHeight(),l=t.scroll,s=l.x,u=l.y;L.call(this,i,n,r,o,a),w.call(this,"all",i,n,r,o,a),function(t,e){var n=this.draw,r=d(n);n.save(),n.attr({fillStyle:r}).fillRect(0,0,t,e),n.restore()}.call(this,n,r),g.call(this,i,n,r,-s,-u);var f=c(t.freeze,2),h=f[0],p=f[1];if(h>0||p>0){if(h>0){var v=i.clone();v.sri=0,v.eri=h-1,v.h=a,L.call(this,v,n,r,o,0),w.call(this,"top",v,n,r,o,0),g.call(this,v,n,r,-s,0)}if(p>0){var b=i.clone();b.sci=0,b.eci=p-1,b.w=o,L.call(this,b,n,r,0,a),w.call(this,"left",b,n,r,0,a),g.call(this,b,n,r,0,-u)}var m=t.freezeViewRange();L.call(this,m,n,r,0,0),w.call(this,"all",m,n,r,0,0),g.call(this,m,n,r,0,0),function(t,e,n,r){var i=this.draw,o=this.data,a=o.viewWidth()-t,l=o.viewHeight()-e,s=y(i,"65%");console.log(s),i.save().translate(t,e).attr({strokeStyle:"".concat(s)}),i.line([0,r],[a,r]),i.line([n,0],[n,l]),i.restore()}.call(this,n,r,o,a)}}},{key:"clear",value:function(){this.draw.clear()}}])&&u(e.prototype,n),r&&u(e,r),t}();e.a=O}).call(this,n(16))},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e){},function(t,e,n){"use strict";var r=n(6),i=(n(10),n(5));function o(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function a(t){for(var e=o(Object(r.b)(t.pop()),2),n=e[0],i=e[1],a=o(Object(r.b)(t.pop()),2),l=a[0],s=a[1],c=[],u=[],f=l;f<=n;f+=1){for(var h=s;h<=i;h+=1)u.push(Object(r.d)(f,h));c.push(u),u=[]}return c}var l=function(t){for(var e=[],n=[],r=[],i=0,o="",l=1,s="",c=!1,u=0;u<t.length;u+=1){var f=t.charAt(u);if(" "!==f){if("$"===f)c=!0;else if(f>="a"&&f<="z")r.push((c?"$":"")+f.toUpperCase()),c=!1;else if(f>="0"&&f<="9"||f>="A"&&f<="Z"||"."===f)r.push((c?"$":"")+f),c=!1;else if('"'===f){for(u+=1;'"'!==t.charAt(u);)r.push(t.charAt(u)),u+=1;n.push('"'.concat(r.join(""))),r=[]}else if("-"===f&&/[+\-*/,(]/.test(s))r.push(f);else{if("("!==f&&r.length>0&&n.push(r.join("")),")"===f){if(2===i)try{var h=a(n);n.push(h);var d=e.pop();n.push({f:d,len:l})}catch(t){}else if(1===i||3===i){3===i&&(n.push(o),o="");var p=e.pop();n.push({f:p,len:l}),l=1}else for(var v=e.pop();"("!==v&&(n.push(v),!(e.length<=0));)v=e.pop();i=0}else if("="===f||">"===f||"<"===f){var y=t.charAt(u+1);o=f,"="!==y&&"-"!==y||(o+=y,u+=1),i=3}else if(":"===f)i=2;else if(","===f){if(2===i){var b=a(n);n.push(b)}else 3===i&&(n.push(o),o="");i=1,l+=1}else if("("===f&&r.length>0)e.push(r.join(""));else{if(e.length>0&&("+"===f||"-"===f)){var g=e[e.length-1];if("("!==g&&n.push(e.pop()),"*"===g||"/"===g)for(;e.length>0&&"("!==(g=e[e.length-1]);)n.push(e.pop())}else if(e.length>0){var m=e[e.length-1];"*"!==m&&"/"!==m||n.push(e.pop())}e.push(f)}r=[]}s=f}}for(r.length>0&&n.push(r.join(""));e.length>0;)n.push(e.pop());return o.length>0&&n.push(o),n},s=function t(e,n){if(Array.isArray(e))return e.map(function(e){return t(e,n)});var i=o(e,1)[0],a=e;if('"'===i)return e.substring(1);var l=1;if("-"===i&&(a=e.substring(1),l=-1),a[0]>="0"&&a[0]<="9")return l*Number(a);var s=o(Object(r.b)(a),2),c=s[0],u=s[1];return n(c,u)},c=function(t,e,n,r){for(var o=[],a=0;a<t.length;a+=1){var l=t[a],c=l[0];if("+"===l){var u=o.pop();o.push(Object(i.b)("+",o.pop(),u))}else if("-"===l)if(1===o.length){var f=o.pop();o.push(Object(i.b)("*",f,-1))}else{var h=o.pop();o.push(Object(i.b)("-",o.pop(),h))}else if("*"===l)o.push(Object(i.b)("*",o.pop(),o.pop()));else if("/"===l){var d=o.pop();o.push(Object(i.b)("/",o.pop(),d))}else if("="===c||">"===c||"<"===c){var p=o.pop();Number.isNaN(p)||(p=Number(p));var v=o.pop();Number.isNaN(v)||(v=Number(v));var y=!1;"="===c?y=v===p:">"===l?y=v>p:">="===l?y=v>=p:"<"===l?y=v<p:"<="===l&&(y=v<=p),o.push(y)}else if(l.f){for(var b=l.f,g=l.len,m=[],w=0;w<g;w+=1)m.push(o.pop());void 0!==e[b]&&e[b].render?o.push(e[b].render(m.reverse())):o.push("#ERROR")}else if(e[l]){var L=[];L.push(o.pop()),o.push(e[l].render(L))}else{if(r.includes(l))return 0;(c>="a"&&c<="z"||c>="A"&&c<="Z")&&r.push(l),o.push(s(l,n)),r.pop()}}var O=o[0];return null!=O?O:0};e.a={render:function t(e,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if("="===e[0]){var o=l(e.substring(1));return o.length<=0?e:c(o,n,function(e,o){return t(r(e,o),n,r,i)},i)}return e}}},function(t,e,n){"use strict";n.d(e,"a",function(){return k});var r=n(0),i=n(3),o=n(1),a=n(4),l=n(12),s=n(8),c=n(2);function u(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function f(t){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function h(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function p(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function v(t,e,n){return e&&p(t.prototype,e),n&&p(t,n),t}function y(t,e){return!e||"object"!==f(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function b(t){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function g(t,e){return(g=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var m=function(t){function e(t){var n;d(this,e);var r=new a.a("ellipsis");return(n=y(this,b(e).call(this,r,"auto",!1,"top-left","dd-more"))).contentClick=t,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&g(t,e)}(e,s["a"]),v(e,[{key:"reset",value:function(t){var e=this,n=t.map(function(t,n){return Object(r.b)("div","".concat(o.a,"-item")).css("width","150px").css("font-weight","normal").on("click",function(){e.contentClick(n),e.hide()}).child(t)});this.setContentChildren.apply(this,h(n))}},{key:"setTitle",value:function(){}}]),e}(),w=[{key:"delete",title:Object(c.c)("contextmenu.deleteSheet")}];function L(){var t=this;return w.map(function(e){return function(t){var e=this;return Object(r.b)("div","".concat(o.a,"-item")).child(t.title()).on("click",function(){e.itemClick(t.key),e.hide()})}.call(t,e)})}var O=function(){function t(){var e;d(this,t),this.el=(e=Object(r.b)("div","".concat(o.a,"-contextmenu")).css("width","160px")).children.apply(e,h(L.call(this))).hide(),this.itemClick=function(){}}return v(t,[{key:"hide",value:function(){var t=this.el;t.hide(),Object(i.g)(t)}},{key:"setOffset",value:function(t){var e=this.el;e.offset(t),e.show(),Object(i.b)(e)}}]),t}(),k=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){};d(this,t),this.swapFunc=i,this.updateFunc=s,this.dataNames=[],this.activeEl=null,this.deleteEl=null,this.items=[],this.moreEl=new m(function(t){e.clickSwap2(e.items[t])}),this.contextMenu=new O,this.contextMenu.itemClick=l,this.el=Object(r.b)("div","".concat(o.a,"-bottombar")).children(this.contextMenu.el,this.menuEl=Object(r.b)("ul","".concat(o.a,"-menu")).child(Object(r.b)("li","").children(new a.a("add").on("click",function(){n()}),Object(r.b)("span","").child(this.moreEl))))}return v(t,[{key:"addItem",value:function(t,e,n){var i=this;this.dataNames.push(t);var o=Object(r.b)("li",e?"active":"").child(t);o.on("click",function(){i.clickSwap2(o)}).on("contextmenu",function(t){if("read"!==n.mode){var e=t.target,r=e.offsetLeft,a=e.offsetHeight;i.contextMenu.setOffset({left:r,bottom:a+1}),i.deleteEl=o}}).on("dblclick",function(){if("read"!==n.mode){var t=o.html(),e=new l.a("auto","");e.val(t),e.input.on("blur",function(e){var n=e.target.value,r=i.dataNames.findIndex(function(e){return e===t});i.renameItem(r,n)}),o.html("").child(e.el),e.focus()}}),e&&this.clickSwap(o),this.items.push(o),this.menuEl.child(o),this.moreEl.reset(this.dataNames)}},{key:"renameItem",value:function(t,e){this.dataNames.splice(t,1,e),this.moreEl.reset(this.dataNames),this.items[t].html("").child(e),this.updateFunc(t,e)}},{key:"clear",value:function(){var t=this;this.items.forEach(function(e){t.menuEl.removeChild(e.el)}),this.items=[],this.dataNames=[],this.moreEl.reset(this.dataNames)}},{key:"deleteItem",value:function(){var t=this.activeEl,e=this.deleteEl;if(this.items.length>1){var n=this.items.findIndex(function(t){return t===e});if(this.items.splice(n,1),this.dataNames.splice(n,1),this.menuEl.removeChild(e.el),this.moreEl.reset(this.dataNames),t===e){var r=u(this.items,1)[0];return this.activeEl=r,this.activeEl.toggle(),[n,0]}return[n,-1]}return[-1]}},{key:"clickSwap2",value:function(t){var e=this.items.findIndex(function(e){return e===t});this.clickSwap(t),this.activeEl.toggle(),this.swapFunc(e)}},{key:"clickSwap",value:function(t){null!==this.activeEl&&this.activeEl.toggle(),this.activeEl=t}}]),t}()},function(t,e,n){"use strict";var r=n(0),i=n(3),o=n(1);function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var l=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments.length>1?arguments[1]:void 0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.moving=!1,this.vertical=n,this.el=Object(r.b)("div","".concat(o.a,"-resizer ").concat(n?"vertical":"horizontal")).children(this.unhideHoverEl=Object(r.b)("div","".concat(o.a,"-resizer-hover")).on("dblclick.stop",function(t){return e.mousedblclickHandler(t)}).css("position","absolute").hide(),this.hoverEl=Object(r.b)("div","".concat(o.a,"-resizer-hover")).on("mousedown.stop",function(t){return e.mousedownHandler(t)}),this.lineEl=Object(r.b)("div","".concat(o.a,"-resizer-line")).hide()).hide(),this.cRect=null,this.finishedFn=null,this.minDistance=i,this.unhideFn=function(){}}var e,n,l;return e=t,(n=[{key:"showUnhide",value:function(t){this.unhideIndex=t,this.unhideHoverEl.show()}},{key:"hideUnhide",value:function(){this.unhideHoverEl.hide()}},{key:"show",value:function(t,e){var n=this.moving,r=this.vertical,i=this.hoverEl,o=this.lineEl,a=this.el,l=this.unhideHoverEl;if(!n){this.cRect=t;var s=t.left,c=t.top,u=t.width,f=t.height;a.offset({left:r?s+u-5:s,top:r?c:c+f-5}).show(),i.offset({width:r?5:u,height:r?f:5}),o.offset({width:r?0:e.width,height:r?e.height:0}),l.offset({left:r?5-u:s,top:r?c:5-f,width:r?5:u,height:r?f:5})}}},{key:"hide",value:function(){this.el.offset({left:0,top:0}).hide(),this.hideUnhide()}},{key:"mousedblclickHandler",value:function(){this.unhideIndex&&this.unhideFn(this.unhideIndex)}},{key:"mousedownHandler",value:function(t){var e=this,n=t,r=this.el,o=this.lineEl,a=this.cRect,l=this.vertical,s=this.minDistance,c=l?a.width:a.height;o.show(),Object(i.e)(window,function(t){e.moving=!0,null!==n&&1===t.buttons&&(l?(c+=t.movementX)>s&&r.css("left","".concat(a.left+c,"px")):(c+=t.movementY)>s&&r.css("top","".concat(a.top+c,"px")),n=t)},function(){n=null,o.hide(),e.moving=!1,e.hide(),e.finishedFn&&(c<s&&(c=s),e.finishedFn(a,c))})}}])&&a(e.prototype,n),l&&a(e,l),t}();function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var c=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.vertical=e,this.moveFn=null,this.el=Object(r.b)("div","".concat(o.a,"-scrollbar ").concat(e?"vertical":"horizontal")).child(this.contentEl=Object(r.b)("div","")).on("mousemove.stop",function(){}).on("scroll.stop",function(t){var e=t.target,r=e.scrollTop,i=e.scrollLeft;n.moveFn&&n.moveFn(n.vertical?r:i,t)})}var e,n,i;return e=t,(n=[{key:"move",value:function(t){return this.el.scroll(t),this}},{key:"scroll",value:function(){return this.el.scroll()}},{key:"set",value:function(t,e){var n=t-1;if(e>n){var r=this.vertical?"height":"width";this.el.css(r,"".concat(n-15,"px")).show(),this.contentEl.css(this.vertical?"width":"height","1px").css(r,"".concat(e,"px"))}else this.el.hide();return this}}])&&s(e.prototype,n),i&&s(e,i),t}(),u=n(7);function f(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function d(t,e,n){return e&&h(t.prototype,e),n&&h(t,n),t}var p=10,v=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];f(this,t),this.useHideInput=n,this.autoFocus=i,this.inputChange=function(){},this.cornerEl=Object(r.b)("div","".concat(o.a,"-selector-corner")),this.areaEl=Object(r.b)("div","".concat(o.a,"-selector-area")).child(this.cornerEl).hide(),this.clipboardEl=Object(r.b)("div","".concat(o.a,"-selector-clipboard")).hide(),this.autofillEl=Object(r.b)("div","".concat(o.a,"-selector-autofill")).hide(),this.el=Object(r.b)("div","".concat(o.a,"-selector")).css("z-index","".concat(p)).children(this.areaEl,this.clipboardEl,this.autofillEl).hide(),n&&(this.hideInput=Object(r.b)("input","").on("compositionend",function(t){e.inputChange(t.target.value)}),this.el.child(this.hideInputDiv=Object(r.b)("div","hide-input").child(this.hideInput)),this.el.child(this.hideInputDiv=Object(r.b)("div","hide-input").child(this.hideInput))),p+=1}return d(t,[{key:"setOffset",value:function(t){return this.el.offset(t).show(),this}},{key:"hide",value:function(){return this.el.hide(),this}},{key:"setAreaOffset",value:function(t){var e=t.left,n=t.top,r={width:t.width-3+.8,height:t.height-3+.8,left:e-.8,top:n-.8};this.areaEl.offset(r).show(),this.useHideInput&&(this.hideInputDiv.offset(r),this.autoFocus?this.hideInput.val("").focus():this.hideInput.val(""))}},{key:"setClipboardOffset",value:function(t){var e=t.left,n=t.top,r=t.width,i=t.height;this.clipboardEl.offset({left:e,top:n,width:r-5,height:i-5})}},{key:"showAutofill",value:function(t){var e=t.left,n=t.top,r=t.width,i=t.height;this.autofillEl.offset({width:r-3,height:i-3,left:e,top:n}).show()}},{key:"hideAutofill",value:function(){this.autofillEl.hide()}},{key:"showClipboard",value:function(){this.clipboardEl.show()}},{key:"hideClipboard",value:function(){this.clipboardEl.hide()}}]),t}();function y(t){var e=this.data,n=t.left,r=t.top,i=t.width,o=t.height,a=t.scroll,l=t.l,s=t.t,c=e.freezeTotalWidth(),u=e.freezeTotalHeight(),f=n-c;c>l&&(f-=a.x);var h=r-u;return u>s&&(h-=a.y),{left:f,top:h,width:i,height:o}}function b(t){var e=this.data,n=t.left,r=t.width,i=t.height,o=t.l,a=t.t,l=t.scroll,s=e.freezeTotalWidth(),c=n-s;return s>o&&(c-=l.x),{left:c,top:a,width:r,height:i}}function g(t){var e=this.data,n=t.top,r=t.width,i=t.height,o=t.l,a=t.t,l=t.scroll,s=e.freezeTotalHeight(),c=n-s;return s>a&&(c-=l.y),{left:o,top:c,width:r,height:i}}function m(t){this.br.setAreaOffset(y.call(this,t))}function w(t){this.t.setAreaOffset(b.call(this,t))}function L(t){this.l.setAreaOffset(g.call(this,t))}function O(t){this.l.setClipboardOffset(g.call(this,t))}function k(t){this.br.setClipboardOffset(y.call(this,t))}function j(t){this.t.setClipboardOffset(b.call(this,t))}function x(t){m.call(this,t),function(t){this.tl.setAreaOffset(t)}.call(this,t),w.call(this,t),L.call(this,t)}function _(t){k.call(this,t),function(t){this.tl.setClipboardOffset(t)}.call(this,t),j.call(this,t),O.call(this,t)}var S=function(){function t(e){var n=this;f(this,t);var i=e.settings.autoFocus;this.inputChange=function(){},this.data=e,this.br=new v(!0,i),this.t=new v,this.l=new v,this.tl=new v,this.br.inputChange=function(t){n.inputChange(t)},this.br.el.show(),this.offset=null,this.areaOffset=null,this.indexes=null,this.range=null,this.arange=null,this.el=Object(r.b)("div","".concat(o.a,"-selectors")).children(this.tl.el,this.t.el,this.l.el,this.br.el).hide(),this.lastri=-1,this.lastci=-1,p+=1}return d(t,[{key:"resetData",value:function(t){this.data=t,this.range=t.selector.range,this.resetAreaOffset()}},{key:"hide",value:function(){this.el.hide()}},{key:"resetOffset",value:function(){var t=this.data,e=this.tl,n=this.t,r=this.l,i=this.br,o=t.freezeTotalHeight(),a=t.freezeTotalWidth();o>0||a>0?(e.setOffset({width:a,height:o}),n.setOffset({left:a,height:o}),r.setOffset({top:o,width:a}),i.setOffset({left:a,top:o})):(e.hide(),n.hide(),r.hide(),i.setOffset({left:0,top:0}))}},{key:"resetAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getClipboardRect();x.call(this,t),_.call(this,e),this.resetOffset()}},{key:"resetBRTAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getClipboardRect();m.call(this,t),w.call(this,t),k.call(this,e),j.call(this,e),this.resetOffset()}},{key:"resetBRLAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getClipboardRect();m.call(this,t),L.call(this,t),k.call(this,e),O.call(this,e),this.resetOffset()}},{key:"set",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this.data,i=r.calSelectedRangeByStart(t,e),o=i.sri,a=i.sci;if(n){var l=t,s=e;t<0&&(l=0),e<0&&(s=0),r.selector.setIndexes(l,s),this.indexes=[l,s]}this.moveIndexes=[o,a],this.range=i,this.resetAreaOffset(),this.el.show()}},{key:"setEnd",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this.data,i=this.lastri,o=this.lastci;if(n){if(t===i&&e===o)return;this.lastri=t,this.lastci=e}this.range=r.calSelectedRangeByEnd(t,e),x.call(this,this.data.getSelectedRect())}},{key:"reset",value:function(){var t=this.data.selector.range,e=t.eri,n=t.eci;this.setEnd(e,n)}},{key:"showAutofill",value:function(t,e){if(-1!==t||-1!==e){var n=this.range,r=n.sri,i=n.sci,o=n.eri,a=n.eci,l=t,s=e,c=r-t,f=o-t,h=a-e;if(i-e>0)this.arange=new u.a(r,s,o,i-1);else if(c>0)this.arange=new u.a(l,i,r-1,a);else if(h<0)this.arange=new u.a(r,a+1,o,s);else{if(!(f<0))return void(this.arange=null);this.arange=new u.a(o+1,i,l,a)}if(null!==this.arange){var d=this.data.getRect(this.arange);d.width+=2,d.height+=2;var p=this.br,v=this.l,m=this.t,w=this.tl;p.showAutofill(y.call(this,d)),v.showAutofill(g.call(this,d)),m.showAutofill(b.call(this,d)),w.showAutofill(d)}}}},{key:"hideAutofill",value:function(){var t=this;["br","l","t","tl"].forEach(function(e){t[e].hideAutofill()})}},{key:"showClipboard",value:function(){var t=this,e=this.data.getClipboardRect();_.call(this,e),["br","l","t","tl"].forEach(function(e){t[e].showClipboard()})}},{key:"hideClipboard",value:function(){var t=this;["br","l","t","tl"].forEach(function(e){t[e].hideClipboard()})}}]),t}();function C(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function E(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function M(t){t.preventDefault();var e=this.filterItems;e.length<=0||(t.stopPropagation(),this.itemIndex<0&&(this.itemIndex=0),e[this.itemIndex].el.click(),this.hide())}var T=function(){function t(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"200px";!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.filterItems=[],this.items=e,this.el=Object(r.b)("div","".concat(o.a,"-suggest")).css("width",i).hide(),this.itemClick=n,this.itemIndex=-1}var e,n,a;return e=t,(n=[{key:"setOffset",value:function(t){this.el.cssRemoveKeys("top","bottom").offset(t)}},{key:"hide",value:function(){var t=this.el;this.filterItems=[],this.itemIndex=-1,t.hide(),Object(i.g)(this.el.parent())}},{key:"setItems",value:function(t){this.items=t}},{key:"search",value:function(t){var e,n=this,a=this.items;if(/^\s*$/.test(t)||(a=a.filter(function(e){return(e.key||e).startsWith(t.toUpperCase())})),a=a.map(function(t){var e=t.title;e?"function"==typeof e&&(e=e()):e=t;var i=Object(r.b)("div","".concat(o.a,"-item")).child(e).on("click.stop",function(){n.itemClick(t),n.hide()});return t.label&&i.child(Object(r.b)("div","label").html(t.label)),i}),this.filterItems=a,!(a.length<=0)){var l=this.el;(e=l.html("")).children.apply(e,C(a)).show(),Object(i.b)(l.parent(),function(){n.hide()})}}},{key:"bindInputEvents",value:function(t){var e=this;t.on("keydown",function(t){return function(t){var e=t.keyCode;switch(t.ctrlKey&&t.stopPropagation(),e){case 37:t.stopPropagation();break;case 38:(function(t){t.preventDefault(),t.stopPropagation();var e=this.filterItems;e.length<=0||(this.itemIndex>=0&&e[this.itemIndex].toggle(),this.itemIndex-=1,this.itemIndex<0&&(this.itemIndex=e.length-1),e[this.itemIndex].toggle())}).call(this,t);break;case 39:t.stopPropagation();break;case 40:(function(t){t.stopPropagation();var e=this.filterItems;e.length<=0||(this.itemIndex>=0&&e[this.itemIndex].toggle(),this.itemIndex+=1,this.itemIndex>e.length-1&&(this.itemIndex=0),e[this.itemIndex].toggle())}).call(this,t);break;case 13:case 9:M.call(this,t);break;default:t.stopPropagation()}}.call(e,t)})}}])&&E(e.prototype,n),a&&E(e,a),t}(),P=n(4),A=n(2);function Z(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function D(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function z(t,e){t.setMonth(t.getMonth()+e)}function R(t,e){var n=new Date(t);return n.setDate(e-t.getDay()+1),n}var F=function(){function t(e){var n,i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.value=e,this.cvalue=new Date(e),this.headerLeftEl=Object(r.b)("div","calendar-header-left"),this.bodyEl=Object(r.b)("tbody",""),this.buildAll(),this.el=Object(r.b)("div","x-spreadsheet-calendar").children(Object(r.b)("div","calendar-header").children(this.headerLeftEl,Object(r.b)("div","calendar-header-right").children(Object(r.b)("a","calendar-prev").on("click.stop",function(){return i.prev()}).child(new P.a("chevron-left")),Object(r.b)("a","calendar-next").on("click.stop",function(){return i.next()}).child(new P.a("chevron-right")))),Object(r.b)("table","calendar-body").children(Object(r.b)("thead","").child((n=Object(r.b)("tr","")).children.apply(n,Z(Object(A.b)("calendar.weeks").map(function(t){return Object(r.b)("th","cell").child(t)})))),this.bodyEl)),this.selectChange=function(){}}var e,n,i;return e=t,(n=[{key:"setValue",value:function(t){this.value=t,this.cvalue=new Date(t),this.buildAll()}},{key:"prev",value:function(){z(this.value,-1),this.buildAll()}},{key:"next",value:function(){z(this.value,1),this.buildAll()}},{key:"buildAll",value:function(){this.buildHeaderLeft(),this.buildBody()}},{key:"buildHeaderLeft",value:function(){var t=this.value;this.headerLeftEl.html("".concat(Object(A.b)("calendar.months")[t.getMonth()]," ").concat(t.getFullYear()))}},{key:"buildBody",value:function(){var t,e=this,n=this.value,i=this.cvalue,o=this.bodyEl,a=function(t,e,n){for(var r=new Date(t,e,1,23,59,59),i=[[],[],[],[],[],[]],o=0;o<6;o+=1)for(var a=0;a<7;a+=1){var l=R(r,7*o+a),s=l.getMonth()!==e,c=l.getMonth()===n.getMonth()&&l.getDate()===n.getDate();i[o][a]={d:l,disabled:s,active:c}}return i}(n.getFullYear(),n.getMonth(),i).map(function(t){var n,i=t.map(function(t){var n="cell";return t.disabled&&(n+=" disabled"),t.active&&(n+=" active"),Object(r.b)("td","").child(Object(r.b)("div",n).on("click.stop",function(){e.selectChange(t.d)}).child(t.d.getDate().toString()))});return(n=Object(r.b)("tr","")).children.apply(n,Z(i))});(t=o.html("")).children.apply(t,Z(a))}}])&&D(e.prototype,n),i&&D(e,i),t}();function I(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var N=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.calendar=new F(new Date),this.el=Object(r.b)("div","".concat(o.a,"-datepicker")).child(this.calendar.el).hide()}var e,n,i;return e=t,(n=[{key:"setValue",value:function(t){var e=this.calendar;return"string"==typeof t?/^\d{4}-\d{1,2}-\d{1,2}$/.test(t)&&e.setValue(new Date(t.replace(new RegExp("-","g"),"/"))):t instanceof Date&&e.setValue(t),this}},{key:"change",value:function(t){var e=this;this.calendar.selectChange=function(n){t(n),e.hide()}}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide()}}])&&I(e.prototype,n),i&&I(e,i),t}();function H(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function V(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function W(){var t=this.inputText;if(!/^\s*$/.test(t)){var e=this.textlineEl,n=this.textEl,r=this.areaOffset,i=t.split("\n"),o=Math.max.apply(Math,V(i.map(function(t){return t.length}))),a=e.offset().width/t.length,l=(o+1)*a+5,s=this.viewFn().width-r.left-a,c=i.length;if(l>r.width){var u=l;l>s&&(u=s,c+=parseInt(l/s,10),c+=l%s>0?1:0),n.css("width","".concat(u,"px"))}(c*=this.rowHeight)>r.height&&n.css("height","".concat(c,"px"))}}function Y(t){var e=t.keyCode,n=t.altKey;13!==e&&9!==e&&t.stopPropagation(),13===e&&n&&(function(t,e){var n=t.target,r=n.value,i=n.selectionEnd,o="".concat(r.slice(0,i)).concat(e).concat(r.slice(i));n.value=o,n.setSelectionRange(i+1,i+1),this.inputText=o,this.textlineEl.html(o),W.call(this)}.call(this,t,"\n"),t.stopPropagation()),13!==e||n||t.preventDefault()}function B(t,e){var n=this.textEl,r=this.textlineEl;n.el.blur(),n.val(t),r.html(t),function(t){var e=this.textEl.el;setTimeout(function(){e.focus(),e.setSelectionRange(t,t)},0)}.call(this,e)}var q=function(){function t(e,n,i){var a=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.viewFn=n,this.rowHeight=i,this.formulas=e,this.suggest=new T(e,function(t){(function(t){var e=this.inputText,n=this.validator,r=0;if(n&&"list"===n.type)this.inputText=t,r=this.inputText.length;else{var i=e.lastIndexOf("="),o=e.substring(0,i+1),a=e.substring(i+1);a=-1!==a.indexOf(")")?a.substring(a.indexOf(")")):"",this.inputText="".concat(o+t.key,"("),r=this.inputText.length,this.inputText+=")".concat(a)}B.call(this,this.inputText,r)}).call(a,t)}),this.datepicker=new N,this.datepicker.change(function(t){a.setText(function(t){var e=t.getMonth()+1,n=t.getDate();return e<10&&(e="0".concat(e)),n<10&&(n="0".concat(n)),"".concat(t.getFullYear(),"-").concat(e,"-").concat(n)}(t)),a.clear()}),this.areaEl=Object(r.b)("div","".concat(o.a,"-editor-area")).children(this.textEl=Object(r.b)("textarea","").on("input",function(t){return function(t){var e=t.target.value,n=this.suggest,r=this.textlineEl,i=this.validator,o=this.cell;if(null!==o)if("editable"in o&&!0===o.editable||void 0===o.editable){if(this.inputText=e,i)"list"===i.type?n.search(e):n.hide();else{var a=e.lastIndexOf("=");-1!==a?n.search(e.substring(a+1)):n.hide()}r.html(e),W.call(this),this.change("input",e)}else t.target.value=o.text||"";else{if(this.inputText=e,i)"list"===i.type?n.search(e):n.hide();else{var l=e.lastIndexOf("=");-1!==l?n.search(e.substring(l+1)):n.hide()}r.html(e),W.call(this),this.change("input",e)}}.call(a,t)}).on("paste.stop",function(){}).on("keydown",function(t){return Y.call(a,t)}),this.textlineEl=Object(r.b)("div","textline"),this.suggest.el,this.datepicker.el).on("mousemove.stop",function(){}).on("mousedown.stop",function(){}),this.el=Object(r.b)("div","".concat(o.a,"-editor")).child(this.areaEl).hide(),this.suggest.bindInputEvents(this.textEl),this.areaOffset=null,this.freeze={w:0,h:0},this.cell=null,this.inputText="",this.change=function(){}}var e,n,i;return e=t,(n=[{key:"setFreezeLengths",value:function(t,e){this.freeze.w=t,this.freeze.h=e}},{key:"clear",value:function(){""!==this.inputText&&this.change("finished",this.inputText),this.cell=null,this.areaOffset=null,this.inputText="",this.el.hide(),this.textEl.val(""),this.textlineEl.html(""),function(){this.suggest.setItems(this.formulas)}.call(this),this.datepicker.hide()}},{key:"setOffset",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"top",n=this.textEl,r=this.areaEl,i=this.suggest,o=this.freeze,a=this.el;if(t){this.areaOffset=t;var l=t.left,s=t.top,c=t.width,u=t.height,f=t.l,h=t.t,d={left:0,top:0};o.w>f&&o.h>h||(o.w<f&&o.h<h?(d.left=o.w,d.top=o.h):o.w>f?d.top=o.h:o.h>h&&(d.left=o.w)),a.offset(d),r.offset({left:l-d.left-.8,top:s-d.top-.8}),n.offset({width:c-9+.8,height:u-3+.8});var p={left:0};p[e]=u,i.setOffset(p),i.hide()}}},{key:"setCell",value:function(t,e){if(!t||!1!==t.editable){var n=this.el,r=this.datepicker,i=this.suggest;n.show(),this.cell=t;var o=t&&t.text||"";if(this.setText(o),this.validator=e,e){var a=e.type;"date"===a&&(r.show(),/^\s*$/.test(o)||r.setValue(o)),"list"===a&&(i.setItems(e.values()),i.search(""))}}}},{key:"setText",value:function(t){this.inputText=t,B.call(this,t,t.length),W.call(this)}}])&&H(e.prototype,n),i&&H(e,i),t}();function U(t){return(U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $(t,e){return!e||"object"!==U(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function J(t){return(J=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function G(t,e){return(G=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var X=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=$(this,J(e).call(this,"div","".concat(o.a,"-button ").concat(r)))).child(Object(A.b)("button.".concat(t))),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&G(t,e)}(e,r["a"]),e}(),K=n(11),Q=n(15);function tt(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function et(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var nt=[["A3",11.69,16.54],["A4",8.27,11.69],["A5",5.83,8.27],["B4",9.84,13.9],["B5",6.93,9.84]],rt=["landscape","portrait"];function it(t){return parseInt(96*t,10)}function ot(t){"cancel"===t?this.el.hide():this.toPrint()}var at=function(){function t(e){var n,i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.paper={w:it(nt[0][1]),h:it(nt[0][2]),padding:50,orientation:rt[0],get width(){return"landscape"===this.orientation?this.h:this.w},get height(){return"landscape"===this.orientation?this.w:this.h}},this.data=e,this.el=Object(r.b)("div","".concat(o.a,"-print")).children(Object(r.b)("div","".concat(o.a,"-print-bar")).children(Object(r.b)("div","-title").child("Print settings"),Object(r.b)("div","-right").children(Object(r.b)("div","".concat(o.a,"-buttons")).children(new X("cancel").on("click",ot.bind(this,"cancel")),new X("next","primary").on("click",ot.bind(this,"next"))))),Object(r.b)("div","".concat(o.a,"-print-content")).children(this.contentEl=Object(r.b)("div","-content"),Object(r.b)("div","-sider").child(Object(r.b)("form","").children(Object(r.b)("fieldset","").children(Object(r.b)("label","").child("".concat(Object(A.b)("print.size"))),(n=Object(r.b)("select","")).children.apply(n,tt(nt.map(function(t,e){return Object(r.b)("option","").attr("value",e).child("".concat(t[0]," ( ").concat(t[1],"''x").concat(t[2],"'' )"))}))).on("change",function(t){var e=this.paper,n=t.target.value,r=nt[n];e.w=it(r[1]),e.h=it(r[2]),this.preview()}.bind(this))),Object(r.b)("fieldset","").children(Object(r.b)("label","").child("".concat(Object(A.b)("print.orientation"))),(i=Object(r.b)("select","")).children.apply(i,tt(rt.map(function(t,e){return Object(r.b)("option","").attr("value",e).child("".concat(Object(A.b)("print.orientations")[e]))}))).on("change",function(t){var e=this.paper,n=t.target.value,r=rt[n];e.orientation=r,this.preview()}.bind(this))))))).hide()}var e,n,i;return e=t,(n=[{key:"resetData",value:function(t){this.data=t}},{key:"preview",value:function(){var t=this,e=this.data,n=this.paper,i=n.width,a=n.height,l=n.padding,s=i-2*l,c=a-2*l,u=e.contentRange(),f=parseInt(u.h/c,10)+1,h=s/u.w,d=l,p=l;h>1&&(d+=(s-u.w)/2);var v=0,y=0;this.contentEl.html(""),this.canvases=[];for(var b={sri:0,sci:0,eri:0,eci:0},g=function(n){var l=0,s=0,f=Object(r.b)("div","".concat(o.a,"-canvas-card")),g=Object(r.b)("canvas","".concat(o.a,"-canvas"));t.canvases.push(g.el);var m=new K.a(g.el,i,a);for(m.save(),m.translate(d,p),h<1&&m.scale(h,h);v<=u.eri;v+=1){var w=e.rows.getHeight(v);if(!((l+=w)<c)){s=-(l-w);break}for(var L=0;L<=u.eci;L+=1)Object(Q.b)(m,e,v,L,y),b.eci=L}b.eri=v,m.restore(),m.save(),m.translate(d,p),h<1&&m.scale(h,h);var O=y;e.eachMergesInView(b,function(t){var n=t.sri,r=t.sci;Object(Q.b)(m,e,n,r,O)}),m.restore(),b.sri=b.eri,b.sci=b.eci,y+=s,t.contentEl.child(Object(r.b)("div","".concat(o.a,"-canvas-card-wraper")).child(f.child(g)))},m=0;m<f;m+=1)g();this.el.show()}},{key:"toPrint",value:function(){this.el.hide();var t=this.paper,e=Object(r.b)("iframe","").hide().el;window.document.body.appendChild(e);var n=e.contentWindow,i=n.document,o=document.createElement("style");o.innerHTML="\n      @page { size: ".concat(t.width,"px ").concat(t.height,"px; };\n      canvas {\n        page-break-before: auto;        \n        page-break-after: always;\n        image-rendering: pixelated;\n      };\n    "),i.head.appendChild(o),this.canvases.forEach(function(t){var e=t.cloneNode(!1);e.getContext("2d").drawImage(t,0,0),i.body.appendChild(e)}),n.print()}}])&&et(e.prototype,n),i&&et(e,i),t}();function lt(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function st(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ct=[{key:"copy",title:Object(A.c)("contextmenu.copy"),label:"Ctrl+C"},{key:"cut",title:Object(A.c)("contextmenu.cut"),label:"Ctrl+X"},{key:"paste",title:Object(A.c)("contextmenu.paste"),label:"Ctrl+V"},{key:"paste-value",title:Object(A.c)("contextmenu.pasteValue"),label:"Ctrl+Shift+V"},{key:"paste-format",title:Object(A.c)("contextmenu.pasteFormat"),label:"Ctrl+Alt+V"},{key:"divider"},{key:"insert-row",title:Object(A.c)("contextmenu.insertRow")},{key:"insert-column",title:Object(A.c)("contextmenu.insertColumn")},{key:"divider"},{key:"delete-row",title:Object(A.c)("contextmenu.deleteRow")},{key:"delete-column",title:Object(A.c)("contextmenu.deleteColumn")},{key:"delete-cell-text",title:Object(A.c)("contextmenu.deleteCellText")},{key:"hide",title:Object(A.c)("contextmenu.hide")},{key:"divider"},{key:"validation",title:Object(A.c)("contextmenu.validation")},{key:"divider"},{key:"cell-printable",title:Object(A.c)("contextmenu.cellprintable")},{key:"cell-non-printable",title:Object(A.c)("contextmenu.cellnonprintable")},{key:"divider"},{key:"cell-editable",title:Object(A.c)("contextmenu.celleditable")},{key:"cell-non-editable",title:Object(A.c)("contextmenu.cellnoneditable")}];function ut(t){var e=this,n=ct;if(!t.showValidation){var i=ct.findIndex(function(t){return"validation"===t.key});(n=ct.slice()).splice(i,2)}return n.map(function(t){return function(t){var e=this;return"divider"===t.key?Object(r.b)("div","".concat(o.a,"-item divider")):Object(r.b)("div","".concat(o.a,"-item")).on("click",function(){e.itemClick(t.key),e.hide()}).children(t.title(),Object(r.b)("div","label").child(t.label||""))}.call(e,t)})}var ft=function(){function t(e){var n,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.menuItems=ut.call(this,a),this.el=(n=Object(r.b)("div","".concat(o.a,"-contextmenu"))).children.apply(n,lt(this.menuItems)).hide(),this.viewFn=e,this.itemClick=function(){},this.isHide=i,this.setMode("range")}var e,n,a;return e=t,(n=[{key:"setMode",value:function(t){var e=this.menuItems[12];"row-col"===t?e.show():e.hide()}},{key:"hide",value:function(){var t=this.el;t.hide(),Object(i.g)(t)}},{key:"setPosition",value:function(t,e){if(!this.isHide){var n=this.el,r=n.show().offset().width,o=this.viewFn(),a=o.height/2,l=t;o.width-t<=r&&(l-=r),n.css("left","".concat(l,"px")),e>a?n.css("bottom","".concat(o.height-e,"px")).css("max-height","".concat(e,"px")).css("top","auto"):n.css("top","".concat(e,"px")).css("max-height","".concat(o.height-e,"px")).css("bottom","auto"),Object(i.b)(n)}}}])&&st(e.prototype,n),a&&st(e,a),t}();function ht(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var dt=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tip="",e&&(this.tip=Object(A.b)("toolbar.".concat(e.replace(/-[a-z]/g,function(t){return t[1].toUpperCase()})))),n&&(this.tip+=" (".concat(n,")")),this.tag=e,this.shortcut=n,this.value=r,this.el=this.element(),this.change=function(){}}var e,n,a;return e=t,(n=[{key:"element",value:function(){var t=this,e=this.tip;return Object(r.b)("div","".concat(o.a,"-toolbar-btn")).on("mouseenter",function(e){t.tip&&function(t,e){if(!e.classList.contains("active")){var n=e.getBoundingClientRect(),a=n.left,l=n.top,s=n.width,c=n.height,u=Object(r.b)("div","".concat(o.a,"-tooltip")).html(t).show(),f=e.parentElement.parentElement;f.appendChild(u.el);var h=u.box(),d=f.getBoundingClientRect(),p=a-d.left,v=l-d.top;u.css("left","".concat(p+s/2-h.width/2,"px")).css("top","".concat(v+c+2,"px")),Object(i.a)(e,"mouseleave",function(){f.contains(u.el)&&f.removeChild(u.el)}),Object(i.a)(e,"click",function(){f.contains(u.el)&&f.removeChild(u.el)})}}(t.tip,e.target)}).attr("data-tooltip",e)}},{key:"setState",value:function(){}}])&&ht(e.prototype,n),a&&ht(e,a),t}();function pt(t){return(pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function yt(t,e){return!e||"object"!==pt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function bt(t,e,n){return(bt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=gt(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function gt(t){return(gt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function mt(t,e){return(mt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var wt=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),yt(this,gt(e).apply(this,arguments))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&mt(t,e)}(e,dt),n=e,(r=[{key:"dropdown",value:function(){}},{key:"getValue",value:function(t){return t}},{key:"element",value:function(){var t=this,n=this.tag;return this.dd=this.dropdown(),this.dd.change=function(e){return t.change(n,t.getValue(e))},bt(gt(e.prototype),"element",this).call(this).child(this.dd)}},{key:"setState",value:function(t){void 0!==t&&(this.value=t,this.dd.setTitle(t))}}])&&vt(n.prototype,r),i&&vt(n,i),e}(),Lt=n(8);function Ot(t){return(Ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function kt(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function jt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function xt(t,e){return!e||"object"!==Ot(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function _t(t){return(_t=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function St(t,e){return(St=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ct=function(t){function e(t,n){var i,a;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var l=new P.a("align-".concat(n)),s=t.map(function(t){return(e="align-".concat(t),Object(r.b)("div","".concat(o.a,"-item")).child(new P.a(e))).on("click",function(){a.setTitle(t),a.change(t)});var e});return a=xt(this,(i=_t(e)).call.apply(i,[this,l,"auto",!0,"bottom-left","dd-align"].concat(kt(s))))}var n,i,a;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&St(t,e)}(e,Lt["a"]),n=e,(i=[{key:"setTitle",value:function(t){this.title.setName("align-".concat(t)),this.hide()}}])&&jt(n.prototype,i),a&&jt(n,a),e}();function Et(t){return(Et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Tt(t,e){return!e||"object"!==Et(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Pt(t){return(Pt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function At(t,e){return(At=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Zt=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Tt(this,Pt(e).call(this,"align","",t))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&At(t,e)}(e,wt),n=e,(r=[{key:"dropdown",value:function(){var t=this.value;return new Ct(["left","center","right"],t)}}])&&Mt(n.prototype,r),i&&Mt(n,i),e}();function Dt(t){return(Dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function zt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Rt(t,e){return!e||"object"!==Dt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ft(t){return(Ft=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function It(t,e){return(It=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Nt=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Rt(this,Ft(e).call(this,"valign","",t))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&It(t,e)}(e,wt),n=e,(r=[{key:"dropdown",value:function(){var t=this.value;return new Ct(["top","middle","bottom"],t)}}])&&zt(n.prototype,r),i&&zt(n,i),e}();function Ht(t){return(Ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Wt(t,e){return!e||"object"!==Ht(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Yt(t,e,n){return(Yt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Bt(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Bt(t){return(Bt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function qt(t,e){return(qt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ut=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Wt(this,Bt(e).apply(this,arguments))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&qt(t,e)}(e,dt),n=e,(r=[{key:"element",value:function(){var t=this,n=this.tag;return Yt(Bt(e.prototype),"element",this).call(this).child(new P.a(n)).on("click",function(){return t.click()})}},{key:"click",value:function(){this.change(this.tag,this.toggle())}},{key:"setState",value:function(t){this.el.active(t)}},{key:"toggle",value:function(){return this.el.toggle()}},{key:"active",value:function(){return this.el.hasClass("active")}}])&&Vt(n.prototype,r),i&&Vt(n,i),e}();function $t(t){return($t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Jt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Gt(t,e){return!e||"object"!==$t(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Xt(t){return(Xt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Kt(t,e){return(Kt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Qt=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Gt(this,Xt(e).call(this,"autofilter"))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Kt(t,e)}(e,Ut),n=e,(r=[{key:"setState",value:function(){}}])&&Jt(n.prototype,r),i&&Jt(n,i),e}();function te(t){return(te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ee(t,e){return!e||"object"!==te(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ne(t){return(ne=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function re(t,e){return(re=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ie=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),ee(this,ne(e).call(this,"font-bold","Ctrl+B"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&re(t,e)}(e,Ut),e}();function oe(t){return(oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ae(t,e){return!e||"object"!==oe(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function le(t){return(le=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function se(t,e){return(se=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ce=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),ae(this,le(e).call(this,"font-italic","Ctrl+I"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&se(t,e)}(e,Ut),e}();function ue(t){return(ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fe(t,e){return!e||"object"!==ue(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function he(t){return(he=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function de(t,e){return(de=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var pe=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),fe(this,he(e).call(this,"strike","Ctrl+U"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&de(t,e)}(e,Ut),e}();function ve(t){return(ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ye(t,e){return!e||"object"!==ve(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function be(t){return(be=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ge(t,e){return(ge=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var me=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),ye(this,be(e).call(this,"underline","Ctrl+U"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ge(t,e)}(e,Ut),e}();function we(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var Le=["#ffffff","#000100","#e7e5e6","#445569","#5b9cd6","#ed7d31","#a5a5a5","#ffc001","#4371c6","#71ae47"],Oe=[["#f2f2f2","#7f7f7f","#d0cecf","#d5dce4","#deeaf6","#fce5d5","#ededed","#fff2cd","#d9e2f3","#e3efd9"],["#d8d8d8","#595959","#afabac","#adb8ca","#bdd7ee","#f7ccac","#dbdbdb","#ffe59a","#b3c6e7","#c5e0b3"],["#bfbfbf","#3f3f3f","#756f6f","#8596b0","#9cc2e6","#f4b184","#c9c9c9","#fed964","#8eaada","#a7d08c"],["#a5a5a5","#262626","#3a3839","#333f4f","#2e75b5","#c45a10","#7b7b7b","#bf8e01","#2f5596","#538136"],["#7f7f7f","#0c0c0c","#171516","#222a35","#1f4e7a","#843c0a","#525252","#7e6000","#203864","#365624"]],ke=["#c00000","#fe0000","#fdc101","#ffff01","#93d051","#00b04e","#01b0f1","#0170c1","#012060","#7030a0"];function je(t){var e=this;return Object(r.b)("td","").child(Object(r.b)("div","".concat(o.a,"-color-palette-cell")).on("click.stop",function(){return e.change(t)}).css("background-color",t))}var xe=function t(){var e,n,i,a=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.el=Object(r.b)("div","".concat(o.a,"-color-palette")),this.change=function(){};var l=Object(r.b)("table","").children((e=Object(r.b)("tbody","")).children.apply(e,[(n=Object(r.b)("tr","".concat(o.a,"-theme-color-placeholders"))).children.apply(n,we(Le.map(function(t){return je.call(a,t)})))].concat(we(Oe.map(function(t){var e;return(e=Object(r.b)("tr","".concat(o.a,"-theme-colors"))).children.apply(e,we(t.map(function(t){return je.call(a,t)})))})),[(i=Object(r.b)("tr","".concat(o.a,"-standard-colors"))).children.apply(i,we(ke.map(function(t){return je.call(a,t)})))])));this.el.child(l)};function _e(t){return(_e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Se(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ce(t,e){return!e||"object"!==_e(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ee(t){return(Ee=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Me(t,e){return(Me=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Te=function(t){function e(t,n){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=new P.a(t).css("height","16px").css("border-bottom","3px solid ".concat(n)),o=new xe;return o.change=function(t){r.setTitle(t),r.change(t)},r=Ce(this,Ee(e).call(this,i,"auto",!1,"bottom-right","dd-color",o.el))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Me(t,e)}(e,Lt["a"]),n=e,(r=[{key:"setTitle",value:function(t){this.title.css("border-color",t),this.hide()}}])&&Se(n.prototype,r),i&&Se(n,i),e}();function Pe(t){return(Pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ae(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Ze(t,e){return!e||"object"!==Pe(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function De(t){return(De=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ze(t,e){return(ze=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Re=[["thin",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" style="user-select: none;"></line></svg>'],["medium",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="2" style="user-select: none;"><line x1="0" y1="1.0" x2="50" y2="1.0" stroke-width="2" stroke="black" style="user-select: none;"></line></svg>'],["thick",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="3" style="user-select: none;"><line x1="0" y1="1.5" x2="50" y2="1.5" stroke-width="3" stroke="black" style="user-select: none;"></line></svg>'],["dashed",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="2" style="user-select: none;"></line></svg>'],["dotted",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="1" style="user-select: none;"></line></svg>']],Fe=function(t){function e(t){var n,i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var a=new P.a("line-type"),l=0,s=Re.map(function(e,n){return Object(r.b)("div","".concat(o.a,"-item state ").concat(t===e[0]?"checked":"")).on("click",function(){s[l].toggle("checked"),s[n].toggle("checked"),l=n,i.hide(),i.change(e)}).child(Object(r.b)("div","".concat(o.a,"-line-type")).html(e[1]))});return i=Ze(this,(n=De(e)).call.apply(n,[this,a,"auto",!1,"bottom-right","dd-linetype"].concat(Ae(s))))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ze(t,e)}(e,Lt["a"]),e}();function Ie(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Ne(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function He(){var t;return Object(r.b)("table","").child((t=Object(r.b)("tbody","")).children.apply(t,arguments))}function Ve(t){var e=this;return Object(r.b)("td","").child(Object(r.b)("div","".concat(o.a,"-border-palette-cell")).child(new P.a("border-".concat(t))).on("click",function(){e.mode=t;var n=e.mode,r=e.style,i=e.color;e.change({mode:n,style:r,color:i})}))}var We=function t(){var e,n,i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.color="#000",this.style="thin",this.mode="all",this.change=function(){},this.ddColor=new Te("line-color",this.color),this.ddColor.change=function(t){i.color=t},this.ddType=new Fe(this.style),this.ddType.change=function(t){var e=Ne(t,1)[0];i.style=e},this.el=Object(r.b)("div","".concat(o.a,"-border-palette"));var a=He(Object(r.b)("tr","").children(Object(r.b)("td","".concat(o.a,"-border-palette-left")).child(He((e=Object(r.b)("tr","")).children.apply(e,Ie(["all","inside","horizontal","vertical","outside"].map(function(t){return Ve.call(i,t)}))),(n=Object(r.b)("tr","")).children.apply(n,Ie(["left","top","right","bottom","none"].map(function(t){return Ve.call(i,t)}))))),Object(r.b)("td","".concat(o.a,"-border-palette-right")).children(Object(r.b)("div","".concat(o.a,"-toolbar-btn")).child(this.ddColor.el),Object(r.b)("div","".concat(o.a,"-toolbar-btn")).child(this.ddType.el))));this.el.child(a)};function Ye(t){return(Ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Be(t,e){return!e||"object"!==Ye(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function qe(t){return(qe=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ue(t,e){return(Ue=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var $e=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=new P.a("border-all"),r=new We;return r.change=function(e){t.change(e),t.hide()},t=Be(this,qe(e).call(this,n,"auto",!1,"bottom-right","dd-border",r.el))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ue(t,e)}(e,Lt["a"]),e}();function Je(t){return(Je="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ge(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Xe(t,e){return!e||"object"!==Je(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ke(t){return(Ke=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Qe(t,e){return(Qe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var tn=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Xe(this,Ke(e).call(this,"border"))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Qe(t,e)}(e,wt),n=e,(r=[{key:"dropdown",value:function(){return new $e}}])&&Ge(n.prototype,r),i&&Ge(n,i),e}();function en(t){return(en="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function nn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function rn(t,e){return!e||"object"!==en(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function on(t,e,n){return(on="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=an(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function an(t){return(an=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ln(t,e){return(ln=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var sn=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),rn(this,an(e).apply(this,arguments))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ln(t,e)}(e,dt),n=e,(r=[{key:"element",value:function(){var t=this;return on(an(e.prototype),"element",this).call(this).child(new P.a(this.tag)).on("click",function(){return t.change(t.tag)})}},{key:"setState",value:function(t){this.el.disabled(t)}}])&&nn(n.prototype,r),i&&nn(n,i),e}();function cn(t){return(cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function un(t,e){return!e||"object"!==cn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function fn(t){return(fn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function hn(t,e){return(hn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var dn=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),un(this,fn(e).call(this,"clearformat"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&hn(t,e)}(e,sn),e}();function pn(t){return(pn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function yn(t,e){return!e||"object"!==pn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function bn(t){return(bn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function gn(t,e){return(gn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var mn=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),yn(this,bn(e).call(this,"paintformat"))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&gn(t,e)}(e,Ut),n=e,(r=[{key:"setState",value:function(){}}])&&vn(n.prototype,r),i&&vn(n,i),e}();function wn(t){return(wn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ln(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function On(t,e){return!e||"object"!==wn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function kn(t){return(kn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function jn(t,e){return(jn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var xn=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),On(this,kn(e).call(this,"color",void 0,t))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&jn(t,e)}(e,wt),n=e,(r=[{key:"dropdown",value:function(){var t=this.tag,e=this.value;return new Te(t,e)}}])&&Ln(n.prototype,r),i&&Ln(n,i),e}();function _n(t){return(_n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Sn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Cn(t,e){return!e||"object"!==_n(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function En(t){return(En=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Mn(t,e){return(Mn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Tn=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Cn(this,En(e).call(this,"bgcolor",void 0,t))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Mn(t,e)}(e,wt),n=e,(r=[{key:"dropdown",value:function(){var t=this.tag,e=this.value;return new Te(t,e)}}])&&Sn(n.prototype,r),i&&Sn(n,i),e}(),Pn=n(10);function An(t){return(An="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zn(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Dn(t,e){return!e||"object"!==An(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function zn(t){return(zn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Rn(t,e){return(Rn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Fn=function(t){function e(){var t,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=Pn.b.map(function(t){return Object(r.b)("div","".concat(o.a,"-item")).on("click",function(){n.setTitle("".concat(t.pt)),n.change(t)}).child("".concat(t.pt))});return n=Dn(this,(t=zn(e)).call.apply(t,[this,"10","60px",!0,"bottom-left","dd-fontsize"].concat(Zn(i))))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Rn(t,e)}(e,Lt["a"]),e}();function In(t){return(In="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Nn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Hn(t,e){return!e||"object"!==In(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Vn(t){return(Vn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Wn(t,e){return(Wn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Yn=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Hn(this,Vn(e).call(this,"font-size"))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Wn(t,e)}(e,wt),n=e,(r=[{key:"getValue",value:function(t){return t.pt}},{key:"dropdown",value:function(){return new Fn}}])&&Nn(n.prototype,r),i&&Nn(n,i),e}();function Bn(t){return(Bn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qn(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Un(t,e){return!e||"object"!==Bn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function $n(t){return($n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Jn(t,e){return(Jn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Gn=function(t){function e(){var t,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=Pn.a.map(function(t){return Object(r.b)("div","".concat(o.a,"-item")).on("click",function(){n.setTitle(t.title),n.change(t)}).child(t.title)});return n=Un(this,(t=$n(e)).call.apply(t,[this,Pn.a[0].title,"160px",!0,"bottom-left","dd-font"].concat(qn(i))))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Jn(t,e)}(e,Lt["a"]),e}();function Xn(t){return(Xn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Kn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Qn(t,e){return!e||"object"!==Xn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function tr(t){return(tr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function er(t,e){return(er=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var nr=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Qn(this,tr(e).call(this,"font-name"))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&er(t,e)}(e,wt),n=e,(r=[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new Gn}}])&&Kn(n.prototype,r),i&&Kn(n,i),e}(),rr=n(13);function ir(t){return(ir="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function or(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ar(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function lr(t,e){return!e||"object"!==ir(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function sr(t){return(sr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function cr(t,e){return(cr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ur=function(t){function e(){var t,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=rr.a.slice(0);return i.splice(2,0,{key:"divider"}),i.splice(8,0,{key:"divider"}),i=i.map(function(t){var e=Object(r.b)("div","".concat(o.a,"-item"));return"divider"===t.key?e.addClass("divider"):(e.child(t.title()).on("click",function(){n.setTitle(t.numfmt),n.change(t)}),t.label&&e.child(Object(r.b)("div","label").html(t.label))),e}),n=lr(this,(t=sr(e)).call.apply(t,[this,"General","220px",!0,"bottom-left","dd-format"].concat(or(i))))}var n,i,a;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&cr(t,e)}(e,Lt["a"]),n=e,(i=[{key:"setTitle",value:function(t){for(var e=0;e<rr.a.length;e+=1)rr.a[e].numfmt===t&&this.title.html(rr.a[e].title());this.hide()}}])&&ar(n.prototype,i),a&&ar(n,a),e}();function fr(t){return(fr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function dr(t,e){return!e||"object"!==fr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function pr(t){return(pr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function vr(t,e){return(vr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var yr=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),dr(this,pr(e).call(this,"format"))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vr(t,e)}(e,wt),n=e,(r=[{key:"getValue",value:function(t){return t.numfmt}},{key:"dropdown",value:function(){return new ur}}])&&hr(n.prototype,r),i&&hr(n,i),e}(),br=n(14);function gr(t){return(gr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function mr(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function wr(t,e){return!e||"object"!==gr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Lr(t){return(Lr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Or(t,e){return(Or=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var kr=function(t){function e(){var t,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=br.a.map(function(t){return Object(r.b)("div","".concat(o.a,"-item")).on("click",function(){n.hide(),n.change(t)}).child(t.key)});return n=wr(this,(t=Lr(e)).call.apply(t,[this,new P.a("formula"),"180px",!0,"bottom-right","dd-formula"].concat(mr(i))))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Or(t,e)}(e,Lt["a"]),e}();function jr(t){return(jr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _r(t,e){return!e||"object"!==jr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Sr(t){return(Sr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Cr(t,e){return(Cr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Er=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),_r(this,Sr(e).call(this,"formula"))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Cr(t,e)}(e,wt),n=e,(r=[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new kr}}])&&xr(n.prototype,r),i&&xr(n,i),e}();function Mr(t){return(Mr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Tr(t,e){return!e||"object"!==Mr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Pr(t){return(Pr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ar(t,e){return(Ar=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Zr=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Tr(this,Pr(e).call(this,"freeze"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ar(t,e)}(e,Ut),e}();function Dr(t){return(Dr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function zr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Rr(t,e){return!e||"object"!==Dr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Fr(t){return(Fr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ir(t,e){return(Ir=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Nr=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Rr(this,Fr(e).call(this,"merge"))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ir(t,e)}(e,Ut),n=e,(r=[{key:"setState",value:function(t,e){this.el.active(t).disabled(e)}}])&&zr(n.prototype,r),i&&zr(n,i),e}();function Hr(t){return(Hr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vr(t,e){return!e||"object"!==Hr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Wr(t){return(Wr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Yr(t,e){return(Yr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Br=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Vr(this,Wr(e).call(this,"redo","Ctrl+Y"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Yr(t,e)}(e,sn),e}();function qr(t){return(qr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ur(t,e){return!e||"object"!==qr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function $r(t){return($r=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Jr(t,e){return(Jr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Gr=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Ur(this,$r(e).call(this,"undo","Ctrl+Z"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Jr(t,e)}(e,sn),e}();function Xr(t){return(Xr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Kr(t,e){return!e||"object"!==Xr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Qr(t){return(Qr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ti(t,e){return(ti=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ei=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Kr(this,Qr(e).call(this,"print","Ctrl+P"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ti(t,e)}(e,sn),e}();function ni(t){return(ni="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ri(t,e){return!e||"object"!==ni(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ii(t){return(ii=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function oi(t,e){return(oi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ai=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),ri(this,ii(e).call(this,"textwrap"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&oi(t,e)}(e,Ut),e}();function li(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function si(t){return(si="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ci(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ui(t,e){return!e||"object"!==si(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function fi(t){return(fi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function hi(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&di(t,e)}function di(t,e){return(di=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var pi=function(t){function e(){var t;ci(this,e);var n=new P.a("ellipsis"),i=Object(r.b)("div","".concat(o.a,"-toolbar-more"));return(t=ui(this,fi(e).call(this,n,"auto",!1,"bottom-right","dd-more",i))).moreBtns=i,t.contentEl.css("max-width","420px"),t}return hi(e,Lt["a"]),e}(),vi=function(t){function e(){var t;return ci(this,e),(t=ui(this,fi(e).call(this,"more"))).el.hide(),t}var n,r,i;return hi(e,wt),n=e,(r=[{key:"dropdown",value:function(){return new pi}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide()}}])&&li(n.prototype,r),i&&li(n,i),e}();function yi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function bi(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function gi(){return Object(r.b)("div","".concat(o.a,"-toolbar-divider"))}function mi(){var t,e,n=this.el,r=this.btns,i=this.moreEl,o=this.btns2,a=i.dd,l=a.moreBtns,s=a.contentEl;n.css("width","".concat(this.widthFn(),"px"));var c=n.box(),u=160,f=12,h=[],d=[];o.forEach(function(t,e){var n=bi(t,2),r=n[0],i=n[1];u+=i,e===o.length-1||u<c.width?h.push(r):(f+=i,d.push(r))}),(t=r.html("")).children.apply(t,h),(e=l.html("")).children.apply(e,d),s.css("width","".concat(f,"px")),d.length>0?i.show():i.hide()}function wi(t){var e=this,n=new dt;n.el.on("click",function(){t.onClick&&t.onClick(e.data.getData(),e.data)}),n.tip=t.tip||"";var i=t.el;if(t.icon&&(i=Object(r.b)("img").attr("src",t.icon)),i){var a=Object(r.b)("div","".concat(o.a,"-icon"));a.child(i),n.el.child(a)}return n}var Li=function(){function t(e,n){var a=this,l=arguments.length>2&&void 0!==arguments[2]&&arguments[2];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.data=e,this.change=function(){},this.widthFn=n,this.isHide=l;var s=e.defaultStyle();this.items=[[this.undoEl=new Gr,this.redoEl=new Br,this.data.settings.showPrint&&new ei,this.paintformatEl=new mn,this.clearformatEl=new dn].filter(function(t){return!!t}),gi(),[this.formatEl=new yr],gi(),[this.fontEl=new nr,this.fontSizeEl=new Yn],gi(),[this.boldEl=new ie,this.italicEl=new ce,this.underlineEl=new me,this.strikeEl=new pe,this.textColorEl=new xn(s.color)],gi(),[this.fillColorEl=new Tn(s.bgcolor),this.borderEl=new tn,this.mergeEl=new Nr],gi(),[this.alignEl=new Zt(s.align),this.valignEl=new Nt(s.valign),this.textwrapEl=new ai],gi(),[this.freezeEl=new Zr,this.autofilterEl=new Qt,this.formulaEl=new Er]];var c=e.settings.extendToolbar,u=void 0===c?{}:c;if(u.left&&u.left.length>0){this.items.unshift(gi());var f=u.left.map(wi.bind(this));this.items.unshift(f)}if(u.right&&u.right.length>0){this.items.push(gi());var h=u.right.map(wi.bind(this));this.items.push(h)}this.items.push([this.moreEl=new vi]),this.el=Object(r.b)("div","".concat(o.a,"-toolbar")),this.btns=Object(r.b)("div","".concat(o.a,"-toolbar-btns")),this.items.forEach(function(t){Array.isArray(t)?t.forEach(function(t){a.btns.child(t.el),t.change=function(){a.change.apply(a,arguments)}}):a.btns.child(t.el)}),this.el.child(this.btns),l?this.el.hide():(this.reset(),setTimeout(function(){(function(){var t=this;this.btns2=[],this.items.forEach(function(e){if(Array.isArray(e))e.forEach(function(e){var n=e.el,r=n.box(),i=n.computedStyle(),o=i.marginLeft,a=i.marginRight;t.btns2.push([n,r.width+parseInt(o,10)+parseInt(a,10)])});else{var n=e.box(),r=e.computedStyle(),i=r.marginLeft,o=r.marginRight;t.btns2.push([e,n.width+parseInt(i,10)+parseInt(o,10)])}})}).call(a),mi.call(a)},0),Object(i.a)(window,"resize",function(){mi.call(a)}))}var e,n,a;return e=t,(n=[{key:"paintformatActive",value:function(){return this.paintformatEl.active()}},{key:"paintformatToggle",value:function(){this.paintformatEl.toggle()}},{key:"trigger",value:function(t){this["".concat(t,"El")].click()}},{key:"resetData",value:function(t){this.data=t,this.reset()}},{key:"reset",value:function(){if(!this.isHide){var t=this.data,e=t.getSelectedCellStyle();this.undoEl.setState(!t.canUndo()),this.redoEl.setState(!t.canRedo()),this.mergeEl.setState(t.canUnmerge(),!t.selector.multiple()),this.autofilterEl.setState(!t.canAutofilter());var n=e.font,r=e.format;this.formatEl.setState(r),this.fontEl.setState(n.name),this.fontSizeEl.setState(n.size),this.boldEl.setState(n.bold),this.italicEl.setState(n.italic),this.underlineEl.setState(e.underline),this.strikeEl.setState(e.strike),this.textColorEl.setState(e.color),this.fillColorEl.setState(e.bgcolor),this.alignEl.setState(e.align),this.valignEl.setState(e.valign),this.textwrapEl.setState(e.textwrap),this.freezeEl.setState(t.freezeIsActive())}}}])&&yi(e.prototype,n),a&&yi(e,a),t}();function Oi(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ki(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ji=function(){function t(e,n){var i,a=this,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"600px";!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.title=e,this.el=Object(r.b)("div","".concat(o.a,"-modal")).css("width",l).children(Object(r.b)("div","".concat(o.a,"-modal-header")).children(new P.a("close").on("click.stop",function(){return a.hide()}),this.title),(i=Object(r.b)("div","".concat(o.a,"-modal-content"))).children.apply(i,Oi(n))).hide()}var e,n,a;return e=t,(n=[{key:"show",value:function(){var t=this;this.dimmer=Object(r.b)("div","".concat(o.a,"-dimmer active")),document.body.appendChild(this.dimmer.el);var e=this.el.show().box(),n=e.width,a=e.height,l=document.documentElement,s=l.clientHeight,c=l.clientWidth;this.el.offset({left:(c-n)/2,top:(s-a)/3}),window.xkeydownEsc=function(e){27===e.keyCode&&t.hide()},Object(i.a)(window,"keydown",window.xkeydownEsc)}},{key:"hide",value:function(){this.el.hide(),document.body.removeChild(this.dimmer.el),Object(i.f)(window,"keydown",window.xkeydownEsc),delete window.xkeydownEsc}}])&&ki(e.prototype,n),a&&ki(e,a),t}(),xi=n(12);function _i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Si=function(){function t(e,n,i){var a=this,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(t){return t},s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.key=e,this.getTitle=l,this.vchange=function(){},this.el=Object(r.b)("div","".concat(o.a,"-form-select")),this.suggest=new T(n.map(function(t){return{key:t,title:a.getTitle(t)}}),function(t){a.itemClick(t.key),s(t.key),a.vchange(t.key)},i,this.el),this.el.children(this.itemEl=Object(r.b)("div","input-text").html(this.getTitle(e)),this.suggest.el).on("click",function(){return a.show()})}var e,n,i;return e=t,(n=[{key:"show",value:function(){this.suggest.search("")}},{key:"itemClick",value:function(t){this.key=t,this.itemEl.html(this.getTitle(t))}},{key:"val",value:function(t){return void 0!==t?(this.key=t,this.itemEl.html(this.getTitle(t)),this):this.key}}])&&_i(e.prototype,n),i&&_i(e,i),t}();function Ci(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ei={number:/(^\d+$)|(^\d+(\.\d{0,4})?$)/,date:/^\d{4}-\d{1,2}-\d{1,2}$/},Mi=function(){function t(e,n,i,a){var l=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.label="",this.rule=n,i&&(this.label=Object(r.b)("label","label").css("width","".concat(a,"px")).html(i)),this.tip=Object(r.b)("div","tip").child("tip").hide(),this.input=e,this.input.vchange=function(){return l.validate()},this.el=Object(r.b)("div","".concat(o.a,"-form-field")).children(this.label,e.el,this.tip)}var e,n,i;return e=t,(n=[{key:"isShow",value:function(){return"none"!==this.el.css("display")}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){return this.el.hide(),this}},{key:"val",value:function(t){return this.input.val(t)}},{key:"hint",value:function(t){this.input.hint(t)}},{key:"validate",value:function(){var t=this.input,e=this.rule,n=this.tip,r=this.el,i=t.val();if(e.required&&/^\s*$/.test(i))return n.html(Object(A.b)("validation.required")),r.addClass("error"),!1;if((e.type||e.pattern)&&!(e.pattern||Ei[e.type]).test(i))return n.html(Object(A.b)("validation.notMatch")),r.addClass("error"),!1;return r.removeClass("error"),!0}}])&&Ci(e.prototype,n),i&&Ci(e,i),t}();function Ti(t){return(Ti="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ai(t,e){return!e||"object"!==Ti(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Zi(t){return(Zi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Di(t,e){return(Di=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var zi=100,Ri=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=new Mi(new Si("cell",["cell"],"100%",function(t){return Object(A.b)("dataValidation.modeType.".concat(t))}),{required:!0},"".concat(Object(A.b)("dataValidation.range"),":"),zi),i=new Mi(new xi.a("120px","E3 or E3:F12"),{required:!0,pattern:/^([A-Z]{1,2}[1-9]\d*)(:[A-Z]{1,2}[1-9]\d*)?$/}),a=new Mi(new Si("list",["list","number","date","phone","email"],"100%",function(t){return Object(A.b)("dataValidation.type.".concat(t))},function(e){return t.criteriaSelected(e)}),{required:!0},"".concat(Object(A.b)("dataValidation.criteria"),":"),zi),l=new Mi(new Si("be",["be","nbe","eq","neq","lt","lte","gt","gte"],"160px",function(t){return Object(A.b)("dataValidation.operator.".concat(t))},function(e){return t.criteriaOperatorSelected(e)}),{required:!0}).hide(),s=new Mi(new xi.a("70px","10"),{required:!0}).hide(),c=new Mi(new xi.a("70px","100"),{required:!0,type:"number"}).hide(),u=new Mi(new xi.a("120px","a,b,c"),{required:!0}),f=new Mi(new xi.a("70px","10"),{required:!0,type:"number"}).hide();return(t=Ai(this,Zi(e).call(this,Object(A.b)("contextmenu.validation"),[Object(r.b)("div","".concat(o.a,"-form-fields")).children(n.el,i.el),Object(r.b)("div","".concat(o.a,"-form-fields")).children(a.el,l.el,s.el,c.el,f.el,u.el),Object(r.b)("div","".concat(o.a,"-buttons")).children(new X("cancel").on("click",function(){return t.btnClick("cancel")}),new X("remove").on("click",function(){return t.btnClick("remove")}),new X("save","primary").on("click",function(){return t.btnClick("save")}))]))).mf=n,t.rf=i,t.cf=a,t.of=l,t.minvf=s,t.maxvf=c,t.vf=f,t.svf=u,t.change=function(){},t}var n,i,a;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Di(t,e)}(e,ji),n=e,(i=[{key:"showVf",value:function(t){var e="date"===t?"2018-11-12":"10",n=this.vf;n.input.hint(e),n.show()}},{key:"criteriaSelected",value:function(t){var e=this.of,n=this.minvf,r=this.maxvf,i=this.vf,o=this.svf;"date"===t||"number"===t?(e.show(),n.rule.type=t,r.rule.type=t,"date"===t?(n.hint("2018-11-12"),r.hint("2019-11-12")):(n.hint("10"),r.hint("100")),n.show(),r.show(),i.hide(),o.hide()):("list"===t?o.show():o.hide(),i.hide(),e.hide(),n.hide(),r.hide())}},{key:"criteriaOperatorSelected",value:function(t){if(t){var e=this.minvf,n=this.maxvf,r=this.vf;if("be"===t||"nbe"===t)e.show(),n.show(),r.hide();else{var i=this.cf.val();r.rule.type=i,"date"===i?r.hint("2018-11-12"):r.hint("10"),r.show(),e.hide(),n.hide()}}}},{key:"btnClick",value:function(t){if("cancel"===t)this.hide();else if("remove"===t)this.change("remove"),this.hide();else if("save"===t){for(var e=["mf","rf","cf","of","svf","vf","minvf","maxvf"],n=0;n<e.length;n+=1){var r=this[e[n]];if(r.isShow()&&!r.validate())return}var i=this.mf.val(),o=this.rf.val(),a=this.cf.val(),l=this.of.val(),s=this.svf.val();"number"!==a&&"date"!==a||(s="be"===l||"nbe"===l?[this.minvf.val(),this.maxvf.val()]:this.vf.val()),this.change("save",i,o,{type:a,operator:l,required:!1,value:s}),this.hide()}}},{key:"setValue",value:function(t){if(t){var e=this.mf,n=this.rf,r=this.cf,i=this.of,o=this.svf,a=this.vf,l=this.minvf,s=this.maxvf,c=t.mode,u=t.ref,f=t.validator||{type:"list"},h=f.type,d=f.operator,p=f.value;e.val(c||"cell"),n.val(u),r.val(h),i.val(d),Array.isArray(p)?(l.val(p[0]),s.val(p[1])):(o.val(p||""),a.val(p||"")),this.criteriaSelected(h),this.criteriaOperatorSelected(d)}this.show()}}])&&Pi(n.prototype,i),a&&Pi(n,a),e}();function Fi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ii(t){return Object(r.b)("div","".concat(o.a,"-item ").concat(t))}function Ni(t){var e=this;return Ii("state").child(Object(A.b)("sort.".concat(t))).on("click.stop",function(){return e.itemClick(t)})}function Hi(){var t=this.filterhEl,e=this.filterValues,n=this.values;t.html("".concat(e.length," / ").concat(n.length)),t.checked(e.length===n.length)}var Vi=function(){function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.filterbEl=Object(r.b)("div","".concat(o.a,"-body")),this.filterhEl=Object(r.b)("div","".concat(o.a,"-header state")).on("click.stop",function(){return e.filterClick(0,"all")}),this.el=Object(r.b)("div","".concat(o.a,"-sort-filter")).children(this.sortAscEl=Ni.call(this,"asc"),this.sortDescEl=Ni.call(this,"desc"),Ii("divider"),Object(r.b)("div","".concat(o.a,"-filter")).children(this.filterhEl,this.filterbEl),Object(r.b)("div","".concat(o.a,"-buttons")).children(new X("cancel").on("click",function(){return e.btnClick("cancel")}),new X("ok","primary").on("click",function(){return e.btnClick("ok")}))).hide(),this.ci=null,this.sortDesc=null,this.values=null,this.filterValues=[]}var e,n,a;return e=t,(n=[{key:"btnClick",value:function(t){if("ok"===t){var e=this.ci,n=this.sort,r=this.filterValues;this.ok&&this.ok(e,n,"in",r)}this.hide()}},{key:"itemClick",value:function(t){this.sort=t;var e=this.sortAscEl,n=this.sortDescEl;e.checked("asc"===t),n.checked("desc"===t)}},{key:"filterClick",value:function(t,e){var n=this.filterbEl,i=this.filterValues,o=this.values,a=n.children();"all"===e?a.length===i.length?(this.filterValues=[],a.forEach(function(t){return Object(r.b)(t).checked(!1)})):(this.filterValues=Array.from(o),a.forEach(function(t){return Object(r.b)(t).checked(!0)})):Object(r.b)(a[t]).toggle("checked")?i.push(e):i.splice(i.findIndex(function(t){return t===e}),1);Hi.call(this)}},{key:"set",value:function(t,e,n,i){this.ci=t;var a=this.sortAscEl,l=this.sortDescEl;null!==i?(this.sort=i.order,a.checked(i.asc()),l.checked(i.desc())):(this.sortDesc=null,a.checked(!1),l.checked(!1)),this.values=Object.keys(e),this.filterValues=n?Array.from(n.value):Object.keys(e),function(t){var e=this,n=this.filterbEl,i=this.filterValues;n.html(""),Object.keys(t).forEach(function(a,l){var s=t[a],c=i.includes(a)?"checked":"";n.child(Object(r.b)("div","".concat(o.a,"-item state ").concat(c)).on("click.stop",function(){return e.filterClick(l,a)}).children(""===a?Object(A.b)("filter.empty"):a,Object(r.b)("div","label").html("(".concat(s,")"))))})}.call(this,e,n),Hi.call(this)}},{key:"setOffset",value:function(t){var e=this;this.el.offset(t).show();var n=1;Object(i.b)(this.el,function(){n<=0&&e.hide(),n-=1})}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide(),Object(i.g)(this.el)}}])&&Fi(e.prototype,n),a&&Fi(e,a),t}();function Wi(t,e){var n=Object(r.b)("div","".concat(o.a,"-toast")),i=Object(r.b)("div","".concat(o.a,"-dimmer active"));n.children(Object(r.b)("div","".concat(o.a,"-toast-header")).children(new P.a("close").on("click.stop",function(){return document.body.removeChild(n.el),void document.body.removeChild(i.el)}),t),Object(r.b)("div","".concat(o.a,"-toast-content")).html(e)),document.body.appendChild(n.el),document.body.appendChild(i.el);var a=n.box(),l=a.width,s=a.height,c=document.documentElement,u=c.clientHeight,f=c.clientWidth;n.offset({left:(f-l)/2,top:(u-s)/3})}function Yi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Bi(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function qi(t,e){var n,r=this;return function(){for(var i=r,o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];var s=a;n||(n=setTimeout(function(){n=null,t.apply(i,s)},e))}}function Ui(t,e,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(-1!==e||-1!==n){var o=this.table,a=this.selector,l=this.toolbar,s=this.data,c=this.contextMenu,u=s.getCell(e,n);t?(a.setEnd(e,n,i),this.trigger("cells-selected",u,a.range)):(a.set(e,n,r),this.trigger("cell-selected",u,e,n)),c.setMode(-1===e||-1===n?"row-col":"range"),l.reset(),o.render()}}function $i(t,e){var n=this.selector,r=this.data,i=r.rows,o=r.cols,a=Bi(n.indexes,2),l=a[0],s=a[1],c=n.range,u=c.eri,f=c.eci;if(t){var h=Bi(n.moveIndexes,2);l=h[0],s=h[1]}"left"===e?s>0&&(s-=1):"right"===e?(f!==s&&(s=f),s<o.len-1&&(s+=1)):"up"===e?l>0&&(l-=1):"down"===e?(u!==l&&(l=u),l<i.len-1&&(l+=1)):"row-first"===e?s=0:"row-last"===e?s=o.len-1:"col-first"===e?l=0:"col-last"===e&&(l=i.len-1),t&&(n.moveIndexes=[l,s]),Ui.call(this,t,l,s),function(){var t=this.data,e=this.verticalScrollbar,n=this.horizontalScrollbar,r=t.getSelectedRect(),i=r.l,o=r.t,a=r.left,l=r.top,s=r.width,c=r.height,u=this.getTableOffset();if(Math.abs(a)+s>u.width)n.move({left:i+s-u.width});else{var f=t.freezeTotalWidth();a<f&&n.move({left:i-1-f})}if(Math.abs(l)+c>u.height)e.move({top:o+c-u.height-1});else{var h=t.freezeTotalHeight();l<h&&e.move({top:o-1-h})}}.call(this)}function Ji(){var t=this.data,e=this.verticalScrollbar,n=this.getTableOffset().height,r=t.exceptRowTotalHeight(0,-1);e.set(n,t.rows.totalHeight()-r)}function Gi(){var t=this.data,e=this.horizontalScrollbar,n=this.getTableOffset().width;t&&e.set(n,t.cols.totalWidth())}function Xi(){var t=this.tableEl,e=this.overlayerEl,n=this.overlayerCEl,r=this.table,i=this.toolbar,o=this.selector,a=this.el,l=this.getTableOffset(),s=this.getRect();t.attr(s),e.offset(s),n.offset(l),a.css("width","".concat(s.width,"px")),Ji.call(this),Gi.call(this),function(){var t=this.selector,e=this.data,n=this.editor,r=Bi(e.freeze,2),i=r[0],o=r[1];if(i>0||o>0){var a=e.freezeTotalWidth(),l=e.freezeTotalHeight();n.setFreezeLengths(a,l)}t.resetAreaOffset()}.call(this),r.render(),i.reset(),o.reset()}function Ki(){var t=this.data,e=this.selector;t.clearClipboard(),e.hideClipboard()}function Qi(t){var e=this.data,n=this.selector;"read"!==e.settings.mode&&(e.copy(),e.copyToSystemClipboard(t),n.showClipboard())}function to(){var t=this.data,e=this.selector;"read"!==t.settings.mode&&(t.cut(),e.showClipboard())}function eo(t,e){var n=this,r=this.data;if("read"!==r.settings.mode)if(r.clipboard.isClear()){r.pasteFromSystemClipboard(function(){return Xi.call(n)},function(t){n.trigger("pasted-clipboard",t)})}else if(r.paste(t,function(t){return Wi("Tip",t)}))Xi.call(this);else if(e){var i=e.clipboardData.getData("text/plain");this.data.pasteFromText(i),Xi.call(this)}}function no(t,e){this.data.unhideRowsOrCols(t,e),Xi.call(this)}function ro(t){var e=this,n=this.selector,r=this.data,a=this.table,l=this.sortFilter,s=t.offsetX,c=t.offsetY,u=t.target.className==="".concat(o.a,"-selector-corner"),f=r.getCellRectByXY(s,c),h=f.left,d=f.top,p=f.width,v=f.height,y=f.ri,b=f.ci,g=r.autoFilter;if(g.includes(y,b)&&h+p-20<s&&d+v-20<c){var m=g.items(b,function(t,e){return r.rows.getCell(t,e)});return l.hide(),l.set(b,m,g.getFilter(b),g.getSort(b)),void l.setOffset({left:h,top:d+v+2})}t.shiftKey||(u?n.showAutofill(y,b):Ui.call(this,!1,y,b),Object(i.e)(window,function(t){var i=r.getCellRectByXY(t.offsetX,t.offsetY);y=i.ri,b=i.ci,u?n.showAutofill(y,b):1!==t.buttons||t.shiftKey||Ui.call(e,!0,y,b,!0,!0)},function(){u&&n.arange&&"read"!==r.settings.mode&&r.autofill(n.arange,"all",function(t){return Wi("Tip",t)})&&a.render(),n.hideAutofill(),function(){var t=this.toolbar;t.paintformatActive()&&(eo.call(this,"format"),Ki.call(this),t.paintformatToggle())}.call(e)})),u||1!==t.buttons||t.shiftKey&&Ui.call(this,!0,y,b)}function io(){var t=this.editor,e=this.data.getSelectedRect(),n=this.getTableOffset(),r="top";e.top>n.height/2&&(r="bottom"),t.setOffset(e,r)}function oo(){var t=this.editor,e=this.data;"read"!==e.settings.mode&&(io.call(this),t.setCell(e.getSelectedCell(),e.getSelectedValidator()),Ki.call(this))}function ao(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"finished",n=this.data,r=this.table;if("read"!==n.settings.mode){n.setSelectedCellText(t,e);var i=n.selector,o=i.ri,a=i.ci;"finished"===e?r.render():this.trigger("cell-edited",t,o,a)}}function lo(t){var e=this.data;"read"!==e.settings.mode&&("insert-row"===t?e.insert("row"):"delete-row"===t?e.delete("row"):"insert-column"===t?e.insert("column"):"delete-column"===t?e.delete("column"):"delete-cell"===t?e.deleteCell():"delete-cell-format"===t?e.deleteCell("format"):"delete-cell-text"===t?e.deleteCell("text"):"cell-printable"===t?e.setSelectedCellAttr("printable",!0):"cell-non-printable"===t?e.setSelectedCellAttr("printable",!1):"cell-editable"===t?e.setSelectedCellAttr("editable",!0):"cell-non-editable"===t&&e.setSelectedCellAttr("editable",!1),Ki.call(this),Xi.call(this))}function so(t,e){var n=this.data;if("undo"===t)this.undo();else if("redo"===t)this.redo();else if("print"===t)this.print.preview();else if("paintformat"===t)!0===e?Qi.call(this):Ki.call(this);else if("clearformat"===t)lo.call(this,"delete-cell-format");else if("link"===t);else if("chart"===t);else if("autofilter"===t)(function(){this.data.autofilter(),Xi.call(this)}).call(this);else if("freeze"===t)if(e){var r=n.selector,i=r.ri,o=r.ci;this.freeze(i,o)}else this.freeze(0,0);else n.setSelectedCellAttr(t,e),"formula"!==t||n.selector.multiple()||oo.call(this),Xi.call(this)}function co(){var t=this,e=this.selector,n=this.overlayerEl,r=this.rowResizer,a=this.colResizer,l=this.verticalScrollbar,s=this.horizontalScrollbar,c=this.editor,u=this.contextMenu,f=this.toolbar,h=this.modalValidation,d=this.sortFilter;n.on("mousemove",function(e){(function(t){if(0===t.buttons&&t.target.className!=="".concat(o.a,"-resizer-hover")){var e=t.offsetX,n=t.offsetY,r=this.rowResizer,i=this.colResizer,a=this.tableEl,l=this.data,s=l.rows,c=l.cols;if(e>c.indexWidth&&n>s.height)return r.hide(),void i.hide();var u=a.box(),f=l.getCellRectByXY(t.offsetX,t.offsetY);f.ri>=0&&-1===f.ci?(f.width=c.indexWidth,r.show(f,{width:u.width}),s.isHide(f.ri-1)?r.showUnhide(f.ri):r.hideUnhide()):r.hide(),-1===f.ri&&f.ci>=0?(f.height=s.height,i.show(f,{height:u.height}),c.isHide(f.ci-1)?i.showUnhide(f.ci):i.hideUnhide()):i.hide()}}).call(t,e)}).on("mousedown",function(e){c.clear(),u.hide(),2===e.buttons?(t.data.xyInSelectedRect(e.offsetX,e.offsetY)?u.setPosition(e.offsetX,e.offsetY):(ro.call(t,e),u.setPosition(e.offsetX,e.offsetY)),e.stopPropagation()):2===e.detail?oo.call(t):ro.call(t,e)}).on("mousewheel.stop",function(e){(function(t){var e=this.verticalScrollbar,n=this.horizontalScrollbar,r=this.data,i=e.scroll().top,o=n.scroll().left,a=r.rows,l=r.cols,s=t.deltaY,c=t.deltaX,u=function(t,e){var n=t,r=0;do{r=e(n),n+=1}while(r<=0);return r},f=function(t){if(t>0){var n=r.scroll.ri+1;if(n<a.len){var o=u(n,function(t){return a.getHeight(t)});e.move({top:i+o-1})}}else{var l=r.scroll.ri-1;if(l>=0){var s=u(l,function(t){return a.getHeight(t)});e.move({top:0===l?0:i-s})}}},h=Math.abs(s),d=Math.abs(c),p=Math.max(h,d);/Firefox/i.test(window.navigator.userAgent)&&qi(f(t.detail),50),p===d&&qi(function(t){if(t>0){var e=r.scroll.ci+1;if(e<l.len){var i=u(e,function(t){return l.getWidth(t)});n.move({left:o+i-1})}}else{var a=r.scroll.ci-1;if(a>=0){var s=u(a,function(t){return l.getWidth(t)});n.move({left:0===a?0:o-s})}}}(c),50),p===h&&qi(f(s),50)}).call(t,e)}).on("mouseout",function(t){var e=t.offsetX;t.offsetY<=0&&a.hide(),e<=0&&r.hide()}),e.inputChange=function(e){ao.call(t,e,"input"),oo.call(t)},Object(i.c)(n.el,{move:function(e,n){(function(t,e){var n=this.verticalScrollbar,r=this.horizontalScrollbar,i=n.scroll().top,o=r.scroll().left;"left"===t||"right"===t?r.move({left:o-e}):"up"!==t&&"down"!==t||n.move({top:i-e})}).call(t,e,n)}}),f.change=function(e,n){return so.call(t,e,n)},d.ok=function(e,n,r,i){return function(t,e,n,r){this.data.setAutoFilter(t,e,n,r),Xi.call(this)}.call(t,e,n,r,i)},r.finishedFn=function(e,n){(function(t,e){var n=t.ri,r=this.table,i=this.selector,o=this.data,a=i.range,l=a.sri,s=a.eri;if(n>=l&&n<=s)for(var c=l;c<=s;c+=1)o.rows.setHeight(c,e);else o.rows.setHeight(n,e);r.render(),i.resetAreaOffset(),Ji.call(this),io.call(this)}).call(t,e,n)},a.finishedFn=function(e,n){(function(t,e){var n=t.ci,r=this.table,i=this.selector,o=this.data,a=i.range,l=a.sci,s=a.eci;if(n>=l&&n<=s)for(var c=l;c<=s;c+=1)o.cols.setWidth(c,e);else o.cols.setWidth(n,e);r.render(),i.resetAreaOffset(),Gi.call(this),io.call(this)}).call(t,e,n)},r.unhideFn=function(e){no.call(t,"row",e)},a.unhideFn=function(e){no.call(t,"col",e)},l.moveFn=function(e,n){(function(t){var e=this,n=this.data,r=this.table,i=this.selector;n.scrolly(t,function(){i.resetBRLAreaOffset(),io.call(e),r.render()})}).call(t,e,n)},s.moveFn=function(e,n){(function(t){var e=this,n=this.data,r=this.table,i=this.selector;n.scrollx(t,function(){i.resetBRTAreaOffset(),io.call(e),r.render()})}).call(t,e,n)},c.change=function(e,n){ao.call(t,n,e)},h.change=function(e){if("save"===e){for(var n,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];(n=t.data).addValidation.apply(n,i)}else t.data.removeValidation()},u.itemClick=function(e){"validation"===e?h.setValue(t.data.getSelectedValidation()):"copy"===e?Qi.call(t):"cut"===e?to.call(t):"paste"===e?eo.call(t,"all"):"paste-value"===e?eo.call(t,"text"):"paste-format"===e?eo.call(t,"format"):"hide"===e?function(){this.data.hideRowsOrCols(),Xi.call(this)}.call(t):lo.call(t,e)},Object(i.a)(window,"resize",function(){t.reload()}),Object(i.a)(window,"click",function(e){t.focusing=n.contains(e.target)}),Object(i.a)(window,"paste",function(e){t.focusing&&(eo.call(t,"all",e),e.preventDefault())}),Object(i.a)(window,"copy",function(e){t.focusing&&(Qi.call(t,e),e.preventDefault())}),Object(i.a)(window,"keydown",function(e){if(t.focusing){var n=e.keyCode||e.which,r=e.key,i=e.ctrlKey,o=e.shiftKey,a=e.metaKey;if(i||a)switch(n){case 90:t.undo(),e.preventDefault();break;case 89:t.redo(),e.preventDefault();break;case 67:break;case 88:to.call(t),e.preventDefault();break;case 85:f.trigger("underline"),e.preventDefault();break;case 86:break;case 37:$i.call(t,o,"row-first"),e.preventDefault();break;case 38:$i.call(t,o,"col-first"),e.preventDefault();break;case 39:$i.call(t,o,"row-last"),e.preventDefault();break;case 40:$i.call(t,o,"col-last"),e.preventDefault();break;case 32:Ui.call(t,!1,-1,t.data.selector.ci,!1),e.preventDefault();break;case 66:f.trigger("bold");break;case 73:f.trigger("italic")}else{switch(n){case 32:o&&Ui.call(t,!1,t.data.selector.ri,-1,!1);break;case 27:u.hide(),Ki.call(t);break;case 37:$i.call(t,o,"left"),e.preventDefault();break;case 38:$i.call(t,o,"up"),e.preventDefault();break;case 39:$i.call(t,o,"right"),e.preventDefault();break;case 40:$i.call(t,o,"down"),e.preventDefault();break;case 9:c.clear(),$i.call(t,!1,o?"left":"right"),e.preventDefault();break;case 13:c.clear(),$i.call(t,!1,o?"up":"down"),e.preventDefault();break;case 8:lo.call(t,"delete-cell-text"),e.preventDefault()}"Delete"===r?(lo.call(t,"delete-cell-text"),e.preventDefault()):n>=65&&n<=90||n>=48&&n<=57||n>=96&&n<=105||"="===e.key?(ao.call(t,e.key,"input"),oo.call(t)):113===n&&oo.call(t)}}})}n.d(e,"a",function(){return uo});var uo=function(){function t(e,n){var a=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.eventMap=Object(i.d)();var s=n.settings,u=s.view,f=s.showToolbar,h=s.showContextmenu;this.el=Object(r.b)("div","".concat(o.a,"-sheet")),this.toolbar=new Li(n,u.width,!f),this.print=new at(n),e.children(this.toolbar.el,this.el,this.print.el),this.data=n,this.tableEl=Object(r.b)("canvas","".concat(o.a,"-table")),this.rowResizer=new l(!1,n.rows.height),this.colResizer=new l(!0,n.cols.minWidth),this.verticalScrollbar=new c(!0),this.horizontalScrollbar=new c(!1),this.editor=new q(br.c,function(){return a.getTableOffset()},n.rows.height),this.modalValidation=new Ri,this.contextMenu=new ft(function(){return a.getRect()},!h,this.data.settings),this.selector=new S(n),this.overlayerCEl=Object(r.b)("div","".concat(o.a,"-overlayer-content")).children(this.editor.el,this.selector.el),this.overlayerEl=Object(r.b)("div","".concat(o.a,"-overlayer")).child(this.overlayerCEl),this.sortFilter=new Vi,this.el.children(this.tableEl,this.overlayerEl.el,this.rowResizer.el,this.colResizer.el,this.verticalScrollbar.el,this.horizontalScrollbar.el,this.contextMenu.el,this.modalValidation.el,this.sortFilter.el),this.table=new Q.a(this.tableEl.el,n),co.call(this),Xi.call(this),Ui.call(this,!1,0,0)}var e,n,a;return e=t,(n=[{key:"on",value:function(t,e){return this.eventMap.on(t,e),this}},{key:"trigger",value:function(t){for(var e=this.eventMap,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];e.fire(t,r)}},{key:"resetData",value:function(t){this.editor.clear(),this.data=t,Ji.call(this),Gi.call(this),this.toolbar.resetData(t),this.print.resetData(t),this.selector.resetData(t),this.table.resetData(t)}},{key:"loadData",value:function(t){return this.data.setData(t),Xi.call(this),this}},{key:"freeze",value:function(t,e){return this.data.setFreeze(t,e),Xi.call(this),this}},{key:"undo",value:function(){this.data.undo(),Xi.call(this)}},{key:"redo",value:function(){this.data.redo(),Xi.call(this)}},{key:"reload",value:function(){return Xi.call(this),this}},{key:"getRect",value:function(){var t=this.data;return{width:t.viewWidth(),height:t.viewHeight()}}},{key:"getTableOffset",value:function(){var t=this.data,e=t.rows,n=t.cols,r=this.getRect(),i=r.width,o=r.height;return{width:i-n.indexWidth,height:o-e.height,left:n.indexWidth,top:e.height}}}])&&Yi(e.prototype,n),a&&Yi(e,a),t}()},function(t,e,n){"use strict";var r=n(7);function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.range=new r.a(0,0,0,0),this.ri=0,this.ci=0}var e,n,o;return e=t,(n=[{key:"multiple",value:function(){return this.range.multiple()}},{key:"setIndexes",value:function(t,e){this.ri=t,this.ci=e}},{key:"size",value:function(){return this.range.size()}}])&&i(e.prototype,n),o&&i(e,o),t}();var a=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=0,this.y=0,this.ri=0,this.ci=0};function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.undoItems=[],this.redoItems=[]}var e,n,r;return e=t,(n=[{key:"add",value:function(t){this.undoItems.push(JSON.stringify(t)),this.redoItems=[]}},{key:"canUndo",value:function(){return this.undoItems.length>0}},{key:"canRedo",value:function(){return this.redoItems.length>0}},{key:"undo",value:function(t,e){var n=this.undoItems,r=this.redoItems;this.canUndo()&&(r.push(JSON.stringify(t)),e(JSON.parse(n.pop())))}},{key:"redo",value:function(t,e){var n=this.undoItems,r=this.redoItems;this.canRedo()&&(n.push(JSON.stringify(t)),e(JSON.parse(r.pop())))}}])&&l(e.prototype,n),r&&l(e,r),t}();function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var u=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.range=null,this.state="clear"}var e,n,r;return e=t,(n=[{key:"copy",value:function(t){return this.range=t,this.state="copy",this}},{key:"cut",value:function(t){return this.range=t,this.state="cut",this}},{key:"isCopy",value:function(){return"copy"===this.state}},{key:"isCut",value:function(){return"cut"===this.state}},{key:"isClear",value:function(){return"clear"===this.state}},{key:"clear",value:function(){this.range=null,this.state="clear"}}])&&c(e.prototype,n),r&&c(e,r),t}();function f(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function d(t,e,n){return e&&h(t.prototype,e),n&&h(t,n),t}var p=function(){function t(e,n,r){f(this,t),this.ci=e,this.operator=n,this.value=r}return d(t,[{key:"set",value:function(t,e){this.operator=t,this.value=e}},{key:"includes",value:function(t){var e=this.operator,n=this.value;return"all"===e||"in"===e&&n.includes(t)}},{key:"vlength",value:function(){var t=this.operator,e=this.value;return"in"===t?e.length:0}},{key:"getData",value:function(){return{ci:this.ci,operator:this.operator,value:this.value}}}]),t}(),v=function(){function t(e,n){f(this,t),this.ci=e,this.order=n}return d(t,[{key:"asc",value:function(){return"asc"===this.order}},{key:"desc",value:function(){return"desc"===this.order}}]),t}(),y=function(){function t(){f(this,t),this.ref=null,this.filters=[],this.sort=null}return d(t,[{key:"setData",value:function(t){var e=t.ref,n=t.filters,r=t.sort;null!=e&&(this.ref=e,this.filters=n.map(function(t){return new p(t.ci,t.operator,t.value)}),r&&(this.sort=new v(r.ci,r.order)))}},{key:"getData",value:function(){if(this.active()){var t=this.ref,e=this.filters,n=this.sort;return{ref:t,filters:e.map(function(t){return t.getData()}),sort:n}}return{}}},{key:"addFilter",value:function(t,e,n){var r=this.getFilter(t);null==r?this.filters.push(new p(t,e,n)):r.set(e,n)}},{key:"setSort",value:function(t,e){this.sort=e?new v(t,e):null}},{key:"includes",value:function(t,e){return!!this.active()&&this.hrange().includes(t,e)}},{key:"getSort",value:function(t){var e=this.sort;return e&&e.ci===t?e:null}},{key:"getFilter",value:function(t){for(var e=this.filters,n=0;n<e.length;n+=1)if(e[n].ci===t)return e[n];return null}},{key:"filteredRows",value:function(t){var e=new Set,n=new Set;if(this.active())for(var r=this.range(),i=r.sri,o=r.eri,a=this.filters,l=i+1;l<=o;l+=1)for(var s=0;s<a.length;s+=1){var c=a[s],u=t(l,c.ci),f=u?u.text:"";if(!c.includes(f)){e.add(l);break}n.add(l)}return{rset:e,fset:n}}},{key:"items",value:function(t,e){var n={};if(this.active())for(var r=this.range(),i=r.sri,o=r.eri,a=i+1;a<=o;a+=1){var l=e(a,t);if(null===l||/^\s*$/.test(l.text))n[""]=(n[""]||0)+1;else{var s=l.text,c=(n[s]||0)+1;n[s]=c}}return n}},{key:"range",value:function(){return r.a.valueOf(this.ref)}},{key:"hrange",value:function(){var t=this.range();return t.eri=t.sri,t}},{key:"clear",value:function(){this.ref=null,this.filters=[],this.sort=null}},{key:"active",value:function(){return null!==this.ref}}]),t}();function b(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var g=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._=e}var e,n,i;return e=t,(n=[{key:"forEach",value:function(t){this._.forEach(t)}},{key:"deleteWithin",value:function(t){this._=this._.filter(function(e){return!e.within(t)})}},{key:"getFirstIncludes",value:function(t,e){for(var n=0;n<this._.length;n+=1){var r=this._[n];if(r.includes(t,e))return r}return null}},{key:"filterIntersects",value:function(e){return new t(this._.filter(function(t){return t.intersects(e)}))}},{key:"intersects",value:function(t){for(var e=0;e<this._.length;e+=1){if(this._[e].intersects(t))return!0}return!1}},{key:"union",value:function(t){var e=t;return this._.forEach(function(t){t.intersects(e)&&(e=t.union(e))}),e}},{key:"add",value:function(t){this.deleteWithin(t),this._.push(t)}},{key:"shift",value:function(t,e,n,r){this._.forEach(function(i){var o=i.sri,a=i.sci,l=i.eri,s=i.eci,c=i;"row"===t?o>=e?(c.sri+=n,c.eri+=n):o<e&&e<=l&&(c.eri+=n,r(o,a,n,0)):"column"===t&&(a>=e?(c.sci+=n,c.eci+=n):a<e&&e<=s&&(c.eci+=n,r(o,a,0,n)))})}},{key:"move",value:function(t,e,n){this._.forEach(function(r){var i=r;i.within(t)&&(i.eri+=e,i.sri+=e,i.sci+=n,i.eci+=n)})}},{key:"setData",value:function(t){return this._=t.map(function(t){return r.a.valueOf(t)}),this}},{key:"getData",value:function(){return this._.map(function(t){return t.toString()})}}])&&b(e.prototype,n),i&&b(e,i),t}(),m=n(5),w=n(6);function L(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function O(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var k=function(){function t(e){var n=e.len,r=e.height;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._={},this.len=n,this.height=r}var e,n,r;return e=t,(n=[{key:"getHeight",value:function(t){if(this.isHide(t))return 0;var e=this.get(t);return e&&e.height?e.height:this.height}},{key:"setHeight",value:function(t,e){this.getOrNew(t).height=e}},{key:"unhide",value:function(t){for(var e=t;e>0&&(e-=1,this.isHide(e));)this.setHide(e,!1)}},{key:"isHide",value:function(t){var e=this.get(t);return e&&e.hide}},{key:"setHide",value:function(t,e){var n=this.getOrNew(t);!0===e?n.hide=!0:delete n.hide}},{key:"setStyle",value:function(t,e){this.getOrNew(t).style=e}},{key:"sumHeight",value:function(t,e,n){var r=this;return m.a.rangeSum(t,e,function(t){return n&&n.has(t)?0:r.getHeight(t)})}},{key:"totalHeight",value:function(){return this.sumHeight(0,this.len)}},{key:"get",value:function(t){return this._[t]}},{key:"getOrNew",value:function(t){return this._[t]=this._[t]||{cells:{}},this._[t]}},{key:"getCell",value:function(t,e){var n=this.get(t);return void 0!==n&&void 0!==n.cells&&void 0!==n.cells[e]?n.cells[e]:null}},{key:"getCellMerge",value:function(t,e){var n=this.getCell(t,e);return n&&n.merge?n.merge:[0,0]}},{key:"getCellOrNew",value:function(t,e){var n=this.getOrNew(t);return n.cells[e]=n.cells[e]||{},n.cells[e]}},{key:"setCell",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"all",i=this.getOrNew(t);"all"===r?i.cells[e]=n:"text"===r?(i.cells[e]=i.cells[e]||{},i.cells[e].text=n.text):"format"===r&&(i.cells[e]=i.cells[e]||{},i.cells[e].style=n.style,n.merge&&(i.cells[e].merge=n.merge))}},{key:"setCellText",value:function(t,e,n){var r=this.getCellOrNew(t,e);!1!==r.editable&&(r.text=n)}},{key:"copyPaste",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){},o=t.sri,a=t.sci,l=t.eri,s=t.eci,c=e.sri,u=e.sci,f=e.eri,h=e.eci,d=t.size(),p=L(d,2),v=p[0],y=p[1],b=e.size(),g=L(b,2),O=g[0],k=g[1],j=!0,x=0;(f<o||h<a)&&(j=!1,x=f<o?O:k);for(var _=o;_<=l;_+=1)if(this._[_])for(var S=a;S<=s;S+=1)if(this._[_].cells&&this._[_].cells[S])for(var C=c;C<=f;C+=v)for(var E=u;E<=h;E+=y){var M=C+(_-o),T=E+(S-a),P=m.a.cloneDeep(this._[_].cells[S]);r&&P&&P.text&&P.text.length>0&&function(){var t=P.text,e=E-u+(C-c)+2;if(j||(e-=x+1),console.log("n: ".concat(e)),"="===t[0])P.text=t.replace(/\$?[a-zA-Z]{1,3}\$?\d+/g,function(t){var n=0,r=0;return o===c?n=e-1+(u-a)-1:r=e-1+(c-o)-1,/^\d+$/.test(t)?t:Object(w.a)(t,n,r)});else if(v<=1&&y>1&&(c>l||f<o)||y<=1&&v>1&&(u>s||h<a)||v<=1&&y<=1){var n=/[\\.\d]+$/.exec(t);if(null!==n){var r=Number(n[0])+e-1;P.text=t.substring(0,n.index)+r}}}(),this.setCell(M,T,P,n),i(M,T,P)}}},{key:"cutPaste",value:function(t,e){var n=this,r={};this.each(function(i){n.eachCells(i,function(o){var a=parseInt(i,10),l=parseInt(o,10);t.includes(i,o)&&(a=e.sri+(a-t.sri),l=e.sci+(l-t.sci)),r[a]=r[a]||{cells:{}},r[a].cells[l]=n._[i].cells[o]})}),this._=r}},{key:"paste",value:function(t,e){var n=this;if(!(t.length<=0)){var r=e.sri,i=e.sci;t.forEach(function(t,e){var o=r+e;t.forEach(function(t,e){var r=i+e;n.setCellText(o,r,t)})})}}},{key:"insert",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r={};this.each(function(i,o){var a=parseInt(i,10);a>=t&&(a+=n,e.eachCells(i,function(e,r){r.text&&"="===r.text[0]&&(r.text=r.text.replace(/[a-zA-Z]{1,3}\d+/g,function(e){return Object(w.a)(e,0,n,function(e,n){return n>=t})}))})),r[a]=o}),this._=r,this.len+=n}},{key:"delete",value:function(t,e){var n=this,r=e-t+1,i={};this.each(function(o,a){var l=parseInt(o,10);l<t?i[l]=a:o>e&&(i[l-r]=a,n.eachCells(o,function(t,n){n.text&&"="===n.text[0]&&(n.text=n.text.replace(/[a-zA-Z]{1,3}\d+/g,function(t){return Object(w.a)(t,0,-r,function(t,n){return n>e})}))}))}),this._=i,this.len-=r}},{key:"insertColumn",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.each(function(r,i){var o={};e.eachCells(r,function(e,r){var i=parseInt(e,10);i>=t&&(i+=n,r.text&&"="===r.text[0]&&(r.text=r.text.replace(/[a-zA-Z]{1,3}\d+/g,function(e){return Object(w.a)(e,n,0,function(e){return e>=t})}))),o[i]=r}),i.cells=o})}},{key:"deleteColumn",value:function(t,e){var n=this,r=e-t+1;this.each(function(i,o){var a={};n.eachCells(i,function(n,i){var o=parseInt(n,10);o<t?a[o]=i:o>e&&(a[o-r]=i,i.text&&"="===i.text[0]&&(i.text=i.text.replace(/[a-zA-Z]{1,3}\d+/g,function(t){return Object(w.a)(t,-r,0,function(t){return t>e})})))}),o.cells=a})}},{key:"deleteCells",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all";t.each(function(t,r){e.deleteCell(t,r,n)})}},{key:"deleteCell",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"all",r=this.get(t);if(null!==r){var i=this.getCell(t,e);null!==i&&!1!==i.editable&&("all"===n?delete r.cells[e]:"text"===n?(i.text&&delete i.text,i.value&&delete i.value):"format"===n?(void 0!==i.style&&delete i.style,i.merge&&delete i.merge):"merge"===n&&i.merge&&delete i.merge)}}},{key:"maxCell",value:function(){var t=Object.keys(this._),e=t[t.length-1],n=this._[e];if(n){var r=n.cells,i=Object.keys(r),o=i[i.length-1];return[parseInt(e,10),parseInt(o,10)]}return[0,0]}},{key:"each",value:function(t){Object.entries(this._).forEach(function(e){var n=L(e,2),r=n[0],i=n[1];t(r,i)})}},{key:"eachCells",value:function(t,e){this._[t]&&this._[t].cells&&Object.entries(this._[t].cells).forEach(function(t){var n=L(t,2),r=n[0],i=n[1];e(r,i)})}},{key:"setData",value:function(t){t.len&&(this.len=t.len,delete t.len),this._=t}},{key:"getData",value:function(){var t=this.len;return Object.assign({len:t},this._)}}])&&O(e.prototype,n),r&&O(e,r),t}();function j(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var x=function(){function t(e){var n=e.len,r=e.width,i=e.indexWidth,o=e.minWidth;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._={},this.len=n,this.width=r,this.indexWidth=i,this.minWidth=o}var e,n,r;return e=t,(n=[{key:"setData",value:function(t){t.len&&(this.len=t.len,delete t.len),this._=t}},{key:"getData",value:function(){var t=this.len;return Object.assign({len:t},this._)}},{key:"getWidth",value:function(t){if(this.isHide(t))return 0;var e=this._[t];return e&&e.width?e.width:this.width}},{key:"getOrNew",value:function(t){return this._[t]=this._[t]||{},this._[t]}},{key:"setWidth",value:function(t,e){this.getOrNew(t).width=e}},{key:"unhide",value:function(t){for(var e=t;e>0&&(e-=1,this.isHide(e));)this.setHide(e,!1)}},{key:"isHide",value:function(t){var e=this._[t];return e&&e.hide}},{key:"setHide",value:function(t,e){var n=this.getOrNew(t);!0===e?n.hide=!0:delete n.hide}},{key:"setStyle",value:function(t,e){this.getOrNew(t).style=e}},{key:"sumWidth",value:function(t,e){var n=this;return m.a.rangeSum(t,e,function(t){return n.getWidth(t)})}},{key:"totalWidth",value:function(){return this.sumWidth(0,this.len)}}])&&j(e.prototype,n),r&&j(e,r),t}(),_=n(2);function S(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function C(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var E={phone:/^[1-9]\d{10}$/,email:/w+([-+.]w+)*@w+([-.]w+)*.w+([-.]w+)*/};function M(t,e){var n="";if(!t){for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];n=_.b.apply(void 0,["validation.".concat(e)].concat(i))}return[t,n]}var T=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.required=n,this.value=r,this.type=e,this.operator=i,this.message=""}var e,n,r;return e=t,(n=[{key:"parseValue",value:function(t){var e=this.type;return"date"===e?new Date(t):"number"===e?Number(t):t}},{key:"equals",value:function(t){var e=this.type===t.type&&this.required===t.required&&this.operator===t.operator;return e&&(e=Array.isArray(this.value)?m.a.arrayEquals(this.value,t.value):this.value===t.value),e}},{key:"values",value:function(){return this.value.split(",")}},{key:"validate",value:function(t){var e=this.required,n=this.operator,r=this.value,i=this.type;if(e&&/^\s*$/.test(t))return M(!1,"required");if(/^\s*$/.test(t))return[!0];if(E[i]&&!E[i].test(t))return M(!1,"notMatch");if("list"===i)return M(this.values().includes(t),"notIn");if(n){var o=this.parseValue(t);if("be"===n){var a=S(r,2),l=a[0],s=a[1];return M(o>=this.parseValue(l)&&o<=this.parseValue(s),"between",l,s)}if("nbe"===n){var c=S(r,2),u=c[0],f=c[1];return M(o<this.parseValue(u)||o>this.parseValue(f),"notBetween",u,f)}if("eq"===n)return M(o===this.parseValue(r),"equal",r);if("neq"===n)return M(o!==this.parseValue(r),"notEqual",r);if("lt"===n)return M(o<this.parseValue(r),"lessThan",r);if("lte"===n)return M(o<=this.parseValue(r),"lessThanEqual",r);if("gt"===n)return M(o>this.parseValue(r),"greaterThan",r);if("gte"===n)return M(o>=this.parseValue(r),"greaterThanEqual",r)}return[!0]}}])&&C(e.prototype,n),r&&C(e,r),t}();function P(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function A(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Z(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function D(t,e,n){return e&&Z(t.prototype,e),n&&Z(t,n),t}var z=function(){function t(e,n,r){A(this,t),this.refs=n,this.mode=e,this.validator=r}return D(t,[{key:"includes",value:function(t,e){for(var n=this.refs,i=0;i<n.length;i+=1){if(r.a.valueOf(n[i]).includes(t,e))return!0}return!1}},{key:"addRef",value:function(t){this.remove(r.a.valueOf(t)),this.refs.push(t)}},{key:"remove",value:function(t){var e=[];this.refs.forEach(function(n){var i=r.a.valueOf(n);i.intersects(t)?i.difference(t).forEach(function(t){return e.push(t.toString())}):e.push(n)}),this.refs=e}},{key:"getData",value:function(){var t=this.refs,e=this.mode,n=this.validator;return{refs:t,mode:e,type:n.type,required:n.required,operator:n.operator,value:n.value}}}],[{key:"valueOf",value:function(e){var n=e.refs,r=e.mode,i=e.type,o=e.required,a=e.operator,l=e.value;return new t(r,n,new T(i,o,l,a))}}]),t}(),R=function(){function t(){A(this,t),this._=[],this.errors=new Map}return D(t,[{key:"getError",value:function(t,e){return this.errors.get("".concat(t,"_").concat(e))}},{key:"validate",value:function(t,e,n){var r=this.get(t,e),i="".concat(t,"_").concat(e),o=this.errors;if(null!==r){var a=P(r.validator.validate(n),2),l=a[0],s=a[1];l?o.delete(i):o.set(i,s)}else o.delete(i);return!0}},{key:"add",value:function(t,e,n){var r=n.type,i=n.required,o=n.value,a=n.operator,l=new T(r,i,o,a),s=this.getByValidator(l);null!==s?s.addRef(e):this._.push(new z(t,[e],l))}},{key:"getByValidator",value:function(t){for(var e=0;e<this._.length;e+=1){var n=this._[e];if(n.validator.equals(t))return n}return null}},{key:"get",value:function(t,e){for(var n=0;n<this._.length;n+=1){var r=this._[n];if(r.includes(t,e))return r}return null}},{key:"remove",value:function(t){this.each(function(e){e.remove(t)})}},{key:"each",value:function(t){this._.forEach(function(e){return t(e)})}},{key:"getData",value:function(){return this._.filter(function(t){return t.refs.length>0}).map(function(t){return t.getData()})}},{key:"setData",value:function(t){this._=t.map(function(t){return z.valueOf(t)})}}]),t}();function F(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function I(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function N(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}n.d(e,"a",function(){return q});var H={mode:"edit",view:{height:function(){return document.documentElement.clientHeight},width:function(){return document.documentElement.clientWidth}},showGrid:!0,showToolbar:!0,showContextmenu:!0,showBottomBar:!0,autoFillOnCopy:!1,row:{len:100,height:25},col:{len:26,width:100,indexWidth:60,minWidth:60},style:{bgcolor:"#ffffff",align:"left",valign:"middle",textwrap:!1,strike:!1,underline:!1,color:"#0a0a0a",font:{name:"Arial",size:10,bold:!1,italic:!1},format:""}};function V(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},r=this.merges,i=e.clone(),o=N(t.size(),2),a=o[0],l=o[1],s=N(e.size(),2),c=s[0],u=s[1];return a>c&&(i.eri=e.sri+a-1),l>u&&(i.eci=e.sci+l-1),!r.intersects(i)||(n(Object(_.b)("error.pasteForMergedCell")),!1)}function W(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this.rows,a=this.merges;"all"!==n&&"format"!==n||(o.deleteCells(e,n),a.deleteWithin(e)),o.copyPaste(t,e,n,i,function(t,e,n){if(n&&n.merge){var i=N(n.merge,2),o=i[0],l=i[1];if(o<=0&&l<=0)return;a.add(new r.a(t,e,t+o,e+l))}})}function Y(t,e){var n=this.clipboard,r=this.rows,i=this.merges;r.cutPaste(t,e),i.move(t,e.sri-t.sri,e.sci-t.sci),n.clear()}function B(t,e,n){var r=this.styles,i=this.rows.getCellOrNew(t,e),o={};void 0!==i.style&&(o=m.a.cloneDeep(r[i.style])),o=m.a.merge(o,{border:n}),i.style=this.addStyle(o)}var q=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.settings=m.a.merge(H,n||{}),this.name=e||"sheet",this.freeze=[0,0],this.styles=[],this.merges=new g,this.rows=new k(this.settings.row),this.cols=new x(this.settings.col),this.validations=new R,this.hyperlinks={},this.comments={},this.selector=new o,this.scroll=new a,this.history=new s,this.clipboard=new u,this.autoFilter=new y,this.change=function(){},this.exceptRowSet=new Set,this.sortedRowMap=new Map,this.unsortedRowMap=new Map}var e,n,i;return e=t,(n=[{key:"addValidation",value:function(t,e,n){var r=this;this.changeData(function(){r.validations.add(t,e,n)})}},{key:"removeValidation",value:function(){var t=this,e=this.selector.range;this.changeData(function(){t.validations.remove(e)})}},{key:"getSelectedValidator",value:function(){var t=this.selector,e=t.ri,n=t.ci,r=this.validations.get(e,n);return r?r.validator:null}},{key:"getSelectedValidation",value:function(){var t=this.selector,e=t.ri,n=t.ci,r=t.range,i=this.validations.get(e,n),o={ref:r.toString()};return null!==i&&(o.mode=i.mode,o.validator=i.validator),o}},{key:"canUndo",value:function(){return this.history.canUndo()}},{key:"canRedo",value:function(){return this.history.canRedo()}},{key:"undo",value:function(){var t=this;this.history.undo(this.getData(),function(e){t.setData(e)})}},{key:"redo",value:function(){var t=this;this.history.redo(this.getData(),function(e){t.setData(e)})}},{key:"copy",value:function(){this.clipboard.copy(this.selector.range)}},{key:"copyToSystemClipboard",value:function(t){for(var e=[],n=this.selector.range,r=n.sri,i=n.eri,o=n.sci,a=n.eci,l=r;l<=i;l+=1){for(var s=[],c=o;c<=a;c+=1){var u=this.getCell(l,c);s.push(u&&u.text||"")}e.push(s)}e=e.map(function(t){return t.join("\t")}).join("\n"),t&&(t.clipboardData.clearData(),t.clipboardData.setData("text/plain",e),t.preventDefault()),navigator.clipboard&&navigator.clipboard.writeText(e).then(function(){},function(t){console.log("text copy to the system clipboard error  ",e,t)})}},{key:"cut",value:function(){this.clipboard.cut(this.selector.range)}},{key:"paste",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},r=this.clipboard,i=this.selector;return!r.isClear()&&(!!V.call(this,r.range,i.range,n)&&(this.changeData(function(){r.isCopy()?W.call(t,r.range,i.range,e,t.settings.autoFillOnCopy):r.isCut()&&Y.call(t,r.range,i.range)}),!0))}},{key:"pasteFromSystemClipboard",value:function(t,e){var n=this,r=this.selector;navigator.clipboard.readText().then(function(i){var o=n.parseClipboardContent(i),a=r.ri;o.forEach(function(t){var e=r.ci;t.forEach(function(t){n.setCellText(a,e,t,"input"),e+=1}),a+=1}),t(),e(n.rows.getData())})}},{key:"parseClipboardContent",value:function(t){var e=[],n=t.split("\n"),r=0;return n.forEach(function(t){e[r]=t.split("\t"),r+=1}),e}},{key:"pasteFromText",value:function(t){var e=[];if((e=/\r\n/.test(t)?t.split("\r\n").map(function(t){return t.replace(/"/g,"").split("\t")}):t.split("\n").map(function(t){return t.replace(/"/g,"").split("\t")})).length){var n=this.rows,r=this.selector;this.changeData(function(){n.paste(e,r.range)})}}},{key:"autofill",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},i=this.selector.range;return!!V.call(this,i,t,r)&&(this.changeData(function(){W.call(n,i,t,e,!0)}),!0)}},{key:"clearClipboard",value:function(){this.clipboard.clear()}},{key:"calSelectedRangeByEnd",value:function(t,e){var n=this.selector,i=this.rows,o=this.cols,a=this.merges,l=n.range,s=l.sri,c=l.sci,u=l.eri,f=l.eci,h=n.ri,d=n.ci,p=t,v=e;return t<0&&(p=i.len-1),e<0&&(v=o.len-1),p>h?(s=h,u=p):(s=p,u=h),v>d?(c=d,f=v):(c=v,f=d),n.range=a.union(new r.a(s,c,u,f)),n.range=a.union(n.range),n.range}},{key:"calSelectedRangeByStart",value:function(t,e){var n=this.selector,i=this.rows,o=this.cols,a=this.merges.getFirstIncludes(t,e);return null===a&&(a=new r.a(t,e,t,e),-1===t&&(a.sri=0,a.eri=i.len-1),-1===e&&(a.sci=0,a.eci=o.len-1)),n.range=a,a}},{key:"setSelectedCellAttr",value:function(t,e){var n=this;this.changeData(function(){var r=n.selector,i=n.styles,o=n.rows;if("merge"===t)e?n.merge():n.unmerge();else if("border"===t)(function(t){var e=this,n=t.mode,r=t.style,i=t.color,o=this.styles,a=this.selector,l=this.rows,s=a.range,c=s.sri,u=s.sci,f=s.eri,h=s.eci,d=!this.isSingleSelected();if(d||"inside"!==n&&"horizontal"!==n&&"vertical"!==n)if("outside"!==n||d){if("none"===n)a.range.each(function(t,n){var r=l.getCell(t,n);if(r&&void 0!==r.style){var i=m.a.cloneDeep(o[r.style]);delete i.border,r.style=e.addStyle(i)}});else if("all"===n||"inside"===n||"outside"===n||"horizontal"===n||"vertical"===n)!function(){for(var t=[],o=c;o<=f;o+=1)for(var a=u;a<=h;a+=1){for(var s=[],p=0;p<t.length;p+=1){var v=N(t[p],4),y=v[0],b=v[1],g=v[2],m=v[3];if(o===y+g+1&&s.push(p),y<=o&&o<=y+g&&a===b){a+=m+1;break}}if(s.forEach(function(e){return t.splice(e,1)}),a>h)break;var w=l.getCell(o,a),L=0,O=0;if(w&&w.merge){var k=N(w.merge,2);L=k[0],O=k[1],t.push([o,a,L,O])}var j=L>0&&o+L===f,x=O>0&&a+O===h,_={};"all"===n?_={bottom:[r,i],top:[r,i],left:[r,i],right:[r,i]}:"inside"===n?(!x&&a<h&&(_.right=[r,i]),!j&&o<f&&(_.bottom=[r,i])):"horizontal"===n?!j&&o<f&&(_.bottom=[r,i]):"vertical"===n?!x&&a<h&&(_.right=[r,i]):"outside"===n&&d&&(c===o&&(_.top=[r,i]),(j||f===o)&&(_.bottom=[r,i]),u===a&&(_.left=[r,i]),(x||h===a)&&(_.right=[r,i])),Object.keys(_).length>0&&B.call(e,o,a,_),a+=O}}();else if("top"===n||"bottom"===n)for(var p=u;p<=h;p+=1)"top"===n&&(B.call(this,c,p,{top:[r,i]}),p+=l.getCellMerge(c,p)[1]),"bottom"===n&&(B.call(this,f,p,{bottom:[r,i]}),p+=l.getCellMerge(f,p)[1]);else if("left"===n||"right"===n)for(var v=c;v<=f;v+=1)"left"===n&&(B.call(this,v,u,{left:[r,i]}),v+=l.getCellMerge(v,u)[0]),"right"===n&&(B.call(this,v,h,{right:[r,i]}),v+=l.getCellMerge(v,h)[0])}else B.call(this,c,u,{top:[r,i],bottom:[r,i],left:[r,i],right:[r,i]})}).call(n,e);else if("formula"===t){var a=r.ri,l=r.ci,s=r.range;if(r.multiple()){var c=N(r.size(),2),u=c[0],f=c[1],h=s.sri,d=s.sci,p=s.eri,v=s.eci;if(u>1)for(var y=d;y<=v;y+=1){o.getCellOrNew(p+1,y).text="=".concat(e,"(").concat(Object(w.d)(y,h),":").concat(Object(w.d)(y,p),")")}else if(f>1){o.getCellOrNew(a,v+1).text="=".concat(e,"(").concat(Object(w.d)(d,a),":").concat(Object(w.d)(v,a),")")}}else{o.getCellOrNew(a,l).text="=".concat(e,"()")}}else r.range.each(function(r,a){var l=o.getCellOrNew(r,a),s={};if(void 0!==l.style&&(s=m.a.cloneDeep(i[l.style])),"format"===t)s.format=e,l.style=n.addStyle(s);else if("font-bold"===t||"font-italic"===t||"font-name"===t||"font-size"===t){var c={};c[t.split("-")[1]]=e,s.font=Object.assign(s.font||{},c),l.style=n.addStyle(s)}else"strike"===t||"textwrap"===t||"underline"===t||"align"===t||"valign"===t||"color"===t||"bgcolor"===t?(s[t]=e,l.style=n.addStyle(s)):l[t]=e})})}},{key:"setSelectedCellText",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"input",n=this.autoFilter,r=this.selector,i=this.rows,o=r.ri,a=r.ci,l=o;this.unsortedRowMap.has(o)&&(l=this.unsortedRowMap.get(o));var s=i.getCell(l,a),c=s?s.text:"";if(this.setCellText(l,a,t,e),n.active()){var u=n.getFilter(a);if(u){var f=u.value.findIndex(function(t){return t===c});f>=0&&u.value.splice(f,1,t)}}}},{key:"getSelectedCell",value:function(){var t=this.selector,e=t.ri,n=t.ci,r=e;return this.unsortedRowMap.has(e)&&(r=this.unsortedRowMap.get(e)),this.rows.getCell(r,n)}},{key:"xyInSelectedRect",value:function(t,e){var n=this.getSelectedRect(),r=n.left,i=n.top,o=n.width,a=n.height,l=t-this.cols.indexWidth,s=e-this.rows.height;return l>r&&l<r+o&&s>i&&s<i+a}},{key:"getSelectedRect",value:function(){return this.getRect(this.selector.range)}},{key:"getClipboardRect",value:function(){var t=this.clipboard;return t.isClear()?{left:-100,top:-100}:this.getRect(t.range)}},{key:"getRect",value:function(t){var e=this.scroll,n=this.rows,r=this.cols,i=this.exceptRowSet,o=t.sri,a=t.sci,l=t.eri,s=t.eci;if(o<0&&a<0)return{left:0,l:0,top:0,t:0,scroll:e};var c=r.sumWidth(0,a),u=n.sumHeight(0,o,i),f=n.sumHeight(o,l+1,i),h=r.sumWidth(a,s+1),d=c-e.x,p=u-e.y,v=this.freezeTotalHeight(),y=this.freezeTotalWidth();return y>0&&y>c&&(d=c),v>0&&v>u&&(p=u),{l:c,t:u,left:d,top:p,height:f,width:h,scroll:e}}},{key:"getCellRectByXY",value:function(t,e){var n=this.scroll,r=this.merges,i=this.rows,o=this.cols,a=function(t,e){var n=this.rows,r=this.freezeTotalHeight(),i=n.height;r+n.height<t&&(i-=e);for(var o=this.exceptRowSet,a=0,l=i,s=n.height;a<n.len&&!(l>t);a+=1)o.has(a)||(l+=s=n.getHeight(a));return(l-=s)<=0?{ri:-1,top:0,height:s}:{ri:a-1,top:l,height:s}}.call(this,e,n.y),l=a.ri,s=a.top,c=a.height,u=function(t,e){var n=this.cols,r=this.freezeTotalWidth(),i=n.indexWidth;r+n.indexWidth<t&&(i-=e);var o=N(m.a.rangeReduceIf(0,n.len,i,n.indexWidth,t,function(t){return n.getWidth(t)}),3),a=o[0],l=o[1],s=o[2];return l<=0?{ci:-1,left:0,width:n.indexWidth}:{ci:a-1,left:l,width:s}}.call(this,t,n.x),f=u.ci,h=u.left,d=u.width;if(-1===f&&(d=o.totalWidth()),-1===l&&(c=i.totalHeight()),l>=0||f>=0){var p=r.getFirstIncludes(l,f);if(p){l=p.sri,f=p.sci;var v=this.cellRect(l,f);h=v.left,s=v.top,d=v.width,c=v.height}}return{ri:l,ci:f,left:h,top:s,width:d,height:c}}},{key:"isSingleSelected",value:function(){var t=this.selector.range,e=t.sri,n=t.sci,r=t.eri,i=t.eci,o=this.getCell(e,n);if(o&&o.merge){var a=N(o.merge,2),l=a[0],s=a[1];if(e+l===r&&n+s===i)return!0}return!this.selector.multiple()}},{key:"canUnmerge",value:function(){var t=this.selector.range,e=t.sri,n=t.sci,r=t.eri,i=t.eci,o=this.getCell(e,n);if(o&&o.merge){var a=N(o.merge,2),l=a[0],s=a[1];if(e+l===r&&n+s===i)return!0}return!1}},{key:"merge",value:function(){var t=this,e=this.selector,n=this.rows;if(!this.isSingleSelected()){var r=N(e.size(),2),i=r[0],o=r[1];if(i>1||o>1){var a=e.range,l=a.sri,s=a.sci;this.changeData(function(){var r=n.getCellOrNew(l,s);r.merge=[i-1,o-1],t.merges.add(e.range),t.rows.deleteCells(e.range),t.rows.setCell(l,s,r)})}}}},{key:"unmerge",value:function(){var t=this,e=this.selector;if(this.isSingleSelected()){var n=e.range,r=n.sri,i=n.sci;this.changeData(function(){t.rows.deleteCell(r,i,"merge"),t.merges.deleteWithin(e.range)})}}},{key:"canAutofilter",value:function(){return!this.autoFilter.active()}},{key:"autofilter",value:function(){var t=this,e=this.autoFilter,n=this.selector;this.changeData(function(){e.active()?(e.clear(),t.exceptRowSet=new Set,t.sortedRowMap=new Map,t.unsortedRowMap=new Map):e.ref=n.range.toString()})}},{key:"setAutoFilter",value:function(t,e,n,r){var i=this.autoFilter;i.addFilter(t,n,r),i.setSort(t,e),this.resetAutoFilter()}},{key:"resetAutoFilter",value:function(){var t=this,e=this.autoFilter,n=this.rows;if(e.active()){var r=e.sort,i=e.filteredRows(function(t,e){return n.getCell(t,e)}),o=i.rset,a=i.fset,l=Array.from(a),s=Array.from(a);r&&l.sort(function(t,e){return"asc"===r.order?t-e:"desc"===r.order?e-t:0}),this.exceptRowSet=o,this.sortedRowMap=new Map,this.unsortedRowMap=new Map,l.forEach(function(e,n){t.sortedRowMap.set(s[n],e),t.unsortedRowMap.set(e,s[n])})}}},{key:"deleteCell",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",n=this.selector;this.changeData(function(){t.rows.deleteCells(n.range,e),"all"!==e&&"format"!==e||t.merges.deleteWithin(n.range)})}},{key:"insert",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.changeData(function(){var r=e.selector.range,i=r.sri,o=r.sci,a=e.rows,l=e.merges,s=e.cols,c=i;"row"===t?a.insert(i,n):"column"===t&&(a.insertColumn(o,n),c=o,s.len+=1),l.shift(t,c,n,function(t,e,n,r){var i=a.getCell(t,e);i.merge[0]+=n,i.merge[1]+=r})})}},{key:"delete",value:function(t){var e=this;this.changeData(function(){var n=e.rows,r=e.merges,i=e.selector,o=e.cols,a=i.range,l=i.range,s=l.sri,c=l.sci,u=l.eri,f=l.eci,h=N(i.range.size(),2),d=h[0],p=h[1],v=s,y=d;"row"===t?n.delete(s,u):"column"===t&&(n.deleteColumn(c,f),v=a.sci,y=p,o.len-=f-c+1),r.shift(t,v,-y,function(t,e,r,i){var o=n.getCell(t,e);o.merge[0]+=r,o.merge[1]+=i,0===o.merge[0]&&0===o.merge[1]&&delete o.merge})})}},{key:"scrollx",value:function(t,e){var n=this.scroll,r=this.freeze,i=this.cols,o=N(r,2)[1],a=N(m.a.rangeReduceIf(o,i.len,0,0,t,function(t){return i.getWidth(t)}),3),l=a[0],s=a[1],c=a[2],u=s;t>0&&(u+=c),n.x!==u&&(n.ci=t>0?l:0,n.x=u,e())}},{key:"scrolly",value:function(t,e){var n=this.scroll,r=this.freeze,i=this.rows,o=N(r,1)[0],a=N(m.a.rangeReduceIf(o,i.len,0,0,t,function(t){return i.getHeight(t)}),3),l=a[0],s=a[1],c=a[2],u=s;t>0&&(u+=c),n.y!==u&&(n.ri=t>0?l:0,n.y=u,e())}},{key:"cellRect",value:function(t,e){var n=this.rows,r=this.cols,i=r.sumWidth(0,e),o=n.sumHeight(0,t),a=n.getCell(t,e),l=r.getWidth(e),s=n.getHeight(t);if(null!==a&&a.merge){var c=N(a.merge,2),u=c[0],f=c[1];if(u>0)for(var h=1;h<=u;h+=1)s+=n.getHeight(t+h);if(f>0)for(var d=1;d<=f;d+=1)l+=r.getWidth(e+d)}return{left:i,top:o,width:l,height:s,cell:a}}},{key:"getCell",value:function(t,e){return this.rows.getCell(t,e)}},{key:"getCellTextOrDefault",value:function(t,e){var n=this.getCell(t,e);return n&&n.text?n.text:""}},{key:"getCellStyle",value:function(t,e){var n=this.getCell(t,e);return n&&void 0!==n.style?this.styles[n.style]:null}},{key:"getCellStyleOrDefault",value:function(t,e){var n=this.styles,r=this.rows.getCell(t,e),i=r&&void 0!==r.style?n[r.style]:{};return m.a.merge(this.defaultStyle(),i)}},{key:"getSelectedCellStyle",value:function(){var t=this.selector,e=t.ri,n=t.ci;return this.getCellStyleOrDefault(e,n)}},{key:"setCellText",value:function(t,e,n,r){var i=this.rows,o=this.history,a=this.validations;"finished"===r?(i.setCellText(t,e,""),o.add(this.getData()),i.setCellText(t,e,n)):(i.setCellText(t,e,n),this.change(this.getData())),a.validate(t,e,n)}},{key:"freezeIsActive",value:function(){var t=N(this.freeze,2),e=t[0],n=t[1];return e>0||n>0}},{key:"setFreeze",value:function(t,e){var n=this;this.changeData(function(){n.freeze=[t,e]})}},{key:"freezeTotalWidth",value:function(){return this.cols.sumWidth(0,this.freeze[1])}},{key:"freezeTotalHeight",value:function(){return this.rows.sumHeight(0,this.freeze[0])}},{key:"setRowHeight",value:function(t,e){var n=this;this.changeData(function(){n.rows.setHeight(t,e)})}},{key:"setColWidth",value:function(t,e){var n=this;this.changeData(function(){n.cols.setWidth(t,e)})}},{key:"viewHeight",value:function(){var t=this.settings,e=t.view,n=t.showToolbar,r=t.showBottomBar,i=e.height();return r&&(i-=41),n&&(i-=41),i}},{key:"viewWidth",value:function(){return this.settings.view.width()}},{key:"freezeViewRange",value:function(){var t=N(this.freeze,2),e=t[0],n=t[1];return new r.a(0,0,e-1,n-1,this.freezeTotalWidth(),this.freezeTotalHeight())}},{key:"contentRange",value:function(){var t=this.rows,e=this.cols,n=N(t.maxCell(),2),i=n[0],o=n[1],a=t.sumHeight(0,i+1),l=e.sumWidth(0,o+1);return new r.a(0,0,i,o,l,a)}},{key:"exceptRowTotalHeight",value:function(t,e){var n=this.exceptRowSet,r=this.rows,i=Array.from(n),o=0;return i.forEach(function(n){if(n<t||n>e){var i=r.getHeight(n);o+=i}}),o}},{key:"viewRange",value:function(){var t=this.scroll,e=this.rows,n=this.cols,i=this.freeze,o=this.exceptRowSet,a=t.ri,l=t.ci;a<=0&&(a=N(i,1)[0]);l<=0&&(l=N(i,2)[1]);for(var s=0,c=0,u=[e.len,n.len],f=u[0],h=u[1],d=a;d<e.len&&(o.has(d)||(c+=e.getHeight(d),f=d),!(c>this.viewHeight()));d+=1);for(var p=l;p<n.len&&(h=p,!((s+=n.getWidth(p))>this.viewWidth()));p+=1);return new r.a(a,l,f,h,s,c)}},{key:"eachMergesInView",value:function(t,e){this.merges.filterIntersects(t).forEach(function(t){return e(t)})}},{key:"hideRowsOrCols",value:function(){var t=this.rows,e=this.cols,n=this.selector,r=N(n.size(),2),i=r[0],o=r[1],a=n.range,l=a.sri,s=a.sci,c=a.eri,u=a.eci;if(i===t.len)for(var f=s;f<=u;f+=1)e.setHide(f,!0);else if(o===e.len)for(var h=l;h<=c;h+=1)t.setHide(h,!0)}},{key:"unhideRowsOrCols",value:function(t,e){this["".concat(t,"s")].unhide(e)}},{key:"rowEach",value:function(t,e,n){for(var r=0,i=this.rows,o=this.exceptRowSet,a=F(o),l=0,s=0;s<a.length;s+=1)a[s]<t&&(l+=1);for(var c=t+l;c<=e+l;c+=1)if(o.has(c))l+=1;else{var u=i.getHeight(c);if(u>0&&(n(c,r,u),(r+=u)>this.viewHeight()))break}}},{key:"colEach",value:function(t,e,n){for(var r=0,i=this.cols,o=t;o<=e;o+=1){var a=i.getWidth(o);if(a>0&&(n(o,r,a),(r+=a)>this.viewWidth()))break}}},{key:"defaultStyle",value:function(){return this.settings.style}},{key:"addStyle",value:function(t){for(var e=this.styles,n=0;n<e.length;n+=1){var r=e[n];if(m.a.equals(r,t))return n}return e.push(t),e.length-1}},{key:"changeData",value:function(t){this.history.add(this.getData()),t(),this.change(this.getData())}},{key:"setData",value:function(t){var e=this;return Object.keys(t).forEach(function(n){if("merges"===n||"rows"===n||"cols"===n||"validations"===n)e[n].setData(t[n]);else if("freeze"===n){var r=N(Object(w.b)(t[n]),2),i=r[0],o=r[1];e.freeze=[o,i]}else"autofilter"===n?e.autoFilter.setData(t[n]):void 0!==t[n]&&(e[n]=t[n])}),this}},{key:"getData",value:function(){var t=this.name,e=this.freeze,n=this.styles,r=this.merges,i=this.rows,o=this.cols,a=this.validations,l=this.autoFilter;return{name:t,freeze:Object(w.d)(e[1],e[0]),styles:n,merges:r.getData(),rows:i.getData(),cols:o.getData(),validations:a.getData(),autofilter:l.getData()}}}])&&I(e.prototype,n),i&&I(e,i),t}()},function(t,e,n){"use strict";n.r(e),function(t){n.d(e,"default",function(){return d});var r=n(0),i=n(21),o=n(20),a=n(19),l=n(1),s=n(2);n(24);function c(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function u(t,e){var n=Object.keys(t);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(t)),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n}function f(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var d=function(){function e(n){var i=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var c=n;this.options=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?u(n,!0).forEach(function(e){f(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):u(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({showBottomBar:!0,showPrint:!0,showValidation:!0},s),this.sheetIndex=1,this.datas=[],"string"==typeof n&&(c=document.querySelector(n)),this.bottombar=this.options.showBottomBar?new a.a(function(){if("read"!==i.options.mode){var t=i.addSheet();i.sheet.resetData(t)}},function(t){var e=i.datas[t];i.sheet.resetData(e)},function(){i.deleteSheet()},function(t,e){i.datas[t].name=e,i.sheet.trigger("change")}):null,this.data=this.addSheet();var h=Object(r.b)("div","".concat(l.a)).on("contextmenu",function(t){return t.preventDefault()});if(c.appendChild(h.el),this.sheet=new o.a(h,this.data),null!==this.bottombar&&h.child(this.bottombar.el),!this.options.style||!this.options.style.bgcolor){this.options.style=this.options.style||{};var d=t.getComputedStyle(h.el).getPropertyValue("--ss-background")||"#fff";this.options.style.bgcolor=d;var p=t.getComputedStyle(h.el).getPropertyValue("--ss-text-color")||"#000";this.options.style.color=p}}var n,d,p;return n=e,p=[{key:"locale",value:function(t,e){Object(s.a)(t,e)}}],(d=[{key:"addSheet",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=t||"sheet".concat(this.sheetIndex),o=new i.a(r,this.options);return o.change=function(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];(t=e.sheet).trigger.apply(t,["change"].concat(r))},this.datas.push(o),null!==this.bottombar&&this.bottombar.addItem(r,n,this.options),this.sheetIndex+=1,o}},{key:"deleteSheet",value:function(){if(null!==this.bottombar){var t=c(this.bottombar.deleteItem(),2),e=t[0],n=t[1];e>=0&&(this.datas.splice(e,1),n>=0&&this.sheet.resetData(this.datas[n]),this.sheet.trigger("change"))}}},{key:"loadData",value:function(t){var e=Array.isArray(t)?t:[t];if(null!==this.bottombar&&this.bottombar.clear(),this.sheetIndex=1,this.datas=[],e.length>0)for(var n=0;n<e.length;n+=1){var r=e[n],i=this.addSheet(r.name,0===n);i.setData(r),0===n&&this.sheet.resetData(i)}return this}},{key:"getData",value:function(){return this.datas.map(function(t){return t.getData()})}},{key:"cellText",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return this.datas[r].setCellText(t,e,n,"finished"),this}},{key:"cell",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.datas[n].getCell(t,e)}},{key:"cellStyle",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.datas[n].getCellStyle(t,e)}},{key:"reRender",value:function(){return this.sheet.table.render(),this}},{key:"on",value:function(t,e){return this.sheet.on(t,e),this}},{key:"validate",value:function(){return this.data.validations.errors.size<=0}},{key:"change",value:function(t){return this.sheet.on("change",t),this}}])&&h(n.prototype,d),p&&h(n,p),e}();window&&(window.x_spreadsheet=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new d(t,e)},window.x_spreadsheet.locale=function(t,e){return Object(s.a)(t,e)})}.call(this,n(16))},function(t,e,n){"undefined"!=typeof self&&self,t.exports=function(){"use strict";var t={d:function(e,n){for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},o:function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}},e={};t.d(e,{default:function(){return dt}});var n={1078:"af",1052:"sq",1118:"am",5121:"ar_DZ",15361:"ar_BH",3073:"ar_EG",2049:"ar_IQ",11265:"ar_JO",13313:"ar_KW",12289:"ar_LB",4097:"ar_LY",6145:"ar_MA",8193:"ar_OM",16385:"ar_QA",1025:"ar_SA",10241:"ar_SY",7169:"ar_TN",14337:"ar_AE",9217:"ar_YE",1067:"hy",1101:"as",2092:"az_AZ",1068:"az_AZ",1069:"eu",1059:"be",2117:"bn",1093:"bn_IN",5146:"bs",1026:"bg",1109:"my",1027:"ca",2052:"zh_CN",3076:"zh_HK",5124:"zh_MO",4100:"zh_SG",1028:"zh_TW",1050:"hr",1029:"cs",1030:"da",1125:"dv",2067:"nl_BE",1043:"nl_NL",1126:"bin",3081:"en_AU",10249:"en_BZ",4105:"en_CA",9225:"en_CB",2057:"en_GB",16393:"en_IN",6153:"en_IE",8201:"en_JM",5129:"en_NZ",13321:"en_PH",7177:"en_ZA",11273:"en_TT",1033:"en_US",12297:"en_ZW",1061:"et",1071:"mk",1080:"fo",1065:"fa",1124:"fil",1035:"fi",2060:"fr_BE",11276:"fr_CM",3084:"fr_CA",9228:"fr_CG",12300:"fr_CI",1036:"fr_FR",5132:"fr_LU",13324:"fr_ML",6156:"fr_MC",14348:"fr_MA",10252:"fr_SN",4108:"fr_CH",7180:"fr",1122:"fy_NL",2108:"gd_IE",1084:"gd",1110:"gl",1079:"ka",3079:"de_AT",1031:"de_DE",5127:"de_LI",4103:"de_LU",2055:"de_CH",1032:"el",1140:"gn",1095:"gu",1279:"en",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig_NG",1057:"id",1040:"it_IT",2064:"it_CH",1041:"ja",1099:"kn",1120:"ks",1087:"kk",1107:"km",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1142:"la",1062:"lv",1063:"lt",2110:"ms_BN",1086:"ms_MY",1100:"ml",1082:"mt",1112:"mni",1153:"mi",1102:"mr",1104:"mn",2128:"mn",1121:"ne",1044:"no_NO",2068:"no_NO",1096:"or",1045:"pl",1046:"pt_BR",2070:"pt_PT",1094:"pa",1047:"rm",2072:"ro_MO",1048:"ro_RO",1049:"ru",2073:"ru_MO",1083:"se",1103:"sa",3098:"sr_SP",2074:"sr_SP",1072:"st",1074:"tn",1113:"sd",1115:"si",1051:"sk",1060:"sl",1143:"so",1070:"sb",11274:"es_AR",16394:"es_BO",13322:"es_CL",9226:"es_CO",5130:"es_CR",7178:"es_DO",12298:"es_EC",17418:"es_SV",4106:"es_GT",18442:"es_HN",2058:"es_MX",19466:"es_NI",6154:"es_PA",15370:"es_PY",10250:"es_PE",20490:"es_PR",1034:"es_ES",14346:"es_UY",8202:"es_VE",1089:"sw",2077:"sv_FI",1053:"sv_SE",1114:"syc",1064:"tg",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1073:"ts",1055:"tr",1090:"tk",1058:"uk",1056:"ur",2115:"uz_UZ",1091:"uz_UZ",1075:"ve",1066:"vi",1106:"cy",1076:"xh",1085:"yi",1077:"zu"};const r=/^([a-z\d]+)(?:[_-]([a-z\d]+))?(?:\.([a-z\d]+))?(?:@([a-z\d]+))?$/i,i={},o={group:"",decimal:".",positive:"+",negative:"-",percent:"%",exponent:"E",nan:"NaN",infinity:"",ampm:["AM","PM"],mmmm6:["Muharram","Safar","Rabi I","Rabi II","Jumada I","Jumada II","Rajab","Shaban","Ramadan","Shawwal","Dhul-Qidah","Dhul-Hijjah"],mmm6:["Muh.","Saf.","Rab. I","Rab. II","Jum. I","Jum. II","Raj.","Sha.","Ram.","Shaw.","Dhul-Q.","Dhul-H."],mmmm:["January","February","March","April","May","June","July","August","September","October","November","December"],mmm:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dddd:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ddd:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]};function a(t){const e=r.exec(t);if(!e)throw new SyntaxError("Malformed locale: ".concat(t));return{lang:e[1]+(e[2]?"_"+e[2]:""),language:e[1],territory:e[2]||"",codeset:e[3]||"",modifier:e[4]||""}}function l(t){if("number"==typeof t)return n[65535&t]||null;const e=parseInt(t,16);return isFinite(e)&&n[65535&e]?n[65535&e]||null:r.test(t)?t:null}function s(t){const e=l(t);let n=null;if(e){const t=a(e);n=i[t.lang]||i[t.language]||null}return n}function c(t){return Object.assign({},o,t)}function u(t,e){const n="object"==typeof e?e:a(e);return i[n.lang]=c(t),n.language===n.lang||i[n.language]||(i[n.language]=c(t)),i[n.lang]}const f=c({group:","});function h(t,e){if("number"!=typeof t)return t;if(t<0)return-h(-t,e);if(e){const n=10**(e||0)||1;return h(t*n,0)/n}return Math.round(t)}function d(t,e,n){const r=t<0?-1:1,i=10**(e||2),o=10**(n||2);let a,l,s=Math.abs(t),c=0,u=0,f=0,h=1;if((t=s)%1==0)l=[t*r,1];else if(t<1e-19)l=[r,1e19];else if(t>1e19)l=[1e19*r,1];else{do{if(s=1/(s-Math.floor(s)),a=h,h=h*Math.floor(s)+c,c=a,u=f,(f=Math.floor(t*h+.5))>=i||h>=o)return[r*u,c]}while(Math.abs(t-f/h)>=1e-10&&s!==Math.floor(s));l=[r*f,h]}return l}f.isDefault=!0,u({group:",",ampm:["",""],mmmm:["","","","","","","","","","","",""],mmm:["1","2","3","4","5","6","7","8","9","10","11","12"],dddd:["","","","","","",""],ddd:["","","","","","",""]},"zh_CN"),u({group:",",nan:"",ampm:["",""],mmmm:["1","2","3","4","5","6","7","8","9","10","11","12"],mmm:["1","2","3","4","5","6","7","8","9","10","11","12"],dddd:["","","","","","",""],ddd:["","","","","","",""]},"zh_TW"),u({group:",",ampm:["",""],mmmm:["1","2","3","4","5","6","7","8","9","10","11","12"],mmm:["1","2","3","4","5","6","7","8","9","10","11","12"],dddd:["","","","","","",""],ddd:["","","","","","",""]},"ja"),u({group:",",ampm:["",""],mmmm:["1","2","3","4","5","6","7","8","9","10","11","12"],mmm:["1","2","3","4","5","6","7","8","9","10","11","12"],dddd:["","","","","","",""],ddd:["","","","","","",""]},"ko"),u({group:",",ampm:["",""],mmmm:["","","","","","","","","","","",""],mmm:["..","..","..","..","..","..","..","..","..","..","..",".."],dddd:["","","","","","",""],ddd:[".",".",".",".",".",".","."]},"th"),u({decimal:",",ampm:["dop.","odp."],mmmm:["ledna","nora","bezna","dubna","kvtna","ervna","ervence","srpna","z","jna","listopadu","prosince"],mmm:["led","no","be","dub","kv","vn","vc","srp","z","j","lis","pro"],dddd:["nedle","pondl","ter","steda","tvrtek","ptek","sobota"],ddd:["ne","po","t","st","t","p","so"]},"cs"),u({group:".",decimal:",",mmmm:["januar","februar","marts","april","maj","juni","juli","august","september","oktober","november","december"],mmm:["jan.","feb.","mar.","apr.","maj","jun.","jul.","aug.","sep.","okt.","nov.","dec."],dddd:["sndag","mandag","tirsdag","onsdag","torsdag","fredag","lrdag"],ddd:["sn.","man.","tir.","ons.","tor.","fre.","lr."]},"da"),u({group:".",decimal:",",ampm:["a.m.","p.m."],mmmm:["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december"],mmm:["jan.","feb.","mrt.","apr.","mei","jun.","jul.","aug.","sep.","okt.","nov.","dec."],dddd:["zondag","maandag","dinsdag","woensdag","donderdag","vrijdag","zaterdag"],ddd:["zo","ma","di","wo","do","vr","za"]},"nl"),u({group:","},"en"),u({decimal:",",nan:"epluku",ampm:["ap.","ip."],mmmm:["tammikuuta","helmikuuta","maaliskuuta","huhtikuuta","toukokuuta","keskuuta","heinkuuta","elokuuta","syyskuuta","lokakuuta","marraskuuta","joulukuuta"],mmm:["tammik.","helmik.","maalisk.","huhtik.","toukok.","kesk.","heink.","elok.","syysk.","lokak.","marrask.","jouluk."],dddd:["sunnuntaina","maanantaina","tiistaina","keskiviikkona","torstaina","perjantaina","lauantaina"],ddd:["su","ma","ti","ke","to","pe","la"]},"fi"),u({group:"",decimal:",",mmmm:["janvier","fvrier","mars","avril","mai","juin","juillet","aot","septembre","octobre","novembre","dcembre"],mmm:["janv.","fvr.","mars","avr.","mai","juin","juil.","aot","sept.","oct.","nov.","dc."],dddd:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],ddd:["dim.","lun.","mar.","mer.","jeu.","ven.","sam."]},"fr"),u({group:".",decimal:",",mmmm:["Januar","Februar","Mrz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],mmm:["Jan.","Feb.","Mrz","Apr.","Mai","Juni","Juli","Aug.","Sept.","Okt.","Nov.","Dez."],dddd:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],ddd:["So.","Mo.","Di.","Mi.","Do.","Fr.","Sa."]},"de"),u({group:".",decimal:",",ampm:["..",".."],mmmm:["","","","","","","","","","","",""],mmm:["","","","","","","","","","","",""],dddd:["","","","","","",""],ddd:["","","","","","",""]},"el"),u({decimal:",",ampm:["de.","du."],mmmm:["janur","februr","mrcius","prilis","mjus","jnius","jlius","augusztus","szeptember","oktber","november","december"],mmm:["jan.","febr.","mrc.","pr.","mj.","jn.","jl.","aug.","szept.","okt.","nov.","dec."],dddd:["vasrnap","htf","kedd","szerda","cstrtk","pntek","szombat"],ddd:["V","H","K","Sze","Cs","P","Szo"]},"hu"),u({group:".",decimal:",",ampm:["f.h.","e.h."],mmmm:["janar","febrar","mars","aprl","ma","jn","jl","gst","september","oktber","nvember","desember"],mmm:["jan.","feb.","mar.","apr.","ma","jn.","jl.","g.","sep.","okt.","nv.","des."],dddd:["sunnudagur","mnudagur","rijudagur","mivikudagur","fimmtudagur","fstudagur","laugardagur"],ddd:["sun.","mn.","ri.","mi.","fim.","fs.","lau."]},"is"),u({group:".",decimal:",",mmmm:["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],mmm:["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agu","Sep","Okt","Nov","Des"],dddd:["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"],ddd:["Min","Sen","Sel","Rab","Kam","Jum","Sab"]},"id"),u({group:".",decimal:",",mmmm:["gennaio","febbraio","marzo","aprile","maggio","giugno","luglio","agosto","settembre","ottobre","novembre","dicembre"],mmm:["gen","feb","mar","apr","mag","giu","lug","ago","set","ott","nov","dic"],dddd:["domenica","luned","marted","mercoled","gioved","venerd","sabato"],ddd:["dom","lun","mar","mer","gio","ven","sab"]},"it"),u({decimal:",",ampm:["a.m.","p.m."],mmmm:["januar","februar","mars","april","mai","juni","juli","august","september","oktober","november","desember"],mmm:["jan.","feb.","mar.","apr.","mai","jun.","jul.","aug.","sep.","okt.","nov.","des."],dddd:["sndag","mandag","tirsdag","onsdag","torsdag","fredag","lrdag"],ddd:["sn.","man.","tir.","ons.","tor.","fre.","lr."]},"nb"),u({decimal:",",mmmm:["stycznia","lutego","marca","kwietnia","maja","czerwca","lipca","sierpnia","wrzenia","padziernika","listopada","grudnia"],mmm:["sty","lut","mar","kwi","maj","cze","lip","sie","wrz","pa","lis","gru"],dddd:["niedziela","poniedziaek","wtorek","roda","czwartek","pitek","sobota"],ddd:["niedz.","pon.","wt.","r.","czw.","pt.","sob."]},"pl"),u({group:".",decimal:",",mmmm:["janeiro","fevereiro","maro","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"],mmm:["jan.","fev.","mar.","abr.","mai.","jun.","jul.","ago.","set.","out.","nov.","dez."],dddd:["domingo","segunda-feira","tera-feira","quarta-feira","quinta-feira","sexta-feira","sbado"],ddd:["dom.","seg.","ter.","qua.","qui.","sex.","sb."]},"pt"),u({decimal:",",nan:"",mmmm:["","","","","","","","","","","",""],mmm:[".",".",".",".","",".",".",".",".",".",".","."],dddd:["","","","","","",""],ddd:["","","","","","",""]},"ru"),u({decimal:",",mmmm:["janura","februra","marca","aprla","mja","jna","jla","augusta","septembra","oktbra","novembra","decembra"],mmm:["jan","feb","mar","apr","mj","jn","jl","aug","sep","okt","nov","dec"],dddd:["nedea","pondelok","utorok","streda","tvrtok","piatok","sobota"],ddd:["ne","po","ut","st","t","pi","so"]},"sk"),u({group:".",decimal:",",ampm:["a.m.","p.m."],mmmm:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],mmm:["ene.","feb.","mar.","abr.","may.","jun.","jul.","ago.","sept.","oct.","nov.","dic."],dddd:["domingo","lunes","martes","mircoles","jueves","viernes","sbado"],ddd:["dom.","lun.","mar.","mi.","jue.","vie.","sb."]},"es"),u({decimal:",",ampm:["fm","em"],mmmm:["januari","februari","mars","april","maj","juni","juli","augusti","september","oktober","november","december"],mmm:["jan.","feb.","mars","apr.","maj","juni","juli","aug.","sep.","okt.","nov.","dec."],dddd:["sndag","mndag","tisdag","onsdag","torsdag","fredag","lrdag"],ddd:["sn","mn","tis","ons","tors","fre","lr"]},"sv"),u({group:".",decimal:",",ampm:["","S"],mmmm:["Ocak","ubat","Mart","Nisan","Mays","Haziran","Temmuz","Austos","Eyll","Ekim","Kasm","Aralk"],mmm:["Oca","ub","Mar","Nis","May","Haz","Tem","Au","Eyl","Eki","Kas","Ara"],dddd:["Pazar","Pazartesi","Sal","aramba","Perembe","Cuma","Cumartesi"],ddd:["Paz","Pzt","Sal","ar","Per","Cum","Cmt"]},"tr");const p={overflow:"######",dateErrorThrows:!1,dateErrorNumber:!0,dateSpanLarge:!0,leap1900:!0,nbsp:!0,throws:!0,invalid:"######",locale:"",ignoreTimezone:!1},v=Object.assign({},p);function y(t){if(null===t&&(t=p),t)for(const e in t)if(e in p){const n=t[e];v[e]=null==n?p[e]:n}return{...v}}const b=16,g=32,m=64,w={"#":"",0:"0","?":""},L={"@":"text","-":"minus","+":"plus"},O=["#000","#FFF","#F00","#0F0","#00F","#FF0","#F0F","#0FF","#000","#FFF","#F00","#0F0","#00F","#FF0","#F0F","#0FF","#800","#080","#008","#880","#808","#088","#CCC","#888","#99F","#936","#FFC","#CFF","#606","#F88","#06C","#CCF","#008","#F0F","#FF0","#0FF","#808","#800","#088","#00F","#0CF","#CFF","#CFC","#FF9","#9CF","#F9C","#C9F","#FC9","#36F","#3CC","#9C0","#FC0"],k=["","$","","","","","","","","","","","","","","","","","","","","","","","","",""],j=new RegExp("["+k.join("")+"]");function x(t,e,n){return e[n+"_max"]=t.length,e[n+"_min"]=t.replace(/#/g,"").length,e}const _={};function S(t){if(!(t in _)){const e=[],n=t.replace(/^[#,]+/,"").replace(/[1-9]\d*/g,t=>"?".repeat(t.length));for(let t=0;t<n.length;t++){const r=n.charAt(t);e[t]=r in w?w[r]:r}_[t]=e.join("")}return _[t]}function C(t,e){"string"==typeof t&&(t={type:"string",value:t=t.replace(/ /g,w["?"])}),e.push(t)}function E(t){const e=[],n={scale:1,percent:!1,text:!1,date:0,date_eval:!1,date_system:1,sec_decimals:0,general:!1,clock:24,int_pattern:[],frac_pattern:[],man_pattern:[],den_pattern:[],num_pattern:[],tokens:e};let r=t+"",i="int",o=!1,a=null;const s=[];let c,u,f=!1;for(;r&&!o;){if(c=/^General/i.exec(r))n.general=!0,C({type:"general"},e);else if("int"===i&&(c=/^[#?0]+(?:,[#?0]+)*/.exec(r))||"den"===i&&(c=/^[#?\d]+/.exec(r))||(c=/^[#?0]+/.exec(r)))n[i+"_pattern"].push(c[0]),C(a={type:i,num:c[0]},e);else if((c=/^\//.exec(r))&&n[i+"_pattern"].length){if(!a)throw new SyntaxError("Missing a numerator in pattern ".concat(t));n.fractions=!0,n.num_pattern.push(n[i+"_pattern"].pop()),a.type="num",i="den",C({type:"div"},e)}else if(c=/^,+/.exec(r)){const t=r.charAt(1)in w;u.slice(-1)in w&&(c[0].length>1||!t)?n.scale=.001**c[0].length:n.dec_fractions||C(c[0],e)}else{if(c=/^;/.exec(r)){o=!0;break}if(c=/^[@+-]/.exec(r))"@"===c[0]&&(n.text=!0),C({type:L[c[0]]},e);else if(c=/^(?:\[(h+|m+|s+)\])/i.exec(r)){const t=c[1].toLowerCase(),r=t[0],i={type:"",size:0,date:1,raw:c[0],pad:t.length};"h"===r?(i.size=b,i.type="hour-elap"):"m"===r?(i.size=g,i.type="min-elap"):(i.size=m,i.type="sec-elap"),n.date=n.date|i.size,s.push(i),C(i,e)}else if(c=/^(?:B2)/i.exec(r))f||(n.date_system=6);else if(c=/^(?:B1)/i.exec(r))f||(n.date_system=1);else if(c=/^(?:([hHmMsSyYbBdDegG])\1*)/.exec(r)){const t={type:"",size:0,date:1,raw:c[0]},r=c[0].toLowerCase(),i=r[0];if("y"===r||"yy"===r)t.size=2,t.type="year-short";else if("y"===i||"e"===i)t.size=2,t.type="year";else if("b"===r||"bb"===r)t.size=2,t.type="b-year-short";else if("b"===i)t.size=2,t.type="b-year";else if("d"===r||"dd"===r)t.size=8,t.type="day",t.pad=/dd/.test(r);else if("ddd"===r)t.size=8,t.type="weekday-short";else if("d"===i)t.size=8,t.type="weekday";else if("h"===i)t.size=b,t.type="hour",t.pad=/hh/i.test(r);else if("m"===i){3===r.length?(t.size=4,t.type="monthname-short"):5===r.length?(t.size=4,t.type="monthname-single"):r.length>=4&&(t.size=4,t.type="monthname");const e=s[s.length-1];!t.type&&e&&!e.used&&80&e.size&&(e.used=!0,t.size=g,t.type="min",t.pad=/mm/.test(r)),t.type||(t.size=4,t.type="month",t.pad=/mm/.test(r),t.indeterminate=!0)}else if("s"===i){t.size=m,t.type="sec",t.pad=/ss/.test(r);const e=s[s.length-1];e&&e.size&g?t.used=!0:e&&e.indeterminate&&(delete e.indeterminate,e.size=g,e.type="min",t.used=!0)}n.date=n.date|t.size,n.date_eval=!0,s.push(t),C(t,e)}else if(c=/^(?:AM\/PM|am\/pm|A\/P)/.exec(r))n.clock=12,n.date=n.date|b,n.date_eval=!0,C({type:"am",short:"A/P"===c[0]},e);else if(n.date&&(c=/^\.0{1,3}/i.exec(r))){const t=c[0].length-1,r=[m,128,256,512][t];n.date=n.date|r,n.date_eval=!0,n.sec_decimals=Math.max(n.sec_decimals,t),C({type:"subsec",size:r,decimals:t,date:1,raw:c[0]},e)}else if((c=/^\\(.)/.exec(r))||(c=/^"([^"]*?)"/.exec(r)))C(c[1],e);else if(c=/^\[(<[=>]?|>=?|=)\s*(-?[.\d]+)\]/.exec(r))n.condition=[c[1],parseFloat(c[2],10)];else if(c=/^\[\$([^\]]+)\]/.exec(r)){const t=c[1].split("-"),r=t.length<2?"":t[t.length-1],i=t[0];i&&C(i,e);const o=l(r);o&&(n.locale=o);const a=parseInt(r,16);isFinite(a)&&16711680&a&&6==(a>>16&255)&&(n.date_system=6),f=!0}else if(c=/^\[(black|blue|cyan|green|magenta|red|white|yellow|color\s*(\d+))\]/i.exec(r))n.color=c[2]?O[parseInt(c[2],10)]||"#000":c[1].toLowerCase();else if(c=/^\[(DBNum1|ENG|HIJ|JPN|TWN)\]/i.exec(r));else if(c=/^%/.exec(r))n.scale=100,n.percent=!0,C("%",e);else if(c=/^_(\\.|.)/.exec(r))C(" ",e);else if(c=/^\./.exec(r))C({type:"point",value:c[0]},e),n.dec_fractions=!0,i="frac";else if(c=/^[Ee]([+-]?|(?=[0#?]))/.exec(r))n.exponential=!0,n.exp_plus="+"===c[1],i="man",C({type:"exp",plus:"+"===c[1]},e);else if(c=/^\*(\\.|.)/.exec(r));else{if(c=/^[BENn[]/.exec(r))throw new SyntaxError("Unexpected char ".concat(r.charAt(0)," in pattern ").concat(t));"("===r[0]&&(n.parens=!0),C((c=[r[0]])[0],e)}}u=c[0],r=r.slice(c?c[0].length:1)}if(n.pattern=t.slice(0,t.length-r.length),/^((?:\[[^\]]+\])+)(;|$)/.test(n.pattern)&&!/^\[(?:h+|m+|s+)\]/.test(n.pattern)&&C({type:"text"},e),n.fractions&&n.dec_fractions||n.fractions&&n.exponential)throw new SyntaxError("Invalid pattern: ".concat(n.pattern));const h=n.int_pattern.join("");if(n.grouping=h.indexOf(",")>=0,n.grouping){const t=h.split(","),e=t.length;2===e?(n.group_pri=t[1].length,n.group_sec=n.group_pri):e>2&&(n.group_pri=t[e-1].length,n.group_sec=t[e-2].length)}else n.group_pri=0,n.group_sec=0;x(h.replace(/[,]/g,""),n,"int"),x(n.frac_pattern.join(""),n,"frac"),x(n.man_pattern.join(""),n,"man");let d=n.num_pattern.join(""),p=n.den_pattern.join("");const v=/\?/.test(p)||/\?/.test(d);return p=p.replace(/\d/g,v?"?":"#"),v&&(p=p.replace(/#$/g,"?")),x(d,n,"num"),x(p,n,"den"),v&&(d=d.replace(/#$/g,"?")),n.int_padding=S(n.int_pattern.join("")),n.man_padding=S(n.man_pattern.join("")),n.num_padding=S(d),n.den_padding=S(p),n.den_pattern.length&&(n.denominator=parseInt(n.den_pattern.join("").replace(/\D/g,""),10)),n.integer=!!n.int_pattern.join("").length,n.fractions&&e.forEach((t,n)=>{const r=e[n+1];"string"===t.type&&r&&("num"===r.type?t.rule="num+int":"div"===r.type?t.rule="num":"den"===r.type&&(t.rule="den"))}),n}const M=t=>{const e=t.condition;e&&e[1]<0&&("<"===e[0]||"<="===e[0]||"="===e[0])||t.tokens.unshift({type:"minus",volatile:!0})};function T(t){const e=[];let n,r=!1,i=null,o=t,a=0,s=!1,c=0,u=0;do{if(((s=E(o)).date||s.general)&&(s.int_pattern.length||s.frac_pattern.length||1!==s.scale||s.text))throw new Error("Illegal format");if(s.condition&&(u++,r=!0),s.text){if(i)throw new Error("Unexpected partition");i=s}s.locale&&(n=l(s.locale)),e.push(s),a=";"===o.charAt(s.pattern.length)?1:0,o=o.slice(s.pattern.length+a),c++}while(a&&c<4&&u<3);if(a)throw new Error("Unexpected partition");if(u>2)throw new Error("Unexpected condition");const f=e[3];if(f&&(f.int_pattern.length||f.frac_pattern.length||f.date))throw new Error("Unexpected partition");if(r){const t=e.length;if(1===t&&(e[1]=E("General"),e[1].generated=!0),t<3){const t=e[0],n=e[1];if(M(t),n.condition)M(n);else{const e=t.condition;("="===e[0]||e[1]>=0&&(">"===e[0]||">="===e[0]))&&n.tokens.unshift({type:"minus",volatile:!0})}}else e.forEach(M)}else{if(e.length<4&&i)for(let t=0,n=e.length;t<n;t++)e[t]===i&&e.splice(t,1);if(e.length<1&&i&&(e[0]=E("General"),e[0].generated=!0),e.length<2){const t=E(e[0].pattern);t.tokens.unshift({type:"minus",volatile:!0}),t.generated=!0,e.push(t)}if(e.length<3){const t=E(e[0].pattern);t.generated=!0,e.push(t)}if(e.length<4)if(i)e.push(i);else{const t=E("@");t.generated=!0,e.push(t)}e[0].condition=[">",0],e[1].condition=["<",0],e[2].condition=null}return{pattern:t,partitions:e,locale:n}}const P=Math.floor;function A(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e&&t>=0){if(0===t)return[1900,1,0];if(60===t)return[1900,2,29];if(t<60)return[1900,t<32?1:2,(t-1)%31+1]}let n=t+68569+2415019;const r=P(4*n/146097);n-=P((146097*r+3)/4);const i=P(4e3*(n+1)/1461001);n=n-P(1461*i/4)+31;const o=P(80*n/2447),a=n-P(2447*o/80);n=P(o/11);const l=o+2-12*n,s=100*(r-49)+i+n;return[0|s,0|l,0|a]}function Z(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=P(t);return 6===e?function(t){if(60===t)throw new Error("#VALUE!");if(t<=1)return[1317,8,29];if(t<60)return[1317,t<32?9:10,1+(t-2)%30];const e=10631/30;let n=t+466935;const r=P(n/10631),i=P(((n-=10631*r)-.1335)/e);n-=P(i*e+.1335);const o=P((n+28.5001)/29.5);return 13===o?[30*r+i,12,30]:[30*r+i,o,n-P(29.5001*o-29)]}(r):-1===e?function(t){return A(t+1462)}(r):A(r,n)}const D=Math.floor,z=86400;function R(t,e){let n=null;if(Array.isArray(t)){const[e,r,i,o,a,l]=t;n=Date.UTC(e,null==r?0:r-1,null!=i?i:1,o||0,a||0,l||0)}else if(t instanceof Date&&(n=1*t,!e||!e.ignoreTimezone)){const e=new Date;e.setUTCFullYear(t.getFullYear(),t.getMonth(),t.getDate()),e.setUTCHours(t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()),n=1*e}if(null!=n&&isFinite(n)){const t=n/864e5;return t-(t<=-25509?-25568:-25569)}return t}function F(t,e){let n=0|t;const r=z*(t-n);let i=D(r);r-i>.9999&&(i+=1)===z&&(i=0,n+=1);const o=i<0?z+i:i,[a,l,s]=Z(t,0,e&&e.leap1900),c=D(o/60/60)%60,u=D(o/60)%60,f=D(o)%60;if(e&&e.nativeDate){const t=new Date(0);return t.setUTCFullYear(a,l-1,s),t.setUTCHours(c,u,f),t}return[a,l,s,c,u,f]}function I(t){return!!(t[0]&&t[0].percent||t[1]&&t[1].percent||t[2]&&t[2].percent||t[3]&&t[3].percent)}function N(t){return!!(t[0]&&t[0].date||t[1]&&t[1].date||t[2]&&t[2].date||t[3]&&t[3].date)}function H(t){const[e,n,r,i]=t;return!(e&&!e.generated||n&&!n.generated||r&&!r.generated||!i||!i.text||i.generated)}const V={text:15,datetime:10.8,date:10.8,time:10.8,percent:10.6,currency:10.4,grouped:10.2,scientific:6,number:4,fraction:2,general:0,error:0},W=[["DMY",1],["DM",2],["MY",3],["MDY",4],["MD",5],["hmsa",6],["hma",7],["hms",8],["hm",9]],Y={total:1,sign:0,period:0,int:1,frac:0},B=(t,e)=>t.replace(/\./,e.decimal);function q(t,e,n,r){const i=0|n;if("string"==typeof n)t.push(n);else if(n===i)t.push(Math.abs(i));else{let e=0;const i=Math.abs(n);i&&(e=Math.floor(Math.log10(i)));let o=e<0?i*10**-e:i/10**e;10===o&&(o=1,e++);const a=function(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=Math.abs(t);if(!n)return Y;const r=e&&t<0?1:0,i=Math.floor(n),o=Math.floor(Math.log10(n)+1);let a=0,l=0;if(i!==n){a=1;const t=String(h(o<0?n*10**-o:n/10**o,15));let e=t.length,r=!0,i=0;for(;i<=t.length;){if("."===t[i]){e--;break}"0"===t[i]&&r?e--:r=!1,i++}(l=e-o)<0&&(l=0,a=0)}return{total:r+Math.max(o,1)+a+l,digits:Math.max(o,0)+l,sign:r,period:a,int:Math.max(o,1),frac:l}}(i),l=()=>{const n=Math.abs(e);let i;i=1===o?o:h(o,5),t.push(B(i+"",r),r.exponent,e<0?r.negative:r.positive,n<10?"0":"",n)};if(e>=-4&&e<=-1){const n=i.toPrecision(10+e).replace(/0+$/,"");t.push(B(n,r))}else if(10===e){const e=i.toFixed(10).slice(0,12).replace(/\.$/,"");t.push(B(e,r))}else if(Math.abs(e)<=9){const n=11;if(a.total<=n){const e=h(i,9).toFixed(a.frac);t.push(B(e,r))}else 9===e?t.push(Math.floor(i)):e>=0&&e<9?t.push(h(i,9-e)):l()}else a.total>=12?l():Math.floor(i)===i?t.push(Math.floor(i)):t.push(B(h(i,9).toFixed(a.frac),r))}return t}const U=86400,$={int:"integer",frac:"fraction",man:"mantissa",num:"numerator",den:"denominator"},J=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=Math.floor(Math.log10(t));return e>1?Math.floor(n/e)*e:n};function G(t,e,n,r){let i="",o="",a="",l="",s="",c=0,u=0|t,p=0,v=0,y=1,L=0,O=0,k=0,j=0,x=0,_=0;const S=r||f;if(!e.text&&isFinite(e.scale)&&1!==e.scale&&(t=function(t){if(0===t)return t;const e=Math.ceil(Math.log10(t<0?-t:t)),n=10**(16-Math.floor(e));return Math.round(t*n)/n}(t*e.scale)),e.exponential){let n=Math.abs(t);if(n){const t=10**-J(n,e.int_max),r=h(n*t,e.frac_max)/t;c=J(r,e.int_max)}n/=10**c,t=t<0?-n:n,i+=Math.abs(c)}if(e.integer){const n=Math.abs(h(t,e.fractions?1:e.frac_max));s+=n<1?"":Math.floor(n)}if(e.grouping){let t="",n=s.length;for(n>e.group_pri&&(n-=e.group_pri,t=S.group+s.slice(n,n+e.group_pri)+t);n>e.group_sec;)n-=e.group_sec,t=S.group+s.slice(n,n+e.group_sec)+t;s=n?s.slice(0,n)+t:t}e.dec_fractions&&(l=String(h(t,e.frac_max)).split(".")[1]||"");let C=!1;if(e.fractions){const n=Math.abs(e.integer?t%1:t);if(n)if(C=!0,isFinite(e.denominator))a+=e.denominator,"0"===(o+=h(n*e.denominator))&&(o="",a="",C=!1,s||(s="0"));else{const t=d(n,e.integer?e.num_max:1/0,e.den_max);o+=t[0],a+=t[1],e.integer&&"0"===o&&(s||(s="0"),o="",a="",C=!1)}}if(e.date_eval&&((t,e)=>e?t<-694324||t>=35830291:t<0||t>=2958466)(t,n.dateSpanLarge)){if(n.dateErrorThrows)throw new Error("Date out of bounds");return n.dateErrorNumber?q(t<0?[S.negative]:[],0,t,S).join(""):n.overflow}if(e.date){const r=U*(t-(u=0|t));if(p=Math.floor(r),_=r-p,Math.abs(_)<1e-6?_=0:_>.9999&&(_=0,(p+=1)===U&&(p=0,u+=1)),u||e.date_system){const r=Z(t,e.date_system,n.leap1900);v=r[0],y=r[1],L=r[2]}if(p||_){const t=512&e.date||256&e.date||128&e.date||e.date&m||e.date&g||e.date&b;(512===t&&_>.9995||256===t&&_>.995||128===t&&_>.95||t===m&&_>=.5||t===g&&_>=.5||t===b&&_>=.5)&&(p++,_=0);const n=p<0?U+p:p;x=Math.floor(n)%60,j=Math.floor(n/60)%60,k=Math.floor(n/60/60)%60}O=(6+u)%7}if(e.int_padding&&(s=1===e.int_padding.length?s||e.int_padding:e.int_padding.substring(0,e.int_padding.length-s.length)+s),e.num_padding&&(o=1===e.num_padding.length?o||e.num_padding:e.num_padding.substring(0,e.num_padding.length-o.length)+o),e.den_padding&&(a=1===e.den_padding.length?a||e.den_padding:a+e.den_padding.slice(a.length)),e.man_padding){const t=e.exp_plus?"+":"";i=1===e.man_padding.length?(c<0?"-":t)+(i||e.man_padding):(c<0?"-":t)+e.man_padding.slice(0,e.man_padding.length-i.length)+i}const E=[];let M=0;const T={int:0,frac:0,man:0,num:0,den:0};for(let c=0,f=e.tokens.length;c<f;c++){const f=e.tokens[c],h=f.num?f.num.length:0;if("string"===f.type)f.rule?"num"===f.rule?C?E.push(f.value):(e.num_min>0||e.den_min>0)&&E.push(f.value.replace(/./g,w["?"])):"num+int"===f.rule?C&&s?E.push(f.value):e.den_min>0&&(s||e.num_min)&&E.push(f.value.replace(/./g,w["?"])):"den"===f.rule&&(C?E.push(f.value):(e.den_min>0||e.den_min>0)&&E.push(f.value.replace(/./g,w["?"]))):E.push(f.value);else if("error"===f.type)E.push(n.invalid);else if("point"===f.type)E.push(e.date?f.value:S.decimal);else if("general"===f.type)q(E,0,t,S);else if("exp"===f.type)E.push(S.exponent);else if("minus"===f.type)f.volatile&&e.date||f.volatile&&(t>=0||"number"!=typeof t)||(f.volatile&&!e.fractions&&(e.integer||e.dec_fractions)?(t<0&&s&&"0"!==s||l)&&E.push(S.negative):E.push(S.negative));else if("plus"===f.type)E.push(S.positive);else if("text"===f.type)E.push(t);else if("div"===f.type)C?E.push("/"):e.num_min>0||e.den_min>0?E.push(w["?"]):E.push(w["#"]);else if("int"===f.type)if(1===e.int_pattern.length)E.push(s);else{const t=M?e.int_pattern.join("").length-T.int:1/0,n=M===e.int_pattern.length-1?0:e.int_pattern.join("").length-(T.int+f.num.length);E.push(s.substring(s.length-t,s.length-n)),M++,T.int+=f.num.length}else if("frac"===f.type){const t=T.frac;for(let e=0;e<h;e++)E.push(l[e+t]||w[f.num[e]]);T.frac+=h}else if(f.type in $)1===e[f.type+"_pattern"].length?("int"===f.type&&E.push(s),"frac"===f.type&&E.push(l),"man"===f.type&&E.push(i),"num"===f.type&&E.push(o),"den"===f.type&&E.push(a)):(E.push($[f.type].slice(T[f.type],T[f.type]+h)),T[f.type]+=h);else if("year"===f.type)v<0&&E.push(S.negative),E.push(String(Math.abs(v)).padStart(4,"0"));else if("year-short"===f.type){const t=v%100;E.push(t<10?"0":"",t)}else if("month"===f.type)E.push(f.pad&&y<10?"0":"",y);else if("monthname-single"===f.type)6===e.date_system?E.push(S.mmmm6[y-1].charAt(0)):E.push(S.mmmm[y-1].charAt(0));else if("monthname-short"===f.type)6===e.date_system?E.push(S.mmm6[y-1]):E.push(S.mmm[y-1]);else if("monthname"===f.type)6===e.date_system?E.push(S.mmmm6[y-1]):E.push(S.mmmm[y-1]);else if("weekday-short"===f.type)E.push(S.ddd[O]);else if("weekday"===f.type)E.push(S.dddd[O]);else if("day"===f.type)E.push(f.pad&&L<10?"0":"",L);else if("hour"===f.type){const t=k%e.clock||(e.clock<24?e.clock:0);E.push(f.pad&&t<10?"0":"",t)}else if("min"===f.type)E.push(f.pad&&j<10?"0":"",j);else if("sec"===f.type)E.push(f.pad&&x<10?"0":"",x);else if("subsec"===f.type){E.push(S.decimal);const t=_.toFixed(e.sec_decimals);E.push(t.slice(2,2+f.decimals))}else if("am"===f.type){const t=k<12?0:1;f.short&&!r?E.push("AP"[t]):E.push(S.ampm[t])}else if("hour-elap"===f.type){t<0&&E.push(S.negative);const e=24*u+Math.floor(Math.abs(p)/3600);E.push(String(Math.abs(e)).padStart(f.pad,"0"))}else if("min-elap"===f.type){t<0&&E.push(S.negative);const e=1440*u+Math.floor(Math.abs(p)/60);E.push(String(Math.abs(e)).padStart(f.pad,"0"))}else if("sec-elap"===f.type){t<0&&E.push(S.negative);const e=u*U+Math.abs(p);E.push(String(Math.abs(e)).padStart(f.pad,"0"))}else if("b-year"===f.type)E.push(v+543);else if("b-year-short"===f.type){const t=(v+543)%100;E.push(t<10?"0":"",t)}}return n.nbsp?E.join(""):E.join("").replace(/\u00a0/g," ")}function X(t,e){for(let n=0;n<3;n++){const r=e[n];if(r){let e;if(r.condition){const n=r.condition[0],i=r.condition[1];"="===n?e=t===i:">"===n?e=t>i:"<"===n?e=t<i:">="===n?e=t>=i:"<="===n?e=t<=i:"<>"===n&&(e=t!==i)}else e=!0;if(e)return r}}}const K=E("@"),Q="black",tt={};function et(t,e){if(t){const n=t[0];e[n]=e[n]||{},et(t.slice(1),e[n])}else e.$=!0}["d-F-y","d-F-Y","d-M-y","d-M-Y","F-d-y","F-d-Y","F-j-y","F-j-Y","j-F-y","j-F-Y","j-M-y","j-M-Y","M-d-y","M-d-Y","M-j-y","M-j-Y","m-d-y","m-d-Y","m-j-y","m-j-Y","n-d-y","n-d-Y","n-j-y","n-j-Y","y-F-d","y-F-j","y-M-d","y-M-j","Y-F-d","Y-F-j","Y-M-d","Y-m-d","Y-M-j","Y-m-j","Y-n-d","Y-n-j","j-F","j-M","d-F","d-M","n-d","n-j","n-Y","m-d","m-j","m-Y","M-Y","M-y","F-y","F-Y","Y-M","Y-n","Y-m","Y-F","Y-M"].forEach(t=>{et(t,tt),et(t+" x",tt),et(t+" l",tt),et(t+" l x",tt),et("l "+t,tt),et("l "+t+" x",tt),et(t+" D",tt),et(t+" D x",tt),et("D "+t,tt),et("D "+t+" x",tt)});const nt={jan:1,feb:2,mar:3,apr:4,may:5,jun:6,jul:7,aug:8,sep:9,oct:10,nov:11,dec:12},rt={january:1,february:2,march:3,april:4,june:6,july:7,august:8,september:9,october:10,november:11,december:12},it={sunday:"l",monday:"l",tuesday:"l",wednesday:"l",thursday:"l",friday:"l",saturday:"l",sun:"D",mon:"D",tue:"D",wed:"D",thu:"D",fri:"D",sat:"D"},ot=(new Date).getUTCFullYear();function at(t){const e=new RegExp("^([\\s+%"+k.join("")+"(-]*)(((?:(?:\\d[\\d,]*)(?:\\.\\d*)?|(?:\\.\\d+)))([eE][+-]?\\d+)?)([\\s%"+k.join("")+")]*)$").exec(t);if(e){const[,t,n,r,i,o]=e;let a=1,l="",s=!1,c=!1,u=!1,f=!1,h=!1,d=null,p=!1,v=parseFloat(n.replace(/,/g,""));if(!isFinite(v))return null;for(let e=0;e<t.length;e++){const n=t[e];if("-"===n){if(s||c)return null;s=!0,a=-1}else if(j.test(n)){if(h)return null;h=!0,d=n}else if("("===n){if(c||s)return null;c=!0,a=-1}else if("%"===n){if(f)return null;f=!0}}for(let t=0;t<o.length;t++){const e=o[t];if(j.test(e)){if(h)return null;h=!0,d=e,p=!0}else if(")"===e){if(u||!c)return null;u=!0}else if("%"===e){if(f)return null;f=!0}}if(i){if(f||h)return null;l="0.00E+00"}else if(f){if(h)return null;l=r.includes(".")?"0.00%":"0%",v*=.01}else if(h){const t=r.includes(".")?"#,##0.00":"#,##0";l=p?t+d:d+t}else r.includes(",")&&(l=r.includes(".")?"#,##0.00":"#,##0");const y={v:v*a};return l&&(y.z=l),y}}const lt=(t,e,n)=>{const r=n.path||"",i=Object.keys(e);for(let o=0;o<i.length;o++){let a;const l=i[o];if(e[l]){if("$"===l||""===l)t||(a=n);else if("-"===l){const i=/^(\s*([./-]|,\s)\s*|\s+)/.exec(t);if(i){const o="-"===i[1]||"/"===i[1]||"."===i[1]?i[1]:" ";if(!n.sep||n.sep===o){const s=i[0].replace(/\s+/g," ");a=lt(t.slice(i[0].length),e[l],{...n,sep:o,path:r+s})}}}else if(" "===l){const i=/^[,.]?\s+/.exec(t);if(i){const o=i[0].replace(/\s+/g," ");a=lt(t.slice(i[0].length),e[l],{...n,path:r+o})}}else if("j"===l||"d"===l){const i=/^(0?[1-9]|1\d|2\d|3[01])\b/.exec(t);i&&(a=lt(t.slice(i[0].length),e[l],{...n,day:i[0],path:r+l}))}else if("n"===l||"m"===l){const i=/^(0?[1-9]|1[012])\b/.exec(t);i&&(a=lt(t.slice(i[0].length),e[l],{...n,month:+i[0],_mon:i[0],path:r+l}))}else if("F"===l||"M"===l){const i=/^([a-z]{3,9})\b/i.exec(t),o=i&&("F"===l?rt:nt)[i[0].toLowerCase()];o&&(a=lt(t.slice(i[0].length),e[l],{...n,month:o,_mon:i[0],path:r+l}))}else if("l"===l||"D"===l){const i=/^([a-z]{3,9})\b/i.exec(t);(i&&it[i[0].toLowerCase()])===l&&(a=lt(t.slice(i[0].length),e[l],{...n,path:r+l}))}else if("y"===l){const i=/^\d\d\b/.exec(t);if(i){const o=+i[0]>=30?+i[0]+1900:+i[0]+2e3;a=lt(t.slice(i[0].length),e[l],{...n,year:o,path:r+l})}}else if("Y"===l){const i=/^\d\d\d\d\b/.exec(t);i&&(a=lt(t.slice(i[0].length),e[l],{...n,year:+i[0],path:r+l}))}else{if("x"!==l)throw new Error('Unknown date token "'.concat(l,'"'));{const i=ct(t);i&&(a=lt("",e[l],{...n,time:i.v,tf:i.z,path:r+l}))}}if(a)return a}}};function st(t,e){const n=lt(t.trim(),tt,{path:""});if(n){var r;if("."===n.sep&&3===n.path.length)return null;const t=+(null!==(r=n.year)&&void 0!==r?r:ot);if(n.day||(n.day=1),!function(t,e,n){if(n<1)return!1;if(e<1||e>12)return!1;if(2===e){if(n>(t%4==0&&t%100!=0||t%400==0||1900===t?29:28))return!1}else if((4===e||6===e||9===e||11===e)&&n>30||(1===e||3===e||5===e||7===e||8===e||10===e||12===e)&&n>31)return!1;return!0}(t,n.month,n.day))return null;let i=-1/0;if(t<1900)return null;t<=1900&&n.month<=2?i=25568:t<1e4&&(i=25569);const o=Date.UTC(t,n.month-1,n.day)/864e5+i+(n.time||0);if(o>=0&&o<=2958465){const t="0"===n._mon[0]||"0"===n.day[0]||2===n._mon.length&&2===n.day.length,r=n.path.replace(/[jdlDnmMFyYx-]/g,e=>"j"===e||"d"===e?t?"dd":"d":"D"===e?"ddd":"l"===e?"dddd":"n"===e||"m"===e?t?"mm":"m":"M"===e?"mmm":"F"===e?"mmmm":"y"===e?"yy":"x"===e?n.tf||"":"Y"===e?"yyyy":e);return e&&e.nativeDate?{v:F(o,e),z:r}:{v:o,z:r}}}return null}function ct(t){const e=/^\s*([10]?\d|2[0-4])(?::([0-5]\d|\d))?(?::([0-5]\d|\d))?(\.\d{1,10})?(?:\s*([AP])M?)?\s*$/i.exec(t);if(e){const[,t,n,r,i,o]=e;if(i&&!r)return null;if(!o&&!n&&!r)return null;let a=1*(t||0);if(o){if(a>=13)return null;"p"!==o[0]&&"P"!==o[0]||(a+=12)}return{v:(60*a*60+1*(n||0)*60+1*(r||0)+1*(i||0))/86400,z:(2===t.length?"hh":"h")+":mm"+(r?":ss":"")+(o?" AM/PM":"")}}return null}function ut(t){return/^\s*true\s*$/i.test(t)?{v:!0}:/^\s*false\s*$/i.test(t)?{v:!1}:null}const ft={};function ht(t,e){t||(t="General");let n=null;return ft[t]?n=ft[t]:(n=Object.assign({},y(),e).throws?T(t):function(t){try{return T(t)}catch(e){const n={tokens:[{type:"error"}],error:e.message};return{pattern:t,partitions:[n,n,n,n],error:e.message,locale:null}}}(t)).error||(ft[t]=n),function(t,e){const{pattern:n,partitions:r,locale:i}=t,o=t=>{const n=Object.assign({},y(),e,t);return i&&(n.locale=i),n},a=(t,e)=>{const n=o(e);return function(t,e,n){const r=s(n.locale),i=e[3]?e[3]:K;if("boolean"==typeof t&&(t=t?"TRUE":"FALSE"),null==t)return"";if("number"!=typeof t)return G(t,i,n,r);if(!isFinite(t)){const e=r||f;return isNaN(t)?e.nan:(t<0?e.negative:"")+e.infinity}const o=X(t,e);return o?G(t,o,n,r):n.overflow}(R(t,n),r,n)};a.color=(t,e)=>(function(t,e){if("number"!=typeof t||!isFinite(t))return(e[3]?e[3].color:K.color)||Q;const n=X(t,e);return n&&n.color||Q})(R(t,o(e)),r);const l=function(t){var e;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const[r,i]=t,o=r.frac_max,a={type:"general",isDate:N(t),isText:H(t),isPercent:I(t),maxDecimals:r.general?9:o,scale:null!==(e=r.scale)&&void 0!==e?e:1,color:0,parentheses:0,grouped:r.grouping?1:0,_partitions:t},l=!a.isDate&&!a.isText&&!r.error&&r.tokens.some(t=>"string"===t.type&&(n?t.value===n:j.test(t.value)));let s="G",c=o>=0?Math.min(15,o):"",u="",f="";if(i&&i.color&&(f="-",a.color=1),r.parens&&(u="()",a.parentheses=1),l)s="C",a.type="currency";else if(r.error)a.type="error",a.maxDecimals=0;else if(a.isDate){let t=0,e=0,n="";r.tokens.forEach(r=>{const i=r.type;/^(b-)?year/.test(i)?(n+="Y",e++):i.startsWith("month")?(n+="M",e++):/^(week)?day/.test(i)?(n+="D",e++):"hour"!==i&&"min"!==i&&"sec"!==i&&"am"!==i||(n+=i[0],t++)}),a.type="date",e&&t?a.type="datetime":!e&&t&&(a.type="time");const i=W.find(t=>n.startsWith(t[0]));s=i?"D":"G",c=i?i[1]:""}else a.isText?(s="G",a.type="text",c="",a.maxDecimals=0):r.general?(s="G",a.type="general",c=""):r.fractions?(s="G",a.type="fraction",c=""):r.exponential?(s="S",a.type="scientific"):a.isPercent?(s="P",a.type="percent"):r.grouping?(s=",",a.type="grouped"):(r.int_max||o)&&(s="F",a.type="number");return a.code=s+c+f+u,a.level=V[a.type],Object.freeze(a)}(r,(e||{}).currency)||new SyntaxError;return a.info=l,a.dateInfo=function(t){const[e]=t;return{year:!!(2&e.date),month:!!(4&e.date),day:!!(8&e.date),hours:!!(e.date&b),minutes:!!(e.date&g),seconds:!!(e.date&m),clockType:12===e.clock?12:24}}(r),a.isPercent=()=>!!l.isPercent,a.isDate=()=>!!l.isDate,a.isText=()=>!!l.isText,a.pattern=n,t.error&&(a.error=t.error),a.options=o,a.locale=i||e&&e.locale||"",Object.freeze(a)}(n,e)}ht.isDate=t=>ht(t,{throws:!1}).isDate(),ht.isPercent=t=>ht(t,{throws:!1}).isPercent(),ht.isText=t=>ht(t,{throws:!1}).isText(),ht.getInfo=(t,e)=>ht(t,{...e,throws:!1}).info,ht.getDateInfo=(t,e)=>ht(t,{...e,throws:!1}).dateInfo,ht.dateToSerial=R,ht.dateFromSerial=F,ht.options=y,ht.dec2frac=d,ht.round=h,ht.codeToLocale=n,ht.parseLocale=a,ht.getLocale=s,ht.addLocale=(t,e)=>{const n=a(e);return delete ft[n.lang],delete ft[n.language],u(t,n)},ht.format=function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=n&&"object"==typeof n?n:{locale:n,throws:!r};return ht(t,i)(R(e,i),i)},ht.is_date=ht.isDate,ht.parseNumber=at,ht.parseDate=st,ht.parseTime=ct,ht.parseBool=ut,ht.parseValue=function(t,e){var n,r,i;return null!==(n=null!==(r=null!==(i=at(t))&&void 0!==i?i:st(t,e))&&void 0!==r?r:ct(t))&&void 0!==n?n:ut(t)};var dt=ht;return e=e.default}()},function(t,e,n){}])});
//# sourceMappingURL=xspreadsheet.js.map