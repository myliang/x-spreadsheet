!function(){var t={6293:function(t,e,i){"use strict";function s(){return window.devicePixelRatio||1}function l(){return s()-.5}function r(t){return parseInt(t*s(),10)}function n(t){let e=r(t);return e>0?e-.5:.5}i.r(e),i.d(e,{Draw:function(){return o},DrawBox:function(){return h},thinLineWidth:function(){return l},npx:function(){return r}});class h{constructor(t,e,i,s,l=0){this.x=t,this.y=e,this.width=i,this.height=s,this.padding=l,this.bgcolor="#ffffff",this.borderTop=null,this.borderRight=null,this.borderBottom=null,this.borderLeft=null}setBorders({top:t,bottom:e,left:i,right:s}){t&&(this.borderTop=t),s&&(this.borderRight=s),e&&(this.borderBottom=e),i&&(this.borderLeft=i)}innerWidth(){return this.width-2*this.padding-2}innerHeight(){return this.height-2*this.padding-2}textx(t){let{width:e,padding:i}=this,{x:s}=this;return"left"===t?s+=i:"center"===t?s+=e/2:"right"===t&&(s+=e-i),s}texty(t,e){let{height:i,padding:s}=this,{y:l}=this;return"top"===t?l+=s:"middle"===t?l+=i/2-e/2:"bottom"===t&&(l+=i-s-e),l}topxys(){let{x:t,y:e,width:i}=this;return[[t,e],[t+i,e]]}rightxys(){let{x:t,y:e,width:i,height:s}=this;return[[t+i,e],[t+i,e+s]]}bottomxys(){let{x:t,y:e,width:i,height:s}=this;return[[t,e+s],[t+i,e+s]]}leftxys(){let{x:t,y:e,height:i}=this;return[[t,e],[t,e+i]]}}function a(t,e,i,s,l,r,n){let h={x:0,y:0};"underline"===t?"bottom"===l?h.y=0:"top"===l?h.y=-(r+2):h.y=-r/2:"strike"===t&&("bottom"===l?h.y=r/2:"top"===l&&(h.y=-(r/2+2))),"center"===s?h.x=n/2:"right"===s&&(h.x=n),this.line([e-h.x,i-h.y],[e-h.x+n,i-h.y])}class o{constructor(t,e,i){this.el=t,this.ctx=t.getContext("2d"),this.resize(e,i),this.ctx.scale(s(),s())}resize(t,e){this.el.style.width=`${t}px`,this.el.style.height=`${e}px`,this.el.width=r(t),this.el.height=r(e)}clear(){let{width:t,height:e}=this.el;return this.ctx.clearRect(0,0,t,e),this}attr(t){return Object.assign(this.ctx,t),this}save(){return this.ctx.save(),this.ctx.beginPath(),this}restore(){return this.ctx.restore(),this}beginPath(){return this.ctx.beginPath(),this}translate(t,e){return this.ctx.translate(r(t),r(e)),this}scale(t,e){return this.ctx.scale(t,e),this}clearRect(t,e,i,s){return this.ctx.clearRect(t,e,i,s),this}fillRect(t,e,i,s){return this.ctx.fillRect(r(t)-.5,r(e)-.5,r(i),r(s)),this}fillText(t,e,i){return this.ctx.fillText(t,r(e),r(i)),this}text(t,e,i={},s=!0){let{ctx:l}=this,{align:n,valign:h,font:o,color:c,strike:d,underline:u}=i,f=e.textx(n);l.save(),l.beginPath(),this.attr({textAlign:n,textBaseline:h,font:`${o.italic?"italic":""} ${o.bold?"bold":""} ${r(o.size)}px ${o.name}`,fillStyle:c,strokeStyle:c});let g=`${t}`.split("\n"),p=e.innerWidth(),m=[];g.forEach(t=>{let e=l.measureText(t).width;if(s&&e>r(p)){let e={w:0,len:0,start:0};for(let i=0;i<t.length;i+=1)e.w>=r(p)&&(m.push(t.substr(e.start,e.len)),e={w:0,len:0,start:i}),e.len+=1,e.w+=l.measureText(t[i]).width+1;e.len>0&&m.push(t.substr(e.start,e.len))}else m.push(t)});let v=(m.length-1)*(o.size+2),w=e.texty(h,v);return m.forEach(t=>{let e=l.measureText(t).width;this.fillText(t,f,w),d&&a.call(this,"strike",f,w,n,h,o.size,e),u&&a.call(this,"underline",f,w,n,h,o.size,e),w+=o.size+2}),l.restore(),this}border(t,e){let{ctx:i}=this;return i.lineWidth=l,i.strokeStyle=e,"medium"===t?i.lineWidth=r(2)-.5:"thick"===t?i.lineWidth=r(3):"dashed"===t?i.setLineDash([r(3),r(2)]):"dotted"===t?i.setLineDash([r(1),r(1)]):"double"===t&&i.setLineDash([r(2),0]),this}line(...t){let{ctx:e}=this;if(t.length>1){e.beginPath();let[i,s]=t[0];e.moveTo(n(i),n(s));for(let i=1;i<t.length;i+=1){let[s,l]=t[i];e.lineTo(n(s),n(l))}e.stroke()}return this}strokeBorders(t){let{ctx:e}=this;e.save();let{borderTop:i,borderRight:s,borderBottom:l,borderLeft:r}=t;i&&(this.border(...i),this.line(...t.topxys())),s&&(this.border(...s),this.line(...t.rightxys())),l&&(this.border(...l),this.line(...t.bottomxys())),r&&(this.border(...r),this.line(...t.leftxys())),e.restore()}dropdown(t){let{ctx:e}=this,{x:i,y:s,width:l,height:n}=t,h=i+l-15,a=s+n-15;e.save(),e.beginPath(),e.moveTo(r(h),r(a)),e.lineTo(r(h+8),r(a)),e.lineTo(r(h+4),r(a+6)),e.closePath(),e.fillStyle="rgba(0, 0, 0, .45)",e.fill(),e.restore()}error(t){let{ctx:e}=this,{x:i,y:s,width:l}=t,n=i+l-1;e.save(),e.beginPath(),e.moveTo(r(n-8),r(s-1)),e.lineTo(r(n),r(s-1)),e.lineTo(r(n),r(s+8)),e.closePath(),e.fillStyle="rgba(255, 0, 0, .65)",e.fill(),e.restore()}frozen(t){let{ctx:e}=this,{x:i,y:s,width:l}=t,n=i+l-1;e.save(),e.beginPath(),e.moveTo(r(n-8),r(s-1)),e.lineTo(r(n),r(s-1)),e.lineTo(r(n),r(s+8)),e.closePath(),e.fillStyle="rgba(0, 255, 0, .85)",e.fill(),e.restore()}rect(t,e){let{ctx:i}=this,{x:s,y:l,width:h,height:a,bgcolor:o}=t;i.save(),i.beginPath(),i.fillStyle=o||"#fff",i.rect(n(s+1),n(l+1),r(h-2),r(a-2)),i.clip(),i.fill(),e(),i.restore()}}},5270:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return c}});var s=i("3129"),l=i("9992"),r=i("9074"),n=i("4735"),h=i("91");function a(...t){return(0,s.h)("table","").child((0,s.h)("tbody","").children(...t))}function o(t){return(0,s.h)("td","").child((0,s.h)("div",`${h.cssPrefix}-border-palette-cell`).child(new l.default(`border-${t}`)).on("click",()=>{this.mode=t;let{mode:e,style:i,color:s}=this;this.change({mode:e,style:i,color:s})}))}class c{constructor(){this.color="#000",this.style="thin",this.mode="all",this.change=()=>{},this.ddColor=new r.default("line-color",this.color),this.ddColor.change=t=>{this.color=t},this.ddType=new n.default(this.style),this.ddType.change=([t])=>{this.style=t},this.el=(0,s.h)("div",`${h.cssPrefix}-border-palette`);let t=a((0,s.h)("tr","").children((0,s.h)("td",`${h.cssPrefix}-border-palette-left`).child(a((0,s.h)("tr","").children(...["all","inside","horizontal","vertical","outside"].map(t=>o.call(this,t))),(0,s.h)("tr","").children(...["left","top","right","bottom","none"].map(t=>o.call(this,t))))),(0,s.h)("td",`${h.cssPrefix}-border-palette-right`).children((0,s.h)("div",`${h.cssPrefix}-toolbar-btn`).child(this.ddColor.el),(0,s.h)("div",`${h.cssPrefix}-toolbar-btn`).child(this.ddType.el))));this.el.child(t)}}},8467:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return p}});var s=i("3129"),l=i("1092"),r=i("91"),n=i("9992"),h=i("6322"),a=i("450"),o=i("2182");class c extends a.default{constructor(t){super(new n.default("ellipsis"),"auto",!1,"top-left"),this.contentClick=t}reset(t){let e=t.map((t,e)=>(0,s.h)("div",`${r.cssPrefix}-item`).css("width","150px").css("font-weight","normal").on("click",()=>{this.contentClick(e),this.hide()}).child(t));this.setContentChildren(...e)}setTitle(){}}let d=[{key:"delete",title:(0,o.tf)("contextmenu.deleteSheet")}];function u(t){return(0,s.h)("div",`${r.cssPrefix}-item`).child(t.title()).on("click",()=>{this.itemClick(t.key),this.hide()})}function f(){return d.map(t=>u.call(this,t))}class g{constructor(){this.el=(0,s.h)("div",`${r.cssPrefix}-contextmenu`).css("width","160px").children(...f.call(this)).hide(),this.itemClick=()=>{}}hide(){let{el:t}=this;t.hide(),(0,l.unbindClickoutside)(t)}setOffset(t){let{el:e}=this;e.offset(t),e.show(),(0,l.bindClickoutside)(e)}}class p{constructor(t=()=>{},e=()=>{},i=()=>{},l=()=>{}){this.swapFunc=e,this.updateFunc=l,this.dataNames=[],this.activeEl=null,this.deleteEl=null,this.items=[],this.moreEl=new c(t=>{this.clickSwap2(this.items[t])}),this.contextMenu=new g,this.contextMenu.itemClick=i,this.el=(0,s.h)("div",`${r.cssPrefix}-bottombar`).children(this.contextMenu.el,this.menuEl=(0,s.h)("ul",`${r.cssPrefix}-menu`).child((0,s.h)("li","").children(new n.default("add").on("click",()=>{t()}),(0,s.h)("span","").child(this.moreEl))))}addItem(t,e,i){this.dataNames.push(t);let l=(0,s.h)("li",e?"active":"").child(t);l.on("click",()=>{this.clickSwap2(l)}).on("contextmenu",t=>{if("read"===i.mode)return;let{offsetLeft:e,offsetHeight:s}=t.target;this.contextMenu.setOffset({left:e,bottom:s+1}),this.deleteEl=l}).on("dblclick",()=>{if("read"===i.mode)return;let t=l.html(),e=new h.default("auto","");e.val(t),e.input.on("blur",({target:e})=>{let{value:i}=e,s=this.dataNames.findIndex(e=>e===t);this.renameItem(s,i)}),l.html("").child(e.el),e.focus()}),e&&this.clickSwap(l),this.items.push(l),this.menuEl.child(l),this.moreEl.reset(this.dataNames)}renameItem(t,e){this.dataNames.splice(t,1,e),this.moreEl.reset(this.dataNames),this.items[t].html("").child(e),this.updateFunc(t,e)}clear(){this.items.forEach(t=>{this.menuEl.removeChild(t.el)}),this.items=[],this.dataNames=[],this.moreEl.reset(this.dataNames)}deleteItem(){let{activeEl:t,deleteEl:e}=this;if(this.items.length>1){let i=this.items.findIndex(t=>t===e);if(this.items.splice(i,1),this.dataNames.splice(i,1),this.menuEl.removeChild(e.el),this.moreEl.reset(this.dataNames),t===e){let[t]=this.items;return this.activeEl=t,this.activeEl.toggle(),[i,0]}return[i,-1]}return[-1]}clickSwap2(t){let e=this.items.findIndex(e=>e===t);this.clickSwap(t),this.activeEl.toggle(),this.swapFunc(e)}clickSwap(t){null!==this.activeEl&&this.activeEl.toggle(),this.activeEl=t}}},5339:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return n}});var s=i("3129"),l=i("91"),r=i("2182");class n extends s.Element{constructor(t,e=""){super("div",`${l.cssPrefix}-button ${e}`),this.child((0,r.t)(`button.${t}`))}}},3936:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return h}});var s=i("3129"),l=i("9992"),r=i("2182");function n(t,e){t.setMonth(t.getMonth()+e)}class h{constructor(t){this.value=t,this.cvalue=new Date(t),this.headerLeftEl=(0,s.h)("div","calendar-header-left"),this.bodyEl=(0,s.h)("tbody",""),this.buildAll(),this.el=(0,s.h)("div","x-spreadsheet-calendar").children((0,s.h)("div","calendar-header").children(this.headerLeftEl,(0,s.h)("div","calendar-header-right").children((0,s.h)("a","calendar-prev").on("click.stop",()=>this.prev()).child(new l.default("chevron-left")),(0,s.h)("a","calendar-next").on("click.stop",()=>this.next()).child(new l.default("chevron-right")))),(0,s.h)("table","calendar-body").children((0,s.h)("thead","").child((0,s.h)("tr","").children(...(0,r.t)("calendar.weeks").map(t=>(0,s.h)("th","cell").child(t)))),this.bodyEl)),this.selectChange=()=>{}}setValue(t){this.value=t,this.cvalue=new Date(t),this.buildAll()}prev(){let{value:t}=this;n(t,-1),this.buildAll()}next(){let{value:t}=this;n(t,1),this.buildAll()}buildAll(){this.buildHeaderLeft(),this.buildBody()}buildHeaderLeft(){let{value:t}=this;this.headerLeftEl.html(`${(0,r.t)("calendar.months")[t.getMonth()]} ${t.getFullYear()}`)}buildBody(){let{value:t,cvalue:e,bodyEl:i}=this,l=(function(t,e,i){let s=new Date(t,e,1,23,59,59),l=[[],[],[],[],[],[]];for(let t=0;t<6;t+=1)for(let r=0;r<7;r+=1){let n=function(t,e){let i=new Date(t);return i.setDate(e-t.getDay()+1),i}(s,7*t+r),h=n.getMonth()!==e,a=n.getMonth()===i.getMonth()&&n.getDate()===i.getDate();l[t][r]={d:n,disabled:h,active:a}}return l})(t.getFullYear(),t.getMonth(),e).map(t=>{let e=t.map(t=>{let e="cell";return t.disabled&&(e+=" disabled"),t.active&&(e+=" active"),(0,s.h)("td","").child((0,s.h)("div",e).on("click.stop",()=>{this.selectChange(t.d)}).child(t.d.getDate().toString()))});return(0,s.h)("tr","").children(...e)});i.html("").children(...l)}}},4741:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return o}});var s=i("3129"),l=i("91");let r=["#ffffff","#000100","#e7e5e6","#445569","#5b9cd6","#ed7d31","#a5a5a5","#ffc001","#4371c6","#71ae47"],n=[["#f2f2f2","#7f7f7f","#d0cecf","#d5dce4","#deeaf6","#fce5d5","#ededed","#fff2cd","#d9e2f3","#e3efd9"],["#d8d8d8","#595959","#afabac","#adb8ca","#bdd7ee","#f7ccac","#dbdbdb","#ffe59a","#b3c6e7","#c5e0b3"],["#bfbfbf","#3f3f3f","#756f6f","#8596b0","#9cc2e6","#f4b184","#c9c9c9","#fed964","#8eaada","#a7d08c"],["#a5a5a5","#262626","#3a3839","#333f4f","#2e75b5","#c45a10","#7b7b7b","#bf8e01","#2f5596","#538136"],["#7f7f7f","#0c0c0c","#171516","#222a35","#1f4e7a","#843c0a","#525252","#7e6000","#203864","#365624"]],h=["#c00000","#fe0000","#fdc101","#ffff01","#93d051","#00b04e","#01b0f1","#0170c1","#012060","#7030a0"];function a(t){return(0,s.h)("td","").child((0,s.h)("div",`${l.cssPrefix}-color-palette-cell`).on("click.stop",()=>this.change(t)).css("background-color",t))}class o{constructor(){this.el=(0,s.h)("div",`${l.cssPrefix}-color-palette`),this.change=()=>{};let t=(0,s.h)("table","").children((0,s.h)("tbody","").children((0,s.h)("tr",`${l.cssPrefix}-theme-color-placeholders`).children(...r.map(t=>a.call(this,t))),...n.map(t=>(0,s.h)("tr",`${l.cssPrefix}-theme-colors`).children(...t.map(t=>a.call(this,t)))),(0,s.h)("tr",`${l.cssPrefix}-standard-colors`).children(...h.map(t=>a.call(this,t)))));this.el.child(t)}}},3015:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return c}});var s=i("3129"),l=i("1092"),r=i("91"),n=i("2182");let h=[{key:"copy",title:(0,n.tf)("contextmenu.copy"),label:"Ctrl+C"},{key:"cut",title:(0,n.tf)("contextmenu.cut"),label:"Ctrl+X"},{key:"paste",title:(0,n.tf)("contextmenu.paste"),label:"Ctrl+V"},{key:"paste-value",title:(0,n.tf)("contextmenu.pasteValue"),label:"Ctrl+Shift+V"},{key:"paste-format",title:(0,n.tf)("contextmenu.pasteFormat"),label:"Ctrl+Alt+V"},{key:"divider"},{key:"insert-row",title:(0,n.tf)("contextmenu.insertRow")},{key:"insert-column",title:(0,n.tf)("contextmenu.insertColumn")},{key:"divider"},{key:"delete-row",title:(0,n.tf)("contextmenu.deleteRow")},{key:"delete-column",title:(0,n.tf)("contextmenu.deleteColumn")},{key:"delete-cell-text",title:(0,n.tf)("contextmenu.deleteCellText")},{key:"hide",title:(0,n.tf)("contextmenu.hide")},{key:"divider"},{key:"validation",title:(0,n.tf)("contextmenu.validation")},{key:"divider"},{key:"cell-printable",title:(0,n.tf)("contextmenu.cellprintable")},{key:"cell-non-printable",title:(0,n.tf)("contextmenu.cellnonprintable")},{key:"divider"},{key:"cell-editable",title:(0,n.tf)("contextmenu.celleditable")},{key:"cell-non-editable",title:(0,n.tf)("contextmenu.cellnoneditable")}];function a(t){return"divider"===t.key?(0,s.h)("div",`${r.cssPrefix}-item divider`):(0,s.h)("div",`${r.cssPrefix}-item`).on("click",()=>{this.itemClick(t.key),this.hide()}).children(t.title(),(0,s.h)("div","label").child(t.label||""))}function o(){return h.map(t=>a.call(this,t))}class c{constructor(t,e=!1){this.menuItems=o.call(this),this.el=(0,s.h)("div",`${r.cssPrefix}-contextmenu`).children(...this.menuItems).hide(),this.viewFn=t,this.itemClick=()=>{},this.isHide=e,this.setMode("range")}setMode(t){let e=this.menuItems[12];"row-col"===t?e.show():e.hide()}hide(){let{el:t}=this;t.hide(),(0,l.unbindClickoutside)(t)}setPosition(t,e){if(this.isHide)return;let{el:i}=this,{width:s}=i.show().offset(),r=this.viewFn(),n=r.height/2,h=t;r.width-t<=s&&(h-=s),i.css("left",`${h}px`),e>n?i.css("bottom",`${r.height-e}px`).css("max-height",`${e}px`).css("top","auto"):i.css("top",`${e}px`).css("max-height",`${r.height-e}px`).css("bottom","auto"),(0,l.bindClickoutside)(i)}}},3850:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return n}});var s=i("3936"),l=i("3129"),r=i("91");class n{constructor(){this.calendar=new s.default(new Date),this.el=(0,l.h)("div",`${r.cssPrefix}-datepicker`).child(this.calendar.el).hide()}setValue(t){let{calendar:e}=this;return"string"==typeof t?/^\d{4}-\d{1,2}-\d{1,2}$/.test(t)&&e.setValue(new Date(t.replace(/-/g,"/"))):t instanceof Date&&e.setValue(t),this}change(t){this.calendar.selectChange=e=>{t(e),this.hide()}}show(){this.el.show()}hide(){this.el.hide()}}},450:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return n}});var s=i("3129"),l=i("1092"),r=i("91");class n extends s.Element{constructor(t,e,i,l,...n){super("div",`${r.cssPrefix}-dropdown ${l}`),this.title=t,this.change=()=>{},this.headerClick=()=>{},"string"==typeof t?this.title=(0,s.h)("div",`${r.cssPrefix}-dropdown-title`).child(t):i&&this.title.addClass("arrow-left"),this.contentEl=(0,s.h)("div",`${r.cssPrefix}-dropdown-content`).css("width",e).hide(),this.setContentChildren(...n),this.headerEl=(0,s.h)("div",`${r.cssPrefix}-dropdown-header`),this.headerEl.on("click",()=>{"block"!==this.contentEl.css("display")?this.show():this.hide()}).children(this.title,i?(0,s.h)("div",`${r.cssPrefix}-icon arrow-right`).child((0,s.h)("div",`${r.cssPrefix}-icon-img arrow-down`)):""),this.children(this.headerEl,this.contentEl)}setContentChildren(...t){this.contentEl.html(""),t.length>0&&this.contentEl.children(...t)}setTitle(t){this.title.html(t),this.hide()}show(){let{contentEl:t}=this;t.show(),this.parent().active(),(0,l.bindClickoutside)(this.parent(),()=>{this.hide()})}hide(){this.parent().active(!1),this.contentEl.hide(),(0,l.unbindClickoutside)(this.parent())}}},5775:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return h}});var s=i("450"),l=i("3129"),r=i("9992"),n=i("91");class h extends s.default{constructor(t,e){let i=new r.default(`align-${e}`);super(i,"auto",!0,"bottom-left",...t.map(t=>{var e;return(e=`align-${t}`,(0,l.h)("div",`${n.cssPrefix}-item`).child(new r.default(e))).on("click",()=>{this.setTitle(t),this.change(t)})}))}setTitle(t){this.title.setName(`align-${t}`),this.hide()}}},8554:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return n}});var s=i("450"),l=i("9992"),r=i("5270");class n extends s.default{constructor(){let t=new l.default("border-all"),e=new r.default;e.change=t=>{this.change(t),this.hide()},super(t,"auto",!1,"bottom-left",e.el)}}},9074:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return n}});var s=i("450"),l=i("9992"),r=i("4741");class n extends s.default{constructor(t,e){let i=new l.default(t).css("height","16px").css("border-bottom",`3px solid ${e}`),s=new r.default;s.change=t=>{this.setTitle(t),this.change(t)},super(i,"auto",!1,"bottom-left",s.el)}setTitle(t){this.title.css("border-color",t),this.hide()}}},1589:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return h}});var s=i("450"),l=i("3129"),r=i("1933"),n=i("91");class h extends s.default{constructor(){super(r.baseFonts[0].title,"160px",!0,"bottom-left",...r.baseFonts.map(t=>(0,l.h)("div",`${n.cssPrefix}-item`).on("click",()=>{this.setTitle(t.title),this.change(t)}).child(t.title)))}}},8667:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return h}});var s=i("450"),l=i("3129"),r=i("1933"),n=i("91");class h extends s.default{constructor(){super("10","60px",!0,"bottom-left",...r.fontSizes.map(t=>(0,l.h)("div",`${n.cssPrefix}-item`).on("click",()=>{this.setTitle(`${t.pt}`),this.change(t)}).child(`${t.pt}`)))}}},653:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return h}});var s=i("450"),l=i("3129"),r=i("5854"),n=i("91");class h extends s.default{constructor(){let t=r.baseFormats.slice(0);t.splice(2,0,{key:"divider"}),t.splice(8,0,{key:"divider"}),super("Normal","220px",!0,"bottom-left",...t=t.map(t=>{let e=(0,l.h)("div",`${n.cssPrefix}-item`);return"divider"===t.key?e.addClass("divider"):(e.child(t.title()).on("click",()=>{this.setTitle(t.title()),this.change(t)}),t.label&&e.child((0,l.h)("div","label").html(t.label))),e}))}setTitle(t){for(let e=0;e<r.baseFormats.length;e+=1)r.baseFormats[e].key===t&&this.title.html((0,r.baseFormats)[e].title());this.hide()}}},2196:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return a}});var s=i("450"),l=i("9992"),r=i("3129"),n=i("4913"),h=i("91");class a extends s.default{constructor(){super(new l.default("formula"),"180px",!0,"bottom-left",...n.baseFormulas.map(t=>(0,r.h)("div",`${h.cssPrefix}-item`).on("click",()=>{this.hide(),this.change(t)}).child(t.key)))}}},4735:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return a}});var s=i("450"),l=i("3129"),r=i("9992"),n=i("91");let h=[["thin",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" style="user-select: none;"></line></svg>'],["medium",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="2" style="user-select: none;"><line x1="0" y1="1.0" x2="50" y2="1.0" stroke-width="2" stroke="black" style="user-select: none;"></line></svg>'],["thick",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="3" style="user-select: none;"><line x1="0" y1="1.5" x2="50" y2="1.5" stroke-width="3" stroke="black" style="user-select: none;"></line></svg>'],["dashed",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="2" style="user-select: none;"></line></svg>'],["dotted",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="1" style="user-select: none;"></line></svg>']];class a extends s.default{constructor(t){let e=new r.default("line-type"),i=0,s=h.map((e,r)=>(0,l.h)("div",`${n.cssPrefix}-item state ${t===e[0]?"checked":""}`).on("click",()=>{s[i].toggle("checked"),s[r].toggle("checked"),i=r,this.hide(),this.change(e)}).child((0,l.h)("div",`${n.cssPrefix}-line-type`).html(e[1])));super(e,"auto",!1,"bottom-left",...s)}}},8942:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return p}});var s=i("3129"),l=i("4242"),r=i("3850"),n=i("91");function h(){let{inputText:t}=this;if(!/^\s*$/.test(t)){let{textlineEl:e,textEl:i,areaOffset:s}=this,l=t.split("\n"),r=Math.max(...l.map(t=>t.length)),n=e.offset().width/t.length,h=(r+1)*n+5,a=this.viewFn().width-s.left-n,o=l.length;if(h>s.width){let t=h;h>a&&(t=a,o+=parseInt(h/a,10)+(h%a>0?1:0)),i.css("width",`${t}px`)}(o*=this.rowHeight)>s.height&&i.css("height",`${o}px`)}}function a({target:t},e){let{value:i,selectionEnd:s}=t,l=`${i.slice(0,s)}${e}${i.slice(s)}`;t.value=l,t.setSelectionRange(s+1,s+1),this.inputText=l,this.textlineEl.html(l),h.call(this)}function o(t){let{keyCode:e,altKey:i}=t;13!==e&&9!==e&&t.stopPropagation(),13===e&&i&&(a.call(this,t,"\n"),t.stopPropagation()),13===e&&!i&&t.preventDefault()}function c(t){let e=t.target.value,{suggest:i,textlineEl:s,validator:l}=this,{cell:r}=this;if(null!==r){if("editable"in r&&!0===r.editable||void 0===r.editable){if(this.inputText=e,l)"list"===l.type?i.search(e):i.hide();else{let t=e.lastIndexOf("=");-1!==t?i.search(e.substring(t+1)):i.hide()}s.html(e),h.call(this),this.change("input",e)}else t.target.value=r.text||""}else{if(this.inputText=e,l)"list"===l.type?i.search(e):i.hide();else{let t=e.lastIndexOf("=");-1!==t?i.search(e.substring(t+1)):i.hide()}s.html(e),h.call(this),this.change("input",e)}}function d(t){let{el:e}=this.textEl;setTimeout(()=>{e.focus(),e.setSelectionRange(t,t)},0)}function u(t,e){let{textEl:i,textlineEl:s}=this;i.el.blur(),i.val(t),s.html(t),d.call(this,e)}function f(t){let{inputText:e,validator:i}=this,s=0;if(i&&"list"===i.type)this.inputText=t,s=this.inputText.length;else{let i=e.lastIndexOf("="),l=e.substring(0,i+1),r=e.substring(i+1);r=-1!==r.indexOf(")")?r.substring(r.indexOf(")")):"",this.inputText=`${l+t.key}(`,s=this.inputText.length,this.inputText+=`)${r}`}u.call(this,this.inputText,s)}function g(){this.suggest.setItems(this.formulas)}class p{constructor(t,e,i){this.viewFn=e,this.rowHeight=i,this.formulas=t,this.suggest=new l.default(t,t=>{f.call(this,t)}),this.datepicker=new r.default,this.datepicker.change(t=>{var e;let i,s;this.setText((i=(e=t).getMonth()+1,s=e.getDate(),i<10&&(i=`0${i}`),s<10&&(s=`0${s}`),`${e.getFullYear()}-${i}-${s}`)),this.clear()}),this.areaEl=(0,s.h)("div",`${n.cssPrefix}-editor-area`).children(this.textEl=(0,s.h)("textarea","").on("input",t=>c.call(this,t)).on("paste.stop",()=>{}).on("keydown",t=>o.call(this,t)),this.textlineEl=(0,s.h)("div","textline"),this.suggest.el,this.datepicker.el).on("mousemove.stop",()=>{}).on("mousedown.stop",()=>{}),this.el=(0,s.h)("div",`${n.cssPrefix}-editor`).child(this.areaEl).hide(),this.suggest.bindInputEvents(this.textEl),this.areaOffset=null,this.freeze={w:0,h:0},this.cell=null,this.inputText="",this.change=()=>{}}setFreezeLengths(t,e){this.freeze.w=t,this.freeze.h=e}clear(){""!==this.inputText&&this.change("finished",this.inputText),this.cell=null,this.areaOffset=null,this.inputText="",this.el.hide(),this.textEl.val(""),this.textlineEl.html(""),g.call(this),this.datepicker.hide()}setOffset(t,e="top"){let{textEl:i,areaEl:s,suggest:l,freeze:r,el:n}=this;if(t){this.areaOffset=t;let{left:h,top:a,width:o,height:c,l:d,t:u}=t,f={left:0,top:0};r.w>d&&r.h>u||(r.w<d&&r.h<u?(f.left=r.w,f.top=r.h):r.w>d?f.top=r.h:r.h>u&&(f.left=r.w)),n.offset(f),s.offset({left:h-f.left-.8,top:a-f.top-.8}),i.offset({width:o-9+.8,height:c-3+.8});let g={left:0};g[e]=c,l.setOffset(g),l.hide()}}setCell(t,e){if(t&&!1===t.editable)return;let{el:i,datepicker:s,suggest:l}=this;i.show(),this.cell=t;let r=t&&t.text||"";if(this.setText(r),this.validator=e,e){let{type:t}=e;"date"===t&&(s.show(),!/^\s*$/.test(r)&&s.setValue(r)),"list"===t&&(l.setItems(e.values()),l.search(""))}}setText(t){this.inputText=t,u.call(this,t,t.length),h.call(this)}}},3129:function(t,e,i){"use strict";i.r(e),i.d(e,{Element:function(){return s},h:function(){return l}});class s{constructor(t,e=""){"string"==typeof t?(this.el=document.createElement(t),this.el.className=e):this.el=t,this.data={}}data(t,e){return void 0!==e?(this.data[t]=e,this):this.data[t]}on(t,e){let[i,...s]=t.split("."),l=i;return"mousewheel"===l&&/Firefox/i.test(window.navigator.userAgent)&&(l="DOMMouseScroll"),this.el.addEventListener(l,t=>{e(t);for(let e=0;e<s.length;e+=1){let i=s[e];if("left"===i&&0!==t.button||"right"===i&&2!==t.button)return;"stop"===i&&t.stopPropagation()}}),this}offset(t){if(void 0!==t)return Object.keys(t).forEach(e=>{this.css(e,`${t[e]}px`)}),this;let{offsetTop:e,offsetLeft:i,offsetHeight:s,offsetWidth:l}=this.el;return{top:e,left:i,height:s,width:l}}scroll(t){let{el:e}=this;return void 0!==t&&(void 0!==t.left&&(e.scrollLeft=t.left),void 0!==t.top&&(e.scrollTop=t.top)),{left:e.scrollLeft,top:e.scrollTop}}box(){return this.el.getBoundingClientRect()}parent(){return new s(this.el.parentNode)}children(...t){return 0==arguments.length?this.el.childNodes:(t.forEach(t=>this.child(t)),this)}removeChild(t){this.el.removeChild(t)}child(t){let e=t;return"string"==typeof t?e=document.createTextNode(t):t instanceof s&&(e=t.el),this.el.appendChild(e),this}contains(t){return this.el.contains(t)}className(t){return void 0!==t?(this.el.className=t,this):this.el.className}addClass(t){return this.el.classList.add(t),this}hasClass(t){return this.el.classList.contains(t)}removeClass(t){return this.el.classList.remove(t),this}toggle(t="active"){return this.toggleClass(t)}toggleClass(t){return this.el.classList.toggle(t)}active(t=!0,e="active"){return t?this.addClass(e):this.removeClass(e),this}checked(t=!0){return this.active(t,"checked"),this}disabled(t=!0){return t?this.addClass("disabled"):this.removeClass("disabled"),this}attr(t,e){if(void 0!==e)this.el.setAttribute(t,e);else{if("string"==typeof t)return this.el.getAttribute(t);Object.keys(t).forEach(e=>{this.el.setAttribute(e,t[e])})}return this}removeAttr(t){return this.el.removeAttribute(t),this}html(t){return void 0!==t?(this.el.innerHTML=t,this):this.el.innerHTML}val(t){return void 0!==t?(this.el.value=t,this):this.el.value}focus(){this.el.focus()}cssRemoveKeys(...t){return t.forEach(t=>this.el.style.removeProperty(t)),this}css(t,e){return void 0===e&&"string"!=typeof t?(Object.keys(t).forEach(e=>{this.el.style[e]=t[e]}),this):void 0!==e?(this.el.style[t]=e,this):this.el.style[t]}computedStyle(){return window.getComputedStyle(this.el,null)}show(){return this.css("display","block"),this}hide(){return this.css("display","none"),this}}let l=(t,e="")=>new s(t,e)},1092:function(t,e,i){"use strict";function s(t,e,i){t.addEventListener(e,i)}function l(t,e,i){t.removeEventListener(e,i)}function r(t){t.xclickoutside&&(l(window.document.body,"click",t.xclickoutside),delete t.xclickoutside)}function n(t,e){t.xclickoutside=i=>{!(2===i.detail||t.contains(i.target))&&(e?e(t):(t.hide(),r(t)))},s(window.document.body,"click",t.xclickoutside)}function h(t,e,i){s(t,"mousemove",e);t.xEvtUp=s=>{l(t,"mousemove",e),l(t,"mouseup",t.xEvtUp),i(s)},s(t,"mouseup",t.xEvtUp)}function a(t,e,i,s){let l="";Math.abs(t)>Math.abs(e)?s(l=t>0?"right":"left",t,i):s(l=e>0?"down":"up",e,i)}function o(t,{move:e,end:i}){let l=0,r=0;s(t,"touchstart",t=>{let{pageX:e,pageY:i}=t.touches[0];l=e,r=i}),s(t,"touchmove",t=>{if(!e)return;let{pageX:i,pageY:s}=t.changedTouches[0],n=i-l,h=s-r;(Math.abs(n)>10||Math.abs(h)>10)&&(a(n,h,t,e),l=i,r=s),t.preventDefault()}),s(t,"touchend",t=>{if(!i)return;let{pageX:e,pageY:s}=t.changedTouches[0];a(e-l,s-r,t,i)})}function c(){let t=new Map;function e(e,i){return t.has(e)&&(()=>{let s=t.get(e);return Array.isArray(s)&&s.push(i)||!1})()||t.set(e,[].concat(i))}function i(e,i){return t.has(e)&&(()=>{let s=t.get(e),l=s.indexOf(i);return l>=0&&s.splice(l,1)&&0===t.get(e).length&&t.delete(e)})()}return{get current(){return t},on:e,once:function(t,s){let l=(...e)=>{s.call(null,...e),i(t,l)};return e(t,l)},fire:function(e,i){return t.has(e)&&(()=>{for(let s of t.get(e))s.call(null,...i)})()},removeListener:i,removeAllListeners:function(){t.clear()}}}i.r(e),i.d(e,{bind:function(){return s},unbind:function(){return l},unbindClickoutside:function(){return r},bindClickoutside:function(){return n},mouseMoveUp:function(){return h},bindTouch:function(){return o},createEventEmitter:function(){return c}})},3430:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return h}});var s=i("3129"),l=i("91"),r=i("2182");let n={number:/(^\d+$)|(^\d+(\.\d{0,4})?$)/,date:/^\d{4}-\d{1,2}-\d{1,2}$/};class h{constructor(t,e,i,r){this.label="",this.rule=e,i&&(this.label=(0,s.h)("label","label").css("width",`${r}px`).html(i)),this.tip=(0,s.h)("div","tip").child("tip").hide(),this.input=t,this.input.vchange=()=>this.validate(),this.el=(0,s.h)("div",`${l.cssPrefix}-form-field`).children(this.label,t.el,this.tip)}isShow(){return"none"!==this.el.css("display")}show(){this.el.show()}hide(){return this.el.hide(),this}val(t){return this.input.val(t)}hint(t){this.input.hint(t)}validate(){let{input:t,rule:e,tip:i,el:s}=this,l=t.val();return e.required&&/^\s*$/.test(l)?(i.html((0,r.t)("validation.required")),s.addClass("error"),!1):(e.type||e.pattern)&&!(e.pattern||n[e.type]).test(l)?(i.html((0,r.t)("validation.notMatch")),s.addClass("error"),!1):(s.removeClass("error"),!0)}}},6322:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return r}});var s=i("3129"),l=i("91");class r{constructor(t,e){this.vchange=()=>{},this.el=(0,s.h)("div",`${l.cssPrefix}-form-input`),this.input=(0,s.h)("input","").css("width",t).on("input",t=>this.vchange(t)).attr("placeholder",e),this.el.child(this.input)}focus(){setTimeout(()=>{this.input.el.focus()},10)}hint(t){this.input.attr("placeholder",t)}val(t){return this.input.val(t)}}},8286:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return n}});var s=i("3129"),l=i("4242"),r=i("91");class n{constructor(t,e,i,n=t=>t,h=()=>{}){this.key=t,this.getTitle=n,this.vchange=()=>{},this.el=(0,s.h)("div",`${r.cssPrefix}-form-select`),this.suggest=new l.default(e.map(t=>({key:t,title:this.getTitle(t)})),t=>{this.itemClick(t.key),h(t.key),this.vchange(t.key)},i,this.el),this.el.children(this.itemEl=(0,s.h)("div","input-text").html(this.getTitle(t)),this.suggest.el).on("click",()=>this.show())}show(){this.suggest.search("")}itemClick(t){this.key=t,this.itemEl.html(this.getTitle(t))}val(t){return void 0!==t?(this.key=t,this.itemEl.html(this.getTitle(t)),this):this.key}}},9992:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return r}});var s=i("3129"),l=i("91");class r extends s.Element{constructor(t){super("div",`${l.cssPrefix}-icon`),this.iconNameEl=(0,s.h)("div",`${l.cssPrefix}-icon-img ${t}`),this.child(this.iconNameEl)}setName(t){this.iconNameEl.className(`${l.cssPrefix}-icon-img ${t}`)}}},2402:function(t,e,i){"use strict";i.r(e),i.d(e,{xtoast:function(){return n}});var s=i("3129"),l=i("9992"),r=i("91");function n(t,e){let i=(0,s.h)("div",`${r.cssPrefix}-toast`),n=(0,s.h)("div",`${r.cssPrefix}-dimmer active`),h=()=>{document.body.removeChild(i.el),document.body.removeChild(n.el)};i.children((0,s.h)("div",`${r.cssPrefix}-toast-header`).children(new l.default("close").on("click.stop",()=>h()),t),(0,s.h)("div",`${r.cssPrefix}-toast-content`).html(e)),document.body.appendChild(i.el),document.body.appendChild(n.el);let{width:a,height:o}=i.box(),{clientHeight:c,clientWidth:d}=document.documentElement;i.offset({left:(d-a)/2,top:(c-o)/3})}},9417:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return h}});var s=i("3129"),l=i("9992"),r=i("91"),n=i("1092");class h{constructor(t,e,i="600px"){this.title=t,this.el=(0,s.h)("div",`${r.cssPrefix}-modal`).css("width",i).children((0,s.h)("div",`${r.cssPrefix}-modal-header`).children(new l.default("close").on("click.stop",()=>this.hide()),this.title),(0,s.h)("div",`${r.cssPrefix}-modal-content`).children(...e)).hide()}show(){this.dimmer=(0,s.h)("div",`${r.cssPrefix}-dimmer active`),document.body.appendChild(this.dimmer.el);let{width:t,height:e}=this.el.show().box(),{clientHeight:i,clientWidth:l}=document.documentElement;this.el.offset({left:(l-t)/2,top:(i-e)/3}),window.xkeydownEsc=t=>{27===t.keyCode&&this.hide()},(0,n.bind)(window,"keydown",window.xkeydownEsc)}hide(){this.el.hide(),document.body.removeChild(this.dimmer.el),(0,n.unbind)(window,"keydown",window.xkeydownEsc),delete window.xkeydownEsc}}},8532:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return d}});var s=i("9417"),l=i("6322"),r=i("8286"),n=i("3430"),h=i("5339"),a=i("2182"),o=i("3129"),c=i("91");class d extends s.default{constructor(){let t=new n.default(new r.default("cell",["cell"],"100%",t=>(0,a.t)(`dataValidation.modeType.${t}`)),{required:!0},`${(0,a.t)("dataValidation.range")}:`,100),e=new n.default(new l.default("120px","E3 or E3:F12"),{required:!0,pattern:/^([A-Z]{1,2}[1-9]\d*)(:[A-Z]{1,2}[1-9]\d*)?$/}),i=new n.default(new r.default("list",["list","number","date","phone","email"],"100%",t=>(0,a.t)(`dataValidation.type.${t}`),t=>this.criteriaSelected(t)),{required:!0},`${(0,a.t)("dataValidation.criteria")}:`,100),s=new n.default(new r.default("be",["be","nbe","eq","neq","lt","lte","gt","gte"],"160px",t=>(0,a.t)(`dataValidation.operator.${t}`),t=>this.criteriaOperatorSelected(t)),{required:!0}).hide(),d=new n.default(new l.default("70px","10"),{required:!0}).hide(),u=new n.default(new l.default("70px","100"),{required:!0,type:"number"}).hide(),f=new n.default(new l.default("120px","a,b,c"),{required:!0}),g=new n.default(new l.default("70px","10"),{required:!0,type:"number"}).hide();super((0,a.t)("contextmenu.validation"),[(0,o.h)("div",`${c.cssPrefix}-form-fields`).children(t.el,e.el),(0,o.h)("div",`${c.cssPrefix}-form-fields`).children(i.el,s.el,d.el,u.el,g.el,f.el),(0,o.h)("div",`${c.cssPrefix}-buttons`).children(new h.default("cancel").on("click",()=>this.btnClick("cancel")),new h.default("remove").on("click",()=>this.btnClick("remove")),new h.default("save","primary").on("click",()=>this.btnClick("save")))]),this.mf=t,this.rf=e,this.cf=i,this.of=s,this.minvf=d,this.maxvf=u,this.vf=g,this.svf=f,this.change=()=>{}}showVf(t){let{vf:e}=this;e.input.hint("date"===t?"2018-11-12":"10"),e.show()}criteriaSelected(t){let{of:e,minvf:i,maxvf:s,vf:l,svf:r}=this;"date"===t||"number"===t?(e.show(),i.rule.type=t,s.rule.type=t,"date"===t?(i.hint("2018-11-12"),s.hint("2019-11-12")):(i.hint("10"),s.hint("100")),i.show(),s.show(),l.hide(),r.hide()):("list"===t?r.show():r.hide(),l.hide(),e.hide(),i.hide(),s.hide())}criteriaOperatorSelected(t){if(!t)return;let{minvf:e,maxvf:i,vf:s}=this;if("be"===t||"nbe"===t)e.show(),i.show(),s.hide();else{let t=this.cf.val();s.rule.type=t,"date"===t?s.hint("2018-11-12"):s.hint("10"),s.show(),e.hide(),i.hide()}}btnClick(t){if("cancel"===t)this.hide();else if("remove"===t)this.change("remove"),this.hide();else if("save"===t){let t=["mf","rf","cf","of","svf","vf","minvf","maxvf"];for(let e=0;e<t.length;e+=1){let i=this[t[e]];if(i.isShow()&&!i.validate())return}let e=this.mf.val(),i=this.rf.val(),s=this.cf.val(),l=this.of.val(),r=this.svf.val();("number"===s||"date"===s)&&(r="be"===l||"nbe"===l?[this.minvf.val(),this.maxvf.val()]:this.vf.val()),this.change("save",e,i,{type:s,operator:l,required:!1,value:r}),this.hide()}}setValue(t){if(t){let{mf:e,rf:i,cf:s,of:l,svf:r,vf:n,minvf:h,maxvf:a}=this,{mode:o,ref:c,validator:d}=t,{type:u,operator:f,value:g}=d||{type:"list"};e.val(o||"cell"),i.val(c),s.val(u),l.val(f),Array.isArray(g)?(h.val(g[0]),a.val(g[1])):(r.val(g||""),n.val(g||"")),this.criteriaSelected(u),this.criteriaOperatorSelected(f)}this.show()}}},6243:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return p}});var s=i("3129"),l=i("91"),r=i("5339"),n=i("6293"),h=i("9498"),a=i("2182");let o=[["A3",11.69,16.54],["A4",8.27,11.69],["A5",5.83,8.27],["B4",9.84,13.9],["B5",6.93,9.84]],c=["landscape","portrait"];function d(t){return parseInt(96*t,10)}function u(t){"cancel"===t?this.el.hide():this.toPrint()}function f(t){let{paper:e}=this,{value:i}=t.target,s=o[i];e.w=d(s[1]),e.h=d(s[2]),this.preview()}function g(t){let{paper:e}=this,{value:i}=t.target,s=c[i];e.orientation=s,this.preview()}class p{constructor(t){this.paper={w:d(o[0][1]),h:d(o[0][2]),padding:50,orientation:c[0],get width(){return"landscape"===this.orientation?this.h:this.w},get height(){return"landscape"===this.orientation?this.w:this.h}},this.data=t,this.el=(0,s.h)("div",`${l.cssPrefix}-print`).children((0,s.h)("div",`${l.cssPrefix}-print-bar`).children((0,s.h)("div","-title").child("Print settings"),(0,s.h)("div","-right").children((0,s.h)("div",`${l.cssPrefix}-buttons`).children(new r.default("cancel").on("click",u.bind(this,"cancel")),new r.default("next","primary").on("click",u.bind(this,"next"))))),(0,s.h)("div",`${l.cssPrefix}-print-content`).children(this.contentEl=(0,s.h)("div","-content"),(0,s.h)("div","-sider").child((0,s.h)("form","").children((0,s.h)("fieldset","").children((0,s.h)("label","").child(`${(0,a.t)("print.size")}`),(0,s.h)("select","").children(...o.map((t,e)=>(0,s.h)("option","").attr("value",e).child(`${t[0]} ( ${t[1]}''x${t[2]}'' )`))).on("change",f.bind(this))),(0,s.h)("fieldset","").children((0,s.h)("label","").child(`${(0,a.t)("print.orientation")}`),(0,s.h)("select","").children(...c.map((t,e)=>(0,s.h)("option","").attr("value",e).child(`${(0,a.t)("print.orientations")[e]}`))).on("change",g.bind(this))))))).hide()}resetData(t){this.data=t}preview(){let{data:t,paper:e}=this,{width:i,height:r,padding:a}=e,o=i-2*a,c=r-2*a,d=t.contentRange(),u=parseInt(d.h/c,10)+1,f=o/d.w,g=a;f>1&&(g+=(o-d.w)/2);let p=0,m=0;this.contentEl.html(""),this.canvases=[];let v={sri:0,sci:0,eri:0,eci:0};for(let e=0;e<u;e+=1){let e=0,o=0,u=(0,s.h)("div",`${l.cssPrefix}-canvas-card`),w=(0,s.h)("canvas",`${l.cssPrefix}-canvas`);this.canvases.push(w.el);let x=new n.Draw(w.el,i,r);for(x.save(),x.translate(g,a),f<1&&x.scale(f,f);p<=d.eri;p+=1){let i=t.rows.getHeight(p);if((e+=i)<c)for(let e=0;e<=d.eci;e+=1)(0,h.renderCell)(x,t,p,e,m),v.eci=e;else{o=-(e-i);break}}v.eri=p,x.restore(),x.save(),x.translate(g,a),f<1&&x.scale(f,f);let b=m;t.eachMergesInView(v,({sri:e,sci:i})=>{(0,h.renderCell)(x,t,e,i,b)}),x.restore(),v.sri=v.eri,v.sci=v.eci,m+=o,this.contentEl.child((0,s.h)("div",`${l.cssPrefix}-canvas-card-wraper`).child(u.child(w)))}this.el.show()}toPrint(){this.el.hide();let{paper:t}=this,{el:e}=(0,s.h)("iframe","").hide();window.document.body.appendChild(e);let{contentWindow:i}=e,l=i.document,r=document.createElement("style");r.innerHTML=`
      @page { size: ${t.width}px ${t.height}px; };
      canvas {
        page-break-before: auto;        
        page-break-after: always;
        image-rendering: pixelated;
      };
    `,l.head.appendChild(r),this.canvases.forEach(t=>{let e=t.cloneNode(!1);e.getContext("2d").drawImage(t,0,0),l.body.appendChild(e)}),i.print()}}},4817:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return n}});var s=i("3129"),l=i("1092"),r=i("91");class n{constructor(t=!1,e){this.moving=!1,this.vertical=t,this.el=(0,s.h)("div",`${r.cssPrefix}-resizer ${t?"vertical":"horizontal"}`).children(this.unhideHoverEl=(0,s.h)("div",`${r.cssPrefix}-resizer-hover`).on("dblclick.stop",t=>this.mousedblclickHandler(t)).css("position","absolute").hide(),this.hoverEl=(0,s.h)("div",`${r.cssPrefix}-resizer-hover`).on("mousedown.stop",t=>this.mousedownHandler(t)),this.lineEl=(0,s.h)("div",`${r.cssPrefix}-resizer-line`).hide()).hide(),this.cRect=null,this.finishedFn=null,this.minDistance=e,this.unhideFn=()=>{}}showUnhide(t){this.unhideIndex=t,this.unhideHoverEl.show()}hideUnhide(){this.unhideHoverEl.hide()}show(t,e){let{moving:i,vertical:s,hoverEl:l,lineEl:r,el:n,unhideHoverEl:h}=this;if(i)return;this.cRect=t;let{left:a,top:o,width:c,height:d}=t;n.offset({left:s?a+c-5:a,top:s?o:o+d-5}).show(),l.offset({width:s?5:c,height:s?d:5}),r.offset({width:s?0:e.width,height:s?e.height:0}),h.offset({left:s?5-c:a,top:s?o:5-d,width:s?5:c,height:s?d:5})}hide(){this.el.offset({left:0,top:0}).hide(),this.hideUnhide()}mousedblclickHandler(){this.unhideIndex&&this.unhideFn(this.unhideIndex)}mousedownHandler(t){let e=t,{el:i,lineEl:s,cRect:r,vertical:n,minDistance:h}=this,a=n?r.width:r.height;s.show(),(0,l.mouseMoveUp)(window,t=>{this.moving=!0,null!==e&&1===t.buttons&&(n?(a+=t.movementX)>h&&i.css("left",`${r.left+a}px`):(a+=t.movementY)>h&&i.css("top",`${r.top+a}px`),e=t)},()=>{e=null,s.hide(),this.moving=!1,this.hide(),this.finishedFn&&(a<h&&(a=h),this.finishedFn(r,a))})}}},3498:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return r}});var s=i("3129"),l=i("91");class r{constructor(t){this.vertical=t,this.moveFn=null,this.el=(0,s.h)("div",`${l.cssPrefix}-scrollbar ${t?"vertical":"horizontal"}`).child(this.contentEl=(0,s.h)("div","")).on("mousemove.stop",()=>{}).on("scroll.stop",t=>{let{scrollTop:e,scrollLeft:i}=t.target;this.moveFn&&this.moveFn(this.vertical?e:i,t)})}move(t){return this.el.scroll(t),this}scroll(){return this.el.scroll()}set(t,e){let i=t-1;if(e>i){let t=this.vertical?"height":"width";this.el.css(t,`${i-15}px`).show(),this.contentEl.css(this.vertical?"width":"height","1px").css(t,`${e}px`)}else this.el.hide();return this}}},3782:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return y}});var s=i("3129"),l=i("91"),r=i("791");let n=10;class h{constructor(t=!1,e=!0){this.useHideInput=t,this.autoFocus=e,this.inputChange=()=>{},this.cornerEl=(0,s.h)("div",`${l.cssPrefix}-selector-corner`),this.areaEl=(0,s.h)("div",`${l.cssPrefix}-selector-area`).child(this.cornerEl).hide(),this.clipboardEl=(0,s.h)("div",`${l.cssPrefix}-selector-clipboard`).hide(),this.autofillEl=(0,s.h)("div",`${l.cssPrefix}-selector-autofill`).hide(),this.el=(0,s.h)("div",`${l.cssPrefix}-selector`).css("z-index",`${n}`).children(this.areaEl,this.clipboardEl,this.autofillEl).hide(),t&&(this.hideInput=(0,s.h)("input","").on("compositionend",t=>{this.inputChange(t.target.value)}),this.el.child(this.hideInputDiv=(0,s.h)("div","hide-input").child(this.hideInput)),this.el.child(this.hideInputDiv=(0,s.h)("div","hide-input").child(this.hideInput))),n+=1}setOffset(t){return this.el.offset(t).show(),this}hide(){return this.el.hide(),this}setAreaOffset(t){let{left:e,top:i,width:s,height:l}=t,r={width:s-3+.8,height:l-3+.8,left:e-.8,top:i-.8};this.areaEl.offset(r).show(),this.useHideInput&&(this.hideInputDiv.offset(r),this.autoFocus?this.hideInput.val("").focus():this.hideInput.val(""))}setClipboardOffset(t){let{left:e,top:i,width:s,height:l}=t;this.clipboardEl.offset({left:e,top:i,width:s-5,height:l-5})}showAutofill(t){let{left:e,top:i,width:s,height:l}=t;this.autofillEl.offset({width:s-3,height:l-3,left:e,top:i}).show()}hideAutofill(){this.autofillEl.hide()}showClipboard(){this.clipboardEl.show()}hideClipboard(){this.clipboardEl.hide()}}function a(t){let{data:e}=this,{left:i,top:s,width:l,height:r,scroll:n,l:h,t:a}=t,o=e.freezeTotalWidth(),c=e.freezeTotalHeight(),d=i-o;o>h&&(d-=n.x);let u=s-c;return c>a&&(u-=n.y),{left:d,top:u,width:l,height:r}}function o(t){let{data:e}=this,{left:i,width:s,height:l,l:r,t:n,scroll:h}=t,a=e.freezeTotalWidth(),o=i-a;return a>r&&(o-=h.x),{left:o,top:n,width:s,height:l}}function c(t){let{data:e}=this,{top:i,width:s,height:l,l:r,t:n,scroll:h}=t,a=e.freezeTotalHeight(),o=i-a;return a>n&&(o-=h.y),{left:r,top:o,width:s,height:l}}function d(t){let{br:e}=this;e.setAreaOffset(a.call(this,t))}function u(t){let{tl:e}=this;e.setAreaOffset(t)}function f(t){let{t:e}=this;e.setAreaOffset(o.call(this,t))}function g(t){let{l:e}=this;e.setAreaOffset(c.call(this,t))}function p(t){let{l:e}=this;e.setClipboardOffset(c.call(this,t))}function m(t){let{br:e}=this;e.setClipboardOffset(a.call(this,t))}function v(t){let{tl:e}=this;e.setClipboardOffset(t)}function w(t){let{t:e}=this;e.setClipboardOffset(o.call(this,t))}function x(t){d.call(this,t),u.call(this,t),f.call(this,t),g.call(this,t)}function b(t){m.call(this,t),v.call(this,t),w.call(this,t),p.call(this,t)}class y{constructor(t){let{autoFocus:e}=t.settings;this.inputChange=()=>{},this.data=t,this.br=new h(!0,e),this.t=new h,this.l=new h,this.tl=new h,this.br.inputChange=t=>{this.inputChange(t)},this.br.el.show(),this.offset=null,this.areaOffset=null,this.indexes=null,this.range=null,this.arange=null,this.el=(0,s.h)("div",`${l.cssPrefix}-selectors`).children(this.tl.el,this.t.el,this.l.el,this.br.el).hide(),this.lastri=-1,this.lastci=-1,n+=1}resetData(t){this.data=t,this.range=t.selector.range,this.resetAreaOffset()}hide(){this.el.hide()}resetOffset(){let{data:t,tl:e,t:i,l:s,br:l}=this,r=t.freezeTotalHeight(),n=t.freezeTotalWidth();r>0||n>0?(e.setOffset({width:n,height:r}),i.setOffset({left:n,height:r}),s.setOffset({top:r,width:n}),l.setOffset({left:n,top:r})):(e.hide(),i.hide(),s.hide(),l.setOffset({left:0,top:0}))}resetAreaOffset(){let t=this.data.getSelectedRect(),e=this.data.getClipboardRect();x.call(this,t),b.call(this,e),this.resetOffset()}resetBRTAreaOffset(){let t=this.data.getSelectedRect(),e=this.data.getClipboardRect();d.call(this,t),f.call(this,t),m.call(this,e),w.call(this,e),this.resetOffset()}resetBRLAreaOffset(){let t=this.data.getSelectedRect(),e=this.data.getClipboardRect();d.call(this,t),g.call(this,t),m.call(this,e),p.call(this,e),this.resetOffset()}set(t,e,i=!0){let{data:s}=this,l=s.calSelectedRangeByStart(t,e),{sri:r,sci:n}=l;if(i){let[i,l]=[t,e];t<0&&(i=0),e<0&&(l=0),s.selector.setIndexes(i,l),this.indexes=[i,l]}this.moveIndexes=[r,n],this.range=l,this.resetAreaOffset(),this.el.show()}setEnd(t,e,i=!0){let{data:s,lastri:l,lastci:r}=this;if(i){if(t===l&&e===r)return;this.lastri=t,this.lastci=e}this.range=s.calSelectedRangeByEnd(t,e),x.call(this,this.data.getSelectedRect())}reset(){let{eri:t,eci:e}=this.data.selector.range;this.setEnd(t,e)}showAutofill(t,e){if(-1===t&&-1===e)return;let{sri:i,sci:s,eri:l,eci:n}=this.range,[h,d]=[t,e],u=i-t,f=s-e,g=l-t,p=n-e;if(f>0)this.arange=new r.CellRange(i,d,l,s-1);else if(u>0)this.arange=new r.CellRange(h,s,i-1,n);else if(p<0)this.arange=new r.CellRange(i,n+1,l,d);else if(g<0)this.arange=new r.CellRange(l+1,s,h,n);else{this.arange=null;return}if(null!==this.arange){let t=this.data.getRect(this.arange);t.width+=2,t.height+=2;let{br:e,l:i,t:s,tl:l}=this;e.showAutofill(a.call(this,t)),i.showAutofill(c.call(this,t)),s.showAutofill(o.call(this,t)),l.showAutofill(t)}}hideAutofill(){["br","l","t","tl"].forEach(t=>{this[t].hideAutofill()})}showClipboard(){let t=this.data.getClipboardRect();b.call(this,t),["br","l","t","tl"].forEach(t=>{this[t].showClipboard()})}hideClipboard(){["br","l","t","tl"].forEach(t=>{this[t].hideClipboard()})}}},2367:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return X}});var s=i("3129"),l=i("1092"),r=i("4817"),n=i("3498"),h=i("3782"),a=i("8942"),o=i("6243"),c=i("3015"),d=i("9498"),u=i("8846"),f=i("8532"),g=i("8288"),p=i("2402"),m=i("91"),v=i("4913");function w(t,e){let i;return(...s)=>{let l=this;!i&&(i=setTimeout(()=>{i=null,t.apply(l,s)},e))}}function x(){let{data:t,verticalScrollbar:e,horizontalScrollbar:i}=this,{l:s,t:l,left:r,top:n,width:h,height:a}=t.getSelectedRect(),o=this.getTableOffset();if(Math.abs(r)+h>o.width)i.move({left:s+h-o.width});else{let e=t.freezeTotalWidth();r<e&&i.move({left:s-1-e})}if(Math.abs(n)+a>o.height)e.move({top:l+a-o.height-1});else{let i=t.freezeTotalHeight();n<i&&e.move({top:l-1-i})}}function b(t,e,i,s=!0,l=!1){if(-1===e&&-1===i)return;let{table:r,selector:n,toolbar:h,data:a,contextMenu:o}=this,c=a.getCell(e,i);t?(n.setEnd(e,i,l),this.trigger("cells-selected",c,n.range)):(n.set(e,i,s),this.trigger("cell-selected",c,e,i)),o.setMode(-1===e||-1===i?"row-col":"range"),h.reset(),r.render()}function y(t,e){let{selector:i,data:s}=this,{rows:l,cols:r}=s,[n,h]=i.indexes,{eri:a,eci:o}=i.range;t&&([n,h]=i.moveIndexes),"left"===e?h>0&&(h-=1):"right"===e?(o!==h&&(h=o),h<r.len-1&&(h+=1)):"up"===e?n>0&&(n-=1):"down"===e?(a!==n&&(n=a),n<l.len-1&&(n+=1)):"row-first"===e?h=0:"row-last"===e?h=r.len-1:"col-first"===e?n=0:"col-last"===e&&(n=l.len-1),t&&(i.moveIndexes=[n,h]),b.call(this,t,n,h),x.call(this)}function C(t){if(0!==t.buttons||t.target.className===`${m.cssPrefix}-resizer-hover`)return;let{offsetX:e,offsetY:i}=t,{rowResizer:s,colResizer:l,tableEl:r,data:n}=this,{rows:h,cols:a}=n;if(e>a.indexWidth&&i>h.height){s.hide(),l.hide();return}let o=r.box(),c=n.getCellRectByXY(t.offsetX,t.offsetY);c.ri>=0&&-1===c.ci?(c.width=a.indexWidth,s.show(c,{width:o.width}),h.isHide(c.ri-1)?s.showUnhide(c.ri):s.hideUnhide()):s.hide(),-1===c.ri&&c.ci>=0?(c.height=h.height,l.show(c,{height:o.height}),a.isHide(c.ci-1)?l.showUnhide(c.ci):l.hideUnhide()):l.hide()}function k(t){let{verticalScrollbar:e,horizontalScrollbar:i,data:s}=this,{top:l}=e.scroll(),{left:r}=i.scroll(),{rows:n,cols:h}=s,{deltaY:a,deltaX:o}=t,c=(t,e)=>{let i=t,s=0;do s=e(i),i+=1;while(s<=0);return s},d=t=>{if(t>0){let t=s.scroll.ri+1;if(t<n.len){let i=c(t,t=>n.getHeight(t));e.move({top:l+i-1})}}else{let t=s.scroll.ri-1;if(t>=0){let i=c(t,t=>n.getHeight(t));e.move({top:0===t?0:l-i})}}},u=Math.abs(a),f=Math.abs(o),g=Math.max(u,f);/Firefox/i.test(window.navigator.userAgent)&&w(d(t.detail),50),g===f&&w((t=>{if(t>0){let t=s.scroll.ci+1;if(t<h.len){let e=c(t,t=>h.getWidth(t));i.move({left:r+e-1})}}else{let t=s.scroll.ci-1;if(t>=0){let e=c(t,t=>h.getWidth(t));i.move({left:0===t?0:r-e})}}})(o),50),g===u&&w(d(a),50)}function E(t,e){let{verticalScrollbar:i,horizontalScrollbar:s}=this,{top:l}=i.scroll(),{left:r}=s.scroll();"left"===t||"right"===t?s.move({left:r-e}):("up"===t||"down"===t)&&i.move({top:l-e})}function $(){let{data:t,verticalScrollbar:e}=this,{height:i}=this.getTableOffset(),s=t.exceptRowTotalHeight(0,-1);e.set(i,t.rows.totalHeight()-s)}function S(){let{data:t,horizontalScrollbar:e}=this,{width:i}=this.getTableOffset();t&&e.set(i,t.cols.totalWidth())}function D(){let{selector:t,data:e,editor:i}=this,[s,l]=e.freeze;if(s>0||l>0){let t=e.freezeTotalWidth(),s=e.freezeTotalHeight();i.setFreezeLengths(t,s)}t.resetAreaOffset()}function P(){let{tableEl:t,overlayerEl:e,overlayerCEl:i,table:s,toolbar:l,selector:r,el:n}=this,h=this.getTableOffset(),a=this.getRect();t.attr(a),e.offset(a),i.offset(h),n.css("width",`${a.width}px`),$.call(this),S.call(this),D.call(this),s.render(),l.reset(),r.reset()}function T(){let{data:t,selector:e}=this;t.clearClipboard(),e.hideClipboard()}function R(t){let{data:e,selector:i}=this;"read"!==e.settings.mode&&(e.copy(),e.copyToSystemClipboard(t),i.showClipboard())}function O(){let{data:t,selector:e}=this;"read"!==t.settings.mode&&(t.cut(),e.showClipboard())}function A(t,e){let{data:i}=this;if("read"!==i.settings.mode){if(i.clipboard.isClear())i.pasteFromSystemClipboard(()=>P.call(this),t=>{this.trigger("pasted-clipboard",t)});else if(i.paste(t,t=>(0,p.xtoast)("Tip",t)))P.call(this);else if(e){let t=e.clipboardData.getData("text/plain");this.data.pasteFromText(t),P.call(this)}}}function z(){this.data.hideRowsOrCols(),P.call(this)}function I(t,e){this.data.unhideRowsOrCols(t,e),P.call(this)}function H(){let{data:t}=this;t.autofilter(),P.call(this)}function F(){let{toolbar:t}=this;t.paintformatActive()&&(A.call(this,"format"),T.call(this),t.paintformatToggle())}function M(t){let{selector:e,data:i,table:s,sortFilter:r}=this,{offsetX:n,offsetY:h}=t,a=t.target.className===`${m.cssPrefix}-selector-corner`,o=i.getCellRectByXY(n,h),{left:c,top:d,width:u,height:f}=o,{ri:g,ci:v}=o,{autoFilter:w}=i;if(w.includes(g,v)&&c+u-20<n&&d+f-20<h){let t=w.items(v,(t,e)=>i.rows.getCell(t,e));r.hide(),r.set(v,t,w.getFilter(v),w.getSort(v)),r.setOffset({left:c,top:d+f+2});return}!t.shiftKey&&(a?e.showAutofill(g,v):b.call(this,!1,g,v),(0,l.mouseMoveUp)(window,t=>{({ri:g,ci:v}=i.getCellRectByXY(t.offsetX,t.offsetY)),a?e.showAutofill(g,v):1===t.buttons&&!t.shiftKey&&b.call(this,!0,g,v,!0,!0)},()=>{a&&e.arange&&"read"!==i.settings.mode&&i.autofill(e.arange,"all",t=>(0,p.xtoast)("Tip",t))&&s.render(),e.hideAutofill(),F.call(this)})),!a&&1===t.buttons&&t.shiftKey&&b.call(this,!0,g,v)}function N(){let{editor:t,data:e}=this,i=e.getSelectedRect(),s=this.getTableOffset(),l="top";i.top>s.height/2&&(l="bottom"),t.setOffset(i,l)}function W(){let{editor:t,data:e}=this;"read"!==e.settings.mode&&(N.call(this),t.setCell(e.getSelectedCell(),e.getSelectedValidator()),T.call(this))}function _(t){let{data:e,table:i,selector:s}=this;e.scrolly(t,()=>{s.resetBRLAreaOffset(),N.call(this),i.render()})}function V(t){let{data:e,table:i,selector:s}=this;e.scrollx(t,()=>{s.resetBRTAreaOffset(),N.call(this),i.render()})}function q(t,e){let{ri:i}=t,{table:s,selector:l,data:r}=this,{sri:n,eri:h}=l.range;if(i>=n&&i<=h)for(let t=n;t<=h;t+=1)r.rows.setHeight(t,e);else r.rows.setHeight(i,e);s.render(),l.resetAreaOffset(),$.call(this),N.call(this)}function B(t,e){let{ci:i}=t,{table:s,selector:l,data:r}=this,{sci:n,eci:h}=l.range;if(i>=n&&i<=h)for(let t=n;t<=h;t+=1)r.cols.setWidth(t,e);else r.cols.setWidth(i,e);s.render(),l.resetAreaOffset(),S.call(this),N.call(this)}function j(t,e="finished"){let{data:i,table:s}=this;if("read"===i.settings.mode)return;i.setSelectedCellText(t,e);let{ri:l,ci:r}=i.selector;"finished"===e?s.render():this.trigger("cell-edited",t,l,r)}function L(t){let{data:e}=this;"read"!==e.settings.mode&&("insert-row"===t?e.insert("row"):"delete-row"===t?e.delete("row"):"insert-column"===t?e.insert("column"):"delete-column"===t?e.delete("column"):"delete-cell"===t?e.deleteCell():"delete-cell-format"===t?e.deleteCell("format"):"delete-cell-text"===t?e.deleteCell("text"):"cell-printable"===t?e.setSelectedCellAttr("printable",!0):"cell-non-printable"===t?e.setSelectedCellAttr("printable",!1):"cell-editable"===t?e.setSelectedCellAttr("editable",!0):"cell-non-editable"===t&&e.setSelectedCellAttr("editable",!1),T.call(this),P.call(this))}function U(t,e){let{data:i}=this;if("undo"===t)this.undo();else if("redo"===t)this.redo();else if("print"===t)this.print.preview();else if("paintformat"===t)!0===e?R.call(this):T.call(this);else if("clearformat"===t)L.call(this,"delete-cell-format");else if("link"===t);else if("chart"===t);else if("autofilter"===t)H.call(this);else if("freeze"===t){if(e){let{ri:t,ci:e}=i.selector;this.freeze(t,e)}else this.freeze(0,0)}else i.setSelectedCellAttr(t,e),"formula"===t&&!i.selector.multiple()&&W.call(this),P.call(this)}function Y(t,e,i,s){this.data.setAutoFilter(t,e,i,s),P.call(this)}function Z(){let{selector:t,overlayerEl:e,rowResizer:i,colResizer:s,verticalScrollbar:r,horizontalScrollbar:n,editor:h,contextMenu:a,toolbar:o,modalValidation:c,sortFilter:d}=this;e.on("mousemove",t=>{C.call(this,t)}).on("mousedown",t=>{h.clear(),a.hide(),2===t.buttons?(this.data.xyInSelectedRect(t.offsetX,t.offsetY)||M.call(this,t),a.setPosition(t.offsetX,t.offsetY),t.stopPropagation()):2===t.detail?W.call(this):M.call(this,t)}).on("mousewheel.stop",t=>{k.call(this,t)}).on("mouseout",t=>{let{offsetX:e,offsetY:l}=t;l<=0&&s.hide(),e<=0&&i.hide()}),t.inputChange=t=>{j.call(this,t,"input"),W.call(this)},(0,l.bindTouch)(e.el,{move:(t,e)=>{E.call(this,t,e)}}),o.change=(t,e)=>U.call(this,t,e),d.ok=(t,e,i,s)=>Y.call(this,t,e,i,s),i.finishedFn=(t,e)=>{q.call(this,t,e)},s.finishedFn=(t,e)=>{B.call(this,t,e)},i.unhideFn=t=>{I.call(this,"row",t)},s.unhideFn=t=>{I.call(this,"col",t)},r.moveFn=(t,e)=>{_.call(this,t,e)},n.moveFn=(t,e)=>{V.call(this,t,e)},h.change=(t,e)=>{j.call(this,e,t)},c.change=(t,...e)=>{"save"===t?this.data.addValidation(...e):this.data.removeValidation()},a.itemClick=t=>{"validation"===t?c.setValue(this.data.getSelectedValidation()):"copy"===t?R.call(this):"cut"===t?O.call(this):"paste"===t?A.call(this,"all"):"paste-value"===t?A.call(this,"text"):"paste-format"===t?A.call(this,"format"):"hide"===t?z.call(this):L.call(this,t)},(0,l.bind)(window,"resize",()=>{this.reload()}),(0,l.bind)(window,"click",t=>{this.focusing=e.contains(t.target)}),(0,l.bind)(window,"paste",t=>{this.focusing&&(A.call(this,"all",t),t.preventDefault())}),(0,l.bind)(window,"copy",t=>{this.focusing&&(R.call(this,t),t.preventDefault())}),(0,l.bind)(window,"keydown",t=>{if(!this.focusing)return;let e=t.keyCode||t.which,{key:i,ctrlKey:s,shiftKey:l,metaKey:r}=t;if(s||r)switch(e){case 90:this.undo(),t.preventDefault();break;case 89:this.redo(),t.preventDefault();break;case 67:case 86:break;case 88:O.call(this),t.preventDefault();break;case 85:o.trigger("underline"),t.preventDefault();break;case 37:y.call(this,l,"row-first"),t.preventDefault();break;case 38:y.call(this,l,"col-first"),t.preventDefault();break;case 39:y.call(this,l,"row-last"),t.preventDefault();break;case 40:y.call(this,l,"col-last"),t.preventDefault();break;case 32:b.call(this,!1,-1,this.data.selector.ci,!1),t.preventDefault();break;case 66:o.trigger("bold");break;case 73:o.trigger("italic")}else{switch(e){case 32:l&&b.call(this,!1,this.data.selector.ri,-1,!1);break;case 27:a.hide(),T.call(this);break;case 37:y.call(this,l,"left"),t.preventDefault();break;case 38:y.call(this,l,"up"),t.preventDefault();break;case 39:y.call(this,l,"right"),t.preventDefault();break;case 40:y.call(this,l,"down"),t.preventDefault();break;case 9:h.clear(),y.call(this,!1,l?"left":"right"),t.preventDefault();break;case 13:h.clear(),y.call(this,!1,l?"up":"down"),t.preventDefault();break;case 8:L.call(this,"delete-cell-text"),t.preventDefault()}"Delete"===i?(L.call(this,"delete-cell-text"),t.preventDefault()):e>=65&&e<=90||e>=48&&e<=57||e>=96&&e<=105||"="===t.key?(j.call(this,t.key,"input"),W.call(this)):113===e&&W.call(this)}})}class X{constructor(t,e){this.eventMap=(0,l.createEventEmitter)();let{view:i,showToolbar:p,showContextmenu:w}=e.settings;this.el=(0,s.h)("div",`${m.cssPrefix}-sheet`),this.toolbar=new u.default(e,i.width,!p),this.print=new o.default(e),t.children(this.toolbar.el,this.el,this.print.el),this.data=e,this.tableEl=(0,s.h)("canvas",`${m.cssPrefix}-table`),this.rowResizer=new r.default(!1,e.rows.height),this.colResizer=new r.default(!0,e.cols.minWidth),this.verticalScrollbar=new n.default(!0),this.horizontalScrollbar=new n.default(!1),this.editor=new a.default(v.formulas,()=>this.getTableOffset(),e.rows.height),this.modalValidation=new f.default,this.contextMenu=new c.default(()=>this.getRect(),!w),this.selector=new h.default(e),this.overlayerCEl=(0,s.h)("div",`${m.cssPrefix}-overlayer-content`).children(this.editor.el,this.selector.el),this.overlayerEl=(0,s.h)("div",`${m.cssPrefix}-overlayer`).child(this.overlayerCEl),this.sortFilter=new g.default,this.el.children(this.tableEl,this.overlayerEl.el,this.rowResizer.el,this.colResizer.el,this.verticalScrollbar.el,this.horizontalScrollbar.el,this.contextMenu.el,this.modalValidation.el,this.sortFilter.el),this.table=new d.default(this.tableEl.el,e),Z.call(this),P.call(this),b.call(this,!1,0,0)}on(t,e){return this.eventMap.on(t,e),this}trigger(t,...e){let{eventMap:i}=this;i.fire(t,e)}resetData(t){this.editor.clear(),this.data=t,$.call(this),S.call(this),this.toolbar.resetData(t),this.print.resetData(t),this.selector.resetData(t),this.table.resetData(t)}loadData(t){return this.data.setData(t),P.call(this),this}freeze(t,e){let{data:i}=this;return i.setFreeze(t,e),P.call(this),this}undo(){this.data.undo(),P.call(this)}redo(){this.data.redo(),P.call(this)}reload(){return P.call(this),this}getRect(){let{data:t}=this;return{width:t.viewWidth(),height:t.viewHeight()}}getTableOffset(){let{rows:t,cols:e}=this.data,{width:i,height:s}=this.getRect();return{width:i-e.indexWidth,height:s-t.height,left:e.indexWidth,top:t.height}}}},8288:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return u}});var s=i("3129"),l=i("5339"),r=i("1092"),n=i("91"),h=i("2182");function a(t){return(0,s.h)("div",`${n.cssPrefix}-item ${t}`)}function o(t){return a("state").child((0,h.t)(`sort.${t}`)).on("click.stop",()=>this.itemClick(t))}function c(t){let{filterbEl:e,filterValues:i}=this;e.html(""),Object.keys(t).forEach((l,r)=>{let a=t[l],o=i.includes(l)?"checked":"";e.child((0,s.h)("div",`${n.cssPrefix}-item state ${o}`).on("click.stop",()=>this.filterClick(r,l)).children(""===l?(0,h.t)("filter.empty"):l,(0,s.h)("div","label").html(`(${a})`)))})}function d(){let{filterhEl:t,filterValues:e,values:i}=this;t.html(`${e.length} / ${i.length}`),t.checked(e.length===i.length)}class u{constructor(){this.filterbEl=(0,s.h)("div",`${n.cssPrefix}-body`),this.filterhEl=(0,s.h)("div",`${n.cssPrefix}-header state`).on("click.stop",()=>this.filterClick(0,"all")),this.el=(0,s.h)("div",`${n.cssPrefix}-sort-filter`).children(this.sortAscEl=o.call(this,"asc"),this.sortDescEl=o.call(this,"desc"),a("divider"),(0,s.h)("div",`${n.cssPrefix}-filter`).children(this.filterhEl,this.filterbEl),(0,s.h)("div",`${n.cssPrefix}-buttons`).children(new l.default("cancel").on("click",()=>this.btnClick("cancel")),new l.default("ok","primary").on("click",()=>this.btnClick("ok")))).hide(),this.ci=null,this.sortDesc=null,this.values=null,this.filterValues=[]}btnClick(t){if("ok"===t){let{ci:t,sort:e,filterValues:i}=this;this.ok&&this.ok(t,e,"in",i)}this.hide()}itemClick(t){this.sort=t;let{sortAscEl:e,sortDescEl:i}=this;e.checked("asc"===t),i.checked("desc"===t)}filterClick(t,e){let{filterbEl:i,filterValues:l,values:r}=this,n=i.children();"all"===e?n.length===l.length?(this.filterValues=[],n.forEach(t=>(0,s.h)(t).checked(!1))):(this.filterValues=Array.from(r),n.forEach(t=>(0,s.h)(t).checked(!0))):(0,s.h)(n[t]).toggle("checked")?l.push(e):l.splice(l.findIndex(t=>t===e),1),d.call(this)}set(t,e,i,s){this.ci=t;let{sortAscEl:l,sortDescEl:r}=this;null!==s?(this.sort=s.order,l.checked(s.asc()),r.checked(s.desc())):(this.sortDesc=null,l.checked(!1),r.checked(!1)),this.values=Object.keys(e),this.filterValues=i?Array.from(i.value):Object.keys(e),c.call(this,e,i),d.call(this)}setOffset(t){this.el.offset(t).show();let e=1;(0,r.bindClickoutside)(this.el,()=>{e<=0&&this.hide(),e-=1})}show(){this.el.show()}hide(){this.el.hide(),(0,r.unbindClickoutside)(this.el)}}},4242:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return c}});var s=i("3129"),l=i("1092"),r=i("91");function n(t){t.preventDefault(),t.stopPropagation();let{filterItems:e}=this;!(e.length<=0)&&(this.itemIndex>=0&&e[this.itemIndex].toggle(),this.itemIndex-=1,this.itemIndex<0&&(this.itemIndex=e.length-1),e[this.itemIndex].toggle())}function h(t){t.stopPropagation();let{filterItems:e}=this;!(e.length<=0)&&(this.itemIndex>=0&&e[this.itemIndex].toggle(),this.itemIndex+=1,this.itemIndex>e.length-1&&(this.itemIndex=0),e[this.itemIndex].toggle())}function a(t){t.preventDefault();let{filterItems:e}=this;!(e.length<=0)&&(t.stopPropagation(),this.itemIndex<0&&(this.itemIndex=0),e[this.itemIndex].el.click(),this.hide())}function o(t){let{keyCode:e}=t;switch(t.ctrlKey&&t.stopPropagation(),e){case 37:case 39:t.stopPropagation();break;case 38:n.call(this,t);break;case 40:h.call(this,t);break;case 13:case 9:a.call(this,t);break;default:t.stopPropagation()}}class c{constructor(t,e,i="200px"){this.filterItems=[],this.items=t,this.el=(0,s.h)("div",`${r.cssPrefix}-suggest`).css("width",i).hide(),this.itemClick=e,this.itemIndex=-1}setOffset(t){this.el.cssRemoveKeys("top","bottom").offset(t)}hide(){let{el:t}=this;this.filterItems=[],this.itemIndex=-1,t.hide(),(0,l.unbindClickoutside)(this.el.parent())}setItems(t){this.items=t}search(t){let{items:e}=this;if(!/^\s*$/.test(t)&&(e=e.filter(e=>(e.key||e).startsWith(t.toUpperCase()))),e=e.map(t=>{let{title:e}=t;e?"function"==typeof e&&(e=e()):e=t;let i=(0,s.h)("div",`${r.cssPrefix}-item`).child(e).on("click.stop",()=>{this.itemClick(t),this.hide()});return t.label&&i.child((0,s.h)("div","label").html(t.label)),i}),this.filterItems=e,e.length<=0)return;let{el:i}=this;i.html("").children(...e).show(),(0,l.bindClickoutside)(i.parent(),()=>{this.hide()})}bindInputEvents(t){t.on("keydown",t=>o.call(this,t))}}},9498:function(t,e,i){"use strict";i.r(e),i.d(e,{renderCell:function(){return u},default:function(){return b}});var s=i("2014"),l=i("1933"),r=i("8259"),n=i("4913"),h=i("5854"),a=i("6293");let o={fillStyle:"#f4f5f8"},c={fillStyle:"#fff",lineWidth:a.thinLineWidth,strokeStyle:"#e6e6e6"};function d(t,e,i,s=0){let{left:l,top:r,width:n,height:h}=t.cellRect(e,i);return new a.DrawBox(l,r+s,n,h,5)}function u(t,e,i,s,a=0){let{sortedRowMap:o,rows:c,cols:u}=e;if(c.isHide(i)||u.isHide(s))return;let f=i;o.has(i)&&(f=o.get(i));let g=e.getCell(f,s);if(null===g)return;let p=!1;"editable"in g&&!1===g.editable&&(p=!0);let m=e.getCellStyleOrDefault(f,s),v=d(e,i,s,a);v.bgcolor=m.bgcolor,void 0!==m.border&&(v.setBorders(m.border),t.strokeBorders(v)),t.rect(v,()=>{let a="";a=e.settings.evalPaused?g.text||"":r.default.render(g.text||"",n.formulam,(t,i)=>e.getCellTextOrDefault(i,t)),m.format&&(a=(0,h.formatm)[m.format].render(a));let o=Object.assign({},m.font);o.size=(0,l.getFontSizePxByPt)(o.size),t.text(a,v,{align:m.align,valign:m.valign,font:o,color:m.color,strike:m.strike,underline:m.underline},m.textwrap),e.validations.getError(i,s)&&t.error(v),p&&t.frozen(v)})}function f(t){let{data:e,draw:i}=this;if(t){let{autoFilter:s}=e;if(!s.active())return;let l=s.hrange();t.intersects(l)&&l.each((t,s)=>{let l=d(e,t,s);i.dropdown(l)})}}function g(t,e,i,s,l){let{draw:r,data:n}=this;r.save(),r.translate(e,i).translate(s,l);let{exceptRowSet:h}=n,a=t=>{let e=h.has(t);if(e){let e=n.rows.getHeight(t);r.translate(0,-e)}return!e},o=n.exceptRowTotalHeight(t.sri,t.eri);r.save(),r.translate(0,-o),t.each((t,e)=>{u(r,n,t,e)},t=>a(t)),r.restore();let c=new Set;r.save(),r.translate(0,-o),n.eachMergesInView(t,({sri:t,sci:e,eri:i})=>{if(h.has(t)){if(!c.has(t)){c.add(t);let e=n.rows.sumHeight(t,i+1);r.translate(0,-e)}}else u(r,n,t,e)}),r.restore(),f.call(this,t),r.restore()}function p(t,e,i,s){let{draw:l}=this;l.save(),l.attr({fillStyle:"rgba(75, 137, 255, 0.08)"}).fillRect(t,e,i,s),l.restore()}function m(t,e,i,l,r,n){let{draw:h,data:c}=this,d=e.h,u=e.w,f=n+l,g=r+i;h.save(),h.attr(o),("all"===t||"left"===t)&&h.fillRect(0,f,i,d),("all"===t||"top"===t)&&h.fillRect(g,0,u,l);let{sri:m,sci:v,eri:w,eci:x}=c.selector.range;h.attr({textAlign:"center",textBaseline:"middle",font:`500 ${(0,a.npx)(12)}px Source Sans Pro`,fillStyle:"#585757",lineWidth:(0,a.thinLineWidth)(),strokeStyle:"#e6e6e6"}),("all"===t||"left"===t)&&(c.rowEach(e.sri,e.eri,(t,e,s)=>{let l=f+e;h.line([0,l],[i,l]),m<=t&&t<w+1&&p.call(this,0,l,i,s),h.fillText(t+1,i/2,l+s/2),t>0&&c.rows.isHide(t-1)&&(h.save(),h.attr({strokeStyle:"#c6c6c6"}),h.line([5,l+5],[i-5,l+5]),h.restore())}),h.line([0,d+f],[i,d+f]),h.line([i,f],[i,d+f])),("all"===t||"top"===t)&&(c.colEach(e.sci,e.eci,(t,e,i)=>{let r=g+e;h.line([r,0],[r,l]),v<=t&&t<x+1&&p.call(this,r,0,i,l),h.fillText((0,s.stringAt)(t),r+i/2,l/2),t>0&&c.cols.isHide(t-1)&&(h.save(),h.attr({strokeStyle:"#c6c6c6"}),h.line([r+5,5],[r+5,l-5]),h.restore())}),h.line([u+g,0],[u+g,l]),h.line([0,l],[u+g,l])),h.restore()}function v(t,e){let{draw:i}=this;i.save(),i.attr({fillStyle:"#f4f5f8"}).fillRect(0,0,t,e),i.restore()}function w({sri:t,sci:e,eri:i,eci:s,w:l,h:r},n,h,a,o){let{draw:d,data:u}=this,{settings:f}=u;if(d.save(),d.attr(c).translate(n+a,h+o),!f.showGrid){d.restore();return}u.rowEach(t,i,(e,s,r)=>{e!==t&&d.line([0,s],[l,s]),e===i&&d.line([0,s+r],[l,s+r])}),u.colEach(e,s,(t,i,l)=>{t!==e&&d.line([i,0],[i,r]),t===s&&d.line([i+l,0],[i+l,r])}),d.restore()}function x(t,e,i,s){let{draw:l,data:r}=this,n=r.viewWidth()-t,h=r.viewHeight()-e;l.save().translate(t,e).attr({strokeStyle:"rgba(75, 137, 255, .6)"}),l.line([0,s],[n,s]),l.line([i,0],[i,h]),l.restore()}var b=class t{constructor(t,e){this.el=t,this.draw=new a.Draw(t,e.viewWidth(),e.viewHeight()),this.data=e}resetData(t){this.data=t,this.render()}render(){let{data:t}=this,{rows:e,cols:i}=t,s=i.indexWidth,l=e.height;this.draw.resize(t.viewWidth(),t.viewHeight()),this.clear();let r=t.viewRange(),n=t.freezeTotalWidth(),h=t.freezeTotalHeight(),{x:a,y:o}=t.scroll;w.call(this,r,s,l,n,h),g.call(this,r,s,l,-a,-o),m.call(this,"all",r,s,l,n,h),v.call(this,s,l);let[c,d]=t.freeze;if(c>0||d>0){if(c>0){let t=r.clone();t.sri=0,t.eri=c-1,t.h=h,w.call(this,t,s,l,n,0),g.call(this,t,s,l,-a,0),m.call(this,"top",t,s,l,n,0)}if(d>0){let t=r.clone();t.sci=0,t.eci=d-1,t.w=n,w.call(this,t,s,l,0,h),m.call(this,"left",t,s,l,0,h),g.call(this,t,s,l,0,-o)}let e=t.freezeViewRange();w.call(this,e,s,l,0,0),m.call(this,"all",e,s,l,0,0),g.call(this,e,s,l,0,0),x.call(this,s,l,n,h)}}clear(){this.draw.clear()}}},5617:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return r}});var s=i("8927"),l=i("5775");class r extends s.default{constructor(t){super("align","",t)}dropdown(){let{value:t}=this;return new l.default(["left","center","right"],t)}}},9893:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return l}});var s=i("1006");class l extends s.default{constructor(){super("autofilter")}setState(){}}},2700:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return l}});var s=i("1006");class l extends s.default{constructor(){super("font-bold","Ctrl+B")}}},4713:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return r}});var s=i("8927"),l=i("8554");class r extends s.default{constructor(){super("border")}dropdown(){return new l.default}}},716:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return l}});var s=i("8209");class l extends s.default{constructor(){super("clearformat")}}},8927:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return l}});var s=i("4965");class l extends s.default{dropdown(){}getValue(t){return t}element(){let{tag:t}=this;return this.dd=this.dropdown(),this.dd.change=e=>this.change(t,this.getValue(e)),super.element().child(this.dd)}setState(t){t&&(this.value=t,this.dd.setTitle(t))}}},7738:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return r}});var s=i("8927"),l=i("9074");class r extends s.default{constructor(t){super("bgcolor",void 0,t)}dropdown(){let{tag:t,value:e}=this;return new l.default(t,e)}}},8234:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return r}});var s=i("8927"),l=i("1589");class r extends s.default{constructor(){super("font-name")}getValue(t){return t.key}dropdown(){return new l.default}}},8397:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return r}});var s=i("8927"),l=i("8667");class r extends s.default{constructor(){super("font-size")}getValue(t){return t.pt}dropdown(){return new l.default}}},4362:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return r}});var s=i("8927"),l=i("653");class r extends s.default{constructor(){super("format")}getValue(t){return t.key}dropdown(){return new l.default}}},9859:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return r}});var s=i("8927"),l=i("2196");class r extends s.default{constructor(){super("formula")}getValue(t){return t.key}dropdown(){return new l.default}}},3538:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return l}});var s=i("1006");class l extends s.default{constructor(){super("freeze")}}},8209:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return r}});var s=i("4965"),l=i("9992");class r extends s.default{element(){return super.element().child(new l.default(this.tag)).on("click",()=>this.change(this.tag))}setState(t){this.el.disabled(t)}}},8846:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return I}});var s=i("5617"),l=i("3585"),r=i("9893"),n=i("2700"),h=i("4617"),a=i("6633"),o=i("416"),c=i("4713"),d=i("716"),u=i("6979"),f=i("7569"),g=i("7738"),p=i("8397"),m=i("8234"),v=i("4362"),w=i("9859"),x=i("3538"),b=i("2413"),y=i("544"),C=i("2498"),k=i("786"),E=i("1251"),$=i("2505"),S=i("4965"),D=i("3129"),P=i("91"),T=i("1092");function R(){return(0,D.h)("div",`${P.cssPrefix}-toolbar-divider`)}function O(){this.btns2=[],this.items.forEach(t=>{if(Array.isArray(t))t.forEach(({el:t})=>{let e=t.box(),{marginLeft:i,marginRight:s}=t.computedStyle();this.btns2.push([t,e.width+parseInt(i,10)+parseInt(s,10)])});else{let e=t.box(),{marginLeft:i,marginRight:s}=t.computedStyle();this.btns2.push([t,e.width+parseInt(i,10)+parseInt(s,10)])}})}function A(){let{el:t,btns:e,moreEl:i,btns2:s}=this,{moreBtns:l,contentEl:r}=i.dd;t.css("width",`${this.widthFn()}px`);let n=t.box(),h=160,a=12,o=[],c=[];s.forEach(([t,e],i)=>{h+=e,i===s.length-1||h<n.width?o.push(t):(a+=e,c.push(t))}),e.html("").children(...o),l.html("").children(...c),r.css("width",`${a}px`),c.length>0?i.show():i.hide()}function z(t){let e=new S.default;e.el.on("click",()=>{t.onClick&&t.onClick(this.data.getData(),this.data)}),e.tip=t.tip||"";let{el:i}=t;if(t.icon&&(i=(0,D.h)("img").attr("src",t.icon)),i){let t=(0,D.h)("div",`${P.cssPrefix}-icon`);t.child(i),e.el.child(t)}return e}class I{constructor(t,e,i=!1){this.data=t,this.change=()=>{},this.widthFn=e,this.isHide=i;let S=t.defaultStyle();this.items=[[this.undoEl=new C.default,this.redoEl=new y.default,new k.default,this.paintformatEl=new u.default,this.clearformatEl=new d.default],R(),[this.formatEl=new v.default],R(),[this.fontEl=new m.default,this.fontSizeEl=new p.default],R(),[this.boldEl=new n.default,this.italicEl=new h.default,this.underlineEl=new o.default,this.strikeEl=new a.default,this.textColorEl=new f.default(S.color)],R(),[this.fillColorEl=new g.default(S.bgcolor),this.borderEl=new c.default,this.mergeEl=new b.default],R(),[this.alignEl=new s.default(S.align),this.valignEl=new l.default(S.valign),this.textwrapEl=new E.default],R(),[this.freezeEl=new x.default,this.autofilterEl=new r.default,this.formulaEl=new w.default]];let{extendToolbar:I={}}=t.settings;if(I.left&&I.left.length>0){this.items.unshift(R());let t=I.left.map(z.bind(this));this.items.unshift(t)}if(I.right&&I.right.length>0){this.items.push(R());let t=I.right.map(z.bind(this));this.items.push(t)}this.items.push([this.moreEl=new $.default]),this.el=(0,D.h)("div",`${P.cssPrefix}-toolbar`),this.btns=(0,D.h)("div",`${P.cssPrefix}-toolbar-btns`),this.items.forEach(t=>{Array.isArray(t)?t.forEach(t=>{this.btns.child(t.el),t.change=(...t)=>{this.change(...t)}}):this.btns.child(t.el)}),this.el.child(this.btns),i?this.el.hide():(this.reset(),setTimeout(()=>{O.call(this),A.call(this)},0),(0,T.bind)(window,"resize",()=>{A.call(this)}))}paintformatActive(){return this.paintformatEl.active()}paintformatToggle(){this.paintformatEl.toggle()}trigger(t){this[`${t}El`].click()}resetData(t){this.data=t,this.reset()}reset(){if(this.isHide)return;let{data:t}=this,e=t.getSelectedCellStyle();this.undoEl.setState(!t.canUndo()),this.redoEl.setState(!t.canRedo()),this.mergeEl.setState(t.canUnmerge(),!t.selector.multiple()),this.autofilterEl.setState(!t.canAutofilter());let{font:i,format:s}=e;this.formatEl.setState(s),this.fontEl.setState(i.name),this.fontSizeEl.setState(i.size),this.boldEl.setState(i.bold),this.italicEl.setState(i.italic),this.underlineEl.setState(e.underline),this.strikeEl.setState(e.strike),this.textColorEl.setState(e.color),this.fillColorEl.setState(e.bgcolor),this.alignEl.setState(e.align),this.valignEl.setState(e.valign),this.textwrapEl.setState(e.textwrap),this.freezeEl.setState(t.freezeIsActive())}}},4617:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return l}});var s=i("1006");class l extends s.default{constructor(){super("font-italic","Ctrl+I")}}},4965:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return h}});var s=i("91"),l=i("5417"),r=i("3129"),n=i("2182");class h{constructor(t,e,i){this.tip="",t&&(this.tip=(0,n.t)(`toolbar.${t.replace(/-[a-z]/g,t=>t[1].toUpperCase())}`)),e&&(this.tip+=` (${e})`),this.tag=t,this.shortcut=e,this.value=i,this.el=this.element(),this.change=()=>{}}element(){let{tip:t}=this;return(0,r.h)("div",`${s.cssPrefix}-toolbar-btn`).on("mouseenter",t=>{this.tip&&(0,l.default)(this.tip,t.target)}).attr("data-tooltip",t)}setState(){}}},2413:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return l}});var s=i("1006");class l extends s.default{constructor(){super("merge")}setState(t,e){this.el.active(t).disabled(e)}}},2505:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return o}});var s=i("450"),l=i("8927"),r=i("91"),n=i("3129"),h=i("9992");class a extends s.default{constructor(){let t=new h.default("ellipsis"),e=(0,n.h)("div",`${r.cssPrefix}-toolbar-more`);super(t,"auto",!1,"bottom-right",e),this.moreBtns=e,this.contentEl.css("max-width","420px")}}class o extends l.default{constructor(){super("more"),this.el.hide()}dropdown(){return new a}show(){this.el.show()}hide(){this.el.hide()}}},6979:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return l}});var s=i("1006");class l extends s.default{constructor(){super("paintformat")}setState(){}}},786:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return l}});var s=i("8209");class l extends s.default{constructor(){super("print","Ctrl+P")}}},544:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return l}});var s=i("8209");class l extends s.default{constructor(){super("redo","Ctrl+Y")}}},6633:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return l}});var s=i("1006");class l extends s.default{constructor(){super("strike","Ctrl+U")}}},7569:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return r}});var s=i("8927"),l=i("9074");class r extends s.default{constructor(t){super("color",void 0,t)}dropdown(){let{tag:t,value:e}=this;return new l.default(t,e)}}},1251:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return l}});var s=i("1006");class l extends s.default{constructor(){super("textwrap")}}},1006:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return r}});var s=i("4965"),l=i("9992");class r extends s.default{element(){let{tag:t}=this;return super.element().child(new l.default(t)).on("click",()=>this.click())}click(){this.change(this.tag,this.toggle())}setState(t){this.el.active(t)}toggle(){return this.el.toggle()}active(){return this.el.hasClass("active")}}},416:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return l}});var s=i("1006");class l extends s.default{constructor(){super("underline","Ctrl+U")}}},2498:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return l}});var s=i("8209");class l extends s.default{constructor(){super("undo","Ctrl+Z")}}},3585:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return r}});var s=i("8927"),l=i("5775");class r extends s.default{constructor(t){super("valign","",t)}dropdown(){let{value:t}=this;return new l.default(["top","middle","bottom"],t)}}},5417:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return n}});var s=i("3129"),l=i("1092"),r=i("91");function n(t,e){if(e.classList.contains("active"))return;let{left:i,top:n,width:h,height:a}=e.getBoundingClientRect(),o=(0,s.h)("div",`${r.cssPrefix}-tooltip`).html(t).show();document.body.appendChild(o.el);let c=o.box();o.css("left",`${i+h/2-c.width/2}px`).css("top",`${n+a+2}px`),(0,l.bind)(e,"mouseleave",()=>{document.body.contains(o.el)&&document.body.removeChild(o.el)}),(0,l.bind)(e,"click",()=>{document.body.contains(o.el)&&document.body.removeChild(o.el)})}},91:function(t,e,i){"use strict";i.r(e),i.d(e,{cssPrefix:function(){return s}});let s="x-spreadsheet";window.devicePixelRatio},2014:function(t,e,i){"use strict";i.r(e),i.d(e,{stringAt:function(){return l},expr2xy:function(){return r},xy2expr:function(){return n},expr2expr:function(){return h}});let s=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function l(t){let e="",i=t;for(;i>=s.length;)i/=s.length,i-=1,e+=s[parseInt(i,10)%s.length];let l=t%s.length;return e+=s[l]}function r(t){let e="",i="";for(let s=0;s<t.length;s+=1)t.charAt(s)>="0"&&"9">=t.charAt(s)?i+=t.charAt(s):e+=t.charAt(s);return[function(t){let e=0;for(let i=0;i!==t.length;++i)e=26*e+t.charCodeAt(i)-64;return e-1}(e),parseInt(i,10)-1]}function n(t,e){return`${l(t)}${e+1}`}function h(t,e,i,s=()=>!0){if(0===e&&0===i)return t;let[l,h]=r(t);return s(l,h)?n(l+e,h+i):t}},1914:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return n}});var s=i("791");class l{constructor(t,e,i){this.ci=t,this.operator=e,this.value=i}set(t,e){this.operator=t,this.value=e}includes(t){let{operator:e,value:i}=this;return"all"===e||"in"===e&&i.includes(t)}vlength(){let{operator:t,value:e}=this;return"in"===t?e.length:0}getData(){let{ci:t,operator:e,value:i}=this;return{ci:t,operator:e,value:i}}}class r{constructor(t,e){this.ci=t,this.order=e}asc(){return"asc"===this.order}desc(){return"desc"===this.order}}class n{constructor(){this.ref=null,this.filters=[],this.sort=null}setData({ref:t,filters:e,sort:i}){null!=t&&(this.ref=t,this.filters=e.map(t=>new l(t.ci,t.operator,t.value)),i&&(this.sort=new r(i.ci,i.order)))}getData(){if(this.active()){let{ref:t,filters:e,sort:i}=this;return{ref:t,filters:e.map(t=>t.getData()),sort:i}}return{}}addFilter(t,e,i){let s=this.getFilter(t);null==s?this.filters.push(new l(t,e,i)):s.set(e,i)}setSort(t,e){this.sort=e?new r(t,e):null}includes(t,e){return!!this.active()&&this.hrange().includes(t,e)}getSort(t){let{sort:e}=this;return e&&e.ci===t?e:null}getFilter(t){let{filters:e}=this;for(let i=0;i<e.length;i+=1)if(e[i].ci===t)return e[i];return null}filteredRows(t){let e=new Set,i=new Set;if(this.active()){let{sri:s,eri:l}=this.range(),{filters:r}=this;for(let n=s+1;n<=l;n+=1)for(let s=0;s<r.length;s+=1){let l=r[s],h=t(n,l.ci),a=h?h.text:"";if(l.includes(a))i.add(n);else{e.add(n);break}}}return{rset:e,fset:i}}items(t,e){let i={};if(this.active()){let{sri:s,eri:l}=this.range();for(let r=s+1;r<=l;r+=1){let s=e(r,t);if(null===s||/^\s*$/.test(s.text))i[""]=(i[""]||0)+1;else{let t=s.text,e=(i[t]||0)+1;i[t]=e}}}return i}range(){return s.CellRange.valueOf(this.ref)}hrange(){let t=this.range();return t.eri=t.sri,t}clear(){this.ref=null,this.filters=[],this.sort=null}active(){return null!==this.ref}}},8259:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return o}});var s=i("2014"),l=i("8666");let r=t=>{let e=[],i=[],l=[],r=0,n="",h=1,a="";for(let o=0;o<t.length;o+=1){let c=t.charAt(o);if(" "!==c){if(c>="a"&&c<="z")l.push(c.toUpperCase());else if(c>="0"&&c<="9"||c>="A"&&c<="Z"||"."===c)l.push(c);else if('"'===c){for(o+=1;'"'!==t.charAt(o);)l.push(t.charAt(o)),o+=1;i.push(`"${l.join("")}`),l=[]}else if("-"===c&&/[+\-*/,(]/.test(a))l.push(c);else{if("("!==c&&l.length>0&&i.push(l.join("")),")"===c){let t=e.pop();if(2===r)try{let[e,l]=(0,s.expr2xy)(i.pop()),[r,n]=(0,s.expr2xy)(i.pop()),h=0;for(let t=r;t<=e;t+=1)for(let e=n;e<=l;e+=1)i.push((0,s.xy2expr)(t,e)),h+=1;i.push([t,h])}catch(t){}else if(1===r||3===r)3===r&&i.push(n),i.push([t,h]),h=1;else for(;"("!==t&&(i.push(t),!(e.length<=0));){;t=e.pop()}r=0}else if("="===c||">"===c||"<"===c){let e=t.charAt(o+1);n=c,("="===e||"-"===e)&&(n+=e,o+=1),r=3}else if(":"===c)r=2;else if(","===c)3===r&&i.push(n),r=1,h+=1;else if("("===c&&l.length>0)e.push(l.join(""));else{if(e.length>0&&("+"===c||"-"===c)){let t=e[e.length-1];if("("!==t&&i.push(e.pop()),"*"===t||"/"===t)for(;e.length>0;)if("("!==(t=e[e.length-1]))i.push(e.pop());else break}else if(e.length>0){let t=e[e.length-1];("*"===t||"/"===t)&&i.push(e.pop())}e.push(c)}l=[]}a=c}}for(l.length>0&&i.push(l.join(""));e.length>0;)i.push(e.pop());return i},n=(t,e)=>{let[i]=t,l=t;if('"'===i)return t.substring(1);let r=1;if("-"===i&&(l=t.substring(1),r=-1),l[0]>="0"&&l[0]<="9")return r*Number(l);let[n,h]=(0,s.expr2xy)(l);return r*e(n,h)},h=(t,e,i,s)=>{let r=[];for(let h=0;h<t.length;h+=1){let a=t[h],o=a[0];if("+"===a){let t=r.pop();r.push((0,l.numberCalc)("+",r.pop(),t))}else if("-"===a){if(1===r.length){let t=r.pop();r.push((0,l.numberCalc)("*",t,-1))}else{let t=r.pop();r.push((0,l.numberCalc)("-",r.pop(),t))}}else if("*"===a)r.push((0,l.numberCalc)("*",r.pop(),r.pop()));else if("/"===a){let t=r.pop();r.push((0,l.numberCalc)("/",r.pop(),t))}else if("="===o||">"===o||"<"===o){let t=r.pop();!Number.isNaN(t)&&(t=Number(t));let e=r.pop();!Number.isNaN(e)&&(e=Number(e));let i=!1;"="===o?i=e===t:">"===a?i=e>t:">="===a?i=e>=t:"<"===a?i=e<t:"<="===a&&(i=e<=t),r.push(i)}else if(Array.isArray(a)){let[t,i]=a,s=[];for(let t=0;t<i;t+=1)s.push(r.pop());r.push(e[t].render(s.reverse()))}else{if(s.includes(a))return 0;(o>="a"&&o<="z"||o>="A"&&o<="Z")&&s.push(a),r.push(n(a,i)),s.pop()}}return r[0]},a=(t,e,i,s=[])=>{if("="===t[0]){let l=r(t.substring(1));return l.length<=0?t:h(l,e,(t,l)=>a(i(t,l),e,i,s),s)}return t};var o={render:a}},791:function(t,e,i){"use strict";i.r(e),i.d(e,{CellRange:function(){return l}});var s=i("2014");class l{constructor(t,e,i,s,l=0,r=0){this.sri=t,this.sci=e,this.eri=i,this.eci=s,this.w=l,this.h=r}set(t,e,i,s){this.sri=t,this.sci=e,this.eri=i,this.eci=s}multiple(){return this.eri-this.sri>0||this.eci-this.sci>0}includes(...t){let[e,i]=[0,0];1===t.length?[i,e]=(0,s.expr2xy)(t[0]):2===t.length&&([e,i]=t);let{sri:l,sci:r,eri:n,eci:h}=this;return l<=e&&e<=n&&r<=i&&i<=h}each(t,e=()=>!0){let{sri:i,sci:s,eri:l,eci:r}=this;for(let n=i;n<=l;n+=1)if(e(n))for(let e=s;e<=r;e+=1)t(n,e)}contains(t){return this.sri<=t.sri&&this.sci<=t.sci&&this.eri>=t.eri&&this.eci>=t.eci}within(t){return this.sri>=t.sri&&this.sci>=t.sci&&this.eri<=t.eri&&this.eci<=t.eci}disjoint(t){return this.sri>t.eri||this.sci>t.eci||t.sri>this.eri||t.sci>this.eci}intersects(t){return this.sri<=t.eri&&this.sci<=t.eci&&t.sri<=this.eri&&t.sci<=this.eci}union(t){let{sri:e,sci:i,eri:s,eci:r}=this;return new l(t.sri<e?t.sri:e,t.sci<i?t.sci:i,t.eri>s?t.eri:s,t.eci>r?t.eci:r)}difference(t){let e=[],i=(t,i,s,r)=>{e.push(new l(t,i,s,r))},{sri:s,sci:r,eri:n,eci:h}=this,a=t.sri-s,o=t.sci-r,c=n-t.eri,d=h-t.eci;return a>0?(i(s,r,t.sri-1,h),c>0?(i(t.eri+1,r,n,h),o>0&&i(t.sri,r,t.eri,t.sci-1),d>0&&i(t.sri,t.eci+1,t.eri,h)):(o>0&&i(t.sri,r,n,t.sci-1),d>0&&i(t.sri,t.eci+1,n,h))):c>0&&(i(t.eri+1,r,n,h),o>0&&i(s,r,t.eri,t.sci-1),d>0&&i(s,t.eci+1,t.eri,h)),o>0?(i(s,r,n,t.sci-1),d>0?(i(s,t.eri+1,n,h),a>0&&i(s,t.sci,t.sri-1,t.eci),c>0&&i(t.sri+1,t.sci,n,t.eci)):(a>0&&i(s,t.sci,t.sri-1,h),c>0&&i(t.sri+1,t.sci,n,h))):d>0&&(i(n,t.eci+1,n,h),a>0&&i(s,r,t.sri-1,t.eci),c>0&&i(t.eri+1,r,n,t.eci)),e}size(){return[this.eri-this.sri+1,this.eci-this.sci+1]}toString(){let{sri:t,sci:e,eri:i,eci:l}=this,r=(0,s.xy2expr)(e,t);return this.multiple()&&(r=`${r}:${(0,s.xy2expr)(l,i)}`),r}clone(){let{sri:t,sci:e,eri:i,eci:s,w:r,h:n}=this;return new l(t,e,i,s,r,n)}equals(t){return this.eri===t.eri&&this.eci===t.eci&&this.sri===t.sri&&this.sci===t.sci}static valueOf(t){let e=t.split(":"),[i,r]=(0,s.expr2xy)(e[0]),[n,h]=[r,i];return e.length>1&&([h,n]=(0,s.expr2xy)(e[1])),new l(r,i,n,h)}}},9861:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return s}});class s{constructor(){this.range=null,this.state="clear"}copy(t){return this.range=t,this.state="copy",this}cut(t){return this.range=t,this.state="cut",this}isCopy(){return"copy"===this.state}isCut(){return"cut"===this.state}isClear(){return"clear"===this.state}clear(){this.range=null,this.state="clear"}}},5832:function(t,e,i){"use strict";i.r(e),i.d(e,{Cols:function(){return l}});var s=i("8666");class l{constructor({len:t,width:e,indexWidth:i,minWidth:s}){this._={},this.len=t,this.width=e,this.indexWidth=i,this.minWidth=s}setData(t){t.len&&(this.len=t.len,delete t.len),this._=t}getData(){let{len:t}=this;return Object.assign({len:t},this._)}getWidth(t){if(this.isHide(t))return 0;let e=this._[t];return e&&e.width?e.width:this.width}getOrNew(t){return this._[t]=this._[t]||{},this._[t]}setWidth(t,e){this.getOrNew(t).width=e}unhide(t){let e=t;for(;e>0;)if(e-=1,this.isHide(e))this.setHide(e,!1);else break}isHide(t){let e=this._[t];return e&&e.hide}setHide(t,e){let i=this.getOrNew(t);!0===e?i.hide=!0:delete i.hide}setStyle(t,e){this.getOrNew(t).style=e}sumWidth(t,e){return s.default.rangeSum(t,e,t=>this.getWidth(t))}totalWidth(){return this.sumWidth(0,this.len)}}},7488:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return E}});var s=i("1813"),l=i("4453"),r=i("8303"),n=i("9861"),h=i("1914"),a=i("7026"),o=i("8666"),c=i("8934"),d=i("5832"),u=i("2006"),f=i("791"),g=i("2014"),p=i("2182");let m={mode:"edit",view:{height:()=>document.documentElement.clientHeight,width:()=>document.documentElement.clientWidth},showGrid:!0,showToolbar:!0,showContextmenu:!0,showBottomBar:!0,row:{len:100,height:25},col:{len:26,width:100,indexWidth:60,minWidth:60},style:{bgcolor:"#ffffff",align:"left",valign:"middle",textwrap:!1,strike:!1,underline:!1,color:"#0a0a0a",font:{name:"Arial",size:10,bold:!1,italic:!1},format:"normal"}};function v(t,e,i=()=>{}){let{merges:s}=this,l=e.clone(),[r,n]=t.size(),[h,a]=e.size();return r>h&&(l.eri=e.sri+r-1),n>a&&(l.eci=e.sci+n-1),!s.intersects(l)||(i((0,p.t)("error.pasteForMergedCell")),!1)}function w(t,e,i,s=!1){let{rows:l,merges:r}=this;("all"===i||"format"===i)&&(l.deleteCells(e,i),r.deleteWithin(e)),l.copyPaste(t,e,i,s,(t,e,i)=>{if(i&&i.merge){let[s,l]=i.merge;(!(s<=0)||!(l<=0))&&r.add(new f.CellRange(t,e,t+s,e+l))}})}function x(t,e){let{clipboard:i,rows:s,merges:l}=this;s.cutPaste(t,e),l.move(t,e.sri-t.sri,e.sci-t.sci),i.clear()}function b(t,e,i){let{styles:s,rows:l}=this,r=l.getCellOrNew(t,e),n={};void 0!==r.style&&(n=o.default.cloneDeep(s[r.style])),n=o.default.merge(n,{border:i}),r.style=this.addStyle(n)}function y({mode:t,style:e,color:i}){let{styles:s,selector:l,rows:r}=this,{sri:n,sci:h,eri:a,eci:c}=l.range,d=!this.isSingleSelected();if(!!d||"inside"!==t&&"horizontal"!==t&&"vertical"!==t)if("outside"!==t||d){if("none"===t)l.range.each((t,e)=>{let i=r.getCell(t,e);if(i&&void 0!==i.style){let t=o.default.cloneDeep(s[i.style]);delete t.border,i.style=this.addStyle(t)}});else if("all"===t||"inside"===t||"outside"===t||"horizontal"===t||"vertical"===t){let s=[];for(let l=n;l<=a;l+=1)for(let o=h;o<=c;o+=1){let u=[];for(let t=0;t<s.length;t+=1){let[e,i,r,n]=s[t];if(l===e+r+1&&u.push(t),e<=l&&l<=e+r&&o===i){o+=n+1;break}}if(u.forEach(t=>s.splice(t,1)),o>c)break;let f=r.getCell(l,o),[g,p]=[0,0];f&&f.merge&&([g,p]=f.merge,s.push([l,o,g,p]));let m=g>0&&l+g===a,v=p>0&&o+p===c,w={};"all"===t?w={bottom:[e,i],top:[e,i],left:[e,i],right:[e,i]}:"inside"===t?(!v&&o<c&&(w.right=[e,i]),!m&&l<a&&(w.bottom=[e,i])):"horizontal"===t?!m&&l<a&&(w.bottom=[e,i]):"vertical"===t?!v&&o<c&&(w.right=[e,i]):"outside"===t&&d&&(n===l&&(w.top=[e,i]),(m||a===l)&&(w.bottom=[e,i]),h===o&&(w.left=[e,i]),(v||c===o)&&(w.right=[e,i])),Object.keys(w).length>0&&b.call(this,l,o,w),o+=p}}else if("top"===t||"bottom"===t)for(let s=h;s<=c;s+=1)"top"===t&&(b.call(this,n,s,{top:[e,i]}),s+=r.getCellMerge(n,s)[1]),"bottom"===t&&(b.call(this,a,s,{bottom:[e,i]}),s+=r.getCellMerge(a,s)[1]);else if("left"===t||"right"===t)for(let s=n;s<=a;s+=1)"left"===t&&(b.call(this,s,h,{left:[e,i]}),s+=r.getCellMerge(s,h)[0]),"right"===t&&(b.call(this,s,c,{right:[e,i]}),s+=r.getCellMerge(s,c)[0])}else b.call(this,n,h,{top:[e,i],bottom:[e,i],left:[e,i],right:[e,i]})}function C(t,e){let{rows:i}=this,s=this.freezeTotalHeight(),l=i.height;s+i.height<t&&(l-=e);let r=this.exceptRowSet,n=0,h=l,{height:a}=i;for(;n<i.len&&!(h>t);n+=1)!r.has(n)&&(h+=a=i.getHeight(n));return(h-=a)<=0?{ri:-1,top:0,height:a}:{ri:n-1,top:h,height:a}}function k(t,e){let{cols:i}=this,s=this.freezeTotalWidth(),l=i.indexWidth;s+i.indexWidth<t&&(l-=e);let[r,n,h]=o.default.rangeReduceIf(0,i.len,l,i.indexWidth,t,t=>i.getWidth(t));return n<=0?{ci:-1,left:0,width:i.indexWidth}:{ci:r-1,left:n,width:h}}class E{constructor(t,e){this.settings=o.default.merge(m,e||{}),this.name=t||"sheet",this.freeze=[0,0],this.styles=[],this.merges=new a.Merges,this.rows=new c.Rows(this.settings.row),this.cols=new d.Cols(this.settings.col),this.validations=new u.Validations,this.hyperlinks={},this.comments={},this.selector=new s.default,this.scroll=new l.default,this.history=new r.default,this.clipboard=new n.default,this.autoFilter=new h.default,this.change=()=>{},this.exceptRowSet=new Set,this.sortedRowMap=new Map,this.unsortedRowMap=new Map}addValidation(t,e,i){this.changeData(()=>{this.validations.add(t,e,i)})}removeValidation(){let{range:t}=this.selector;this.changeData(()=>{this.validations.remove(t)})}getSelectedValidator(){let{ri:t,ci:e}=this.selector,i=this.validations.get(t,e);return i?i.validator:null}getSelectedValidation(){let{ri:t,ci:e,range:i}=this.selector,s=this.validations.get(t,e),l={ref:i.toString()};return null!==s&&(l.mode=s.mode,l.validator=s.validator),l}canUndo(){return this.history.canUndo()}canRedo(){return this.history.canRedo()}undo(){this.history.undo(this.getData(),t=>{this.setData(t)})}redo(){this.history.redo(this.getData(),t=>{this.setData(t)})}copy(){this.clipboard.copy(this.selector.range)}copyToSystemClipboard(t){let e=[],{sri:i,eri:s,sci:l,eci:r}=this.selector.range;for(let t=i;t<=s;t+=1){let i=[];for(let e=l;e<=r;e+=1){let s=this.getCell(t,e);i.push(s&&s.text||"")}e.push(i)}e=e.map(t=>t.join("	")).join("\n"),t&&(t.clipboardData.clearData(),t.clipboardData.setData("text/plain",e),t.preventDefault()),navigator.clipboard&&navigator.clipboard.writeText(e).then(()=>{},t=>{console.log("text copy to the system clipboard error  ",e,t)})}cut(){this.clipboard.cut(this.selector.range)}paste(t="all",e=()=>{}){let{clipboard:i,selector:s}=this;return!i.isClear()&&!!v.call(this,i.range,s.range,e)&&(this.changeData(()=>{i.isCopy()?w.call(this,i.range,s.range,t):i.isCut()&&x.call(this,i.range,s.range)}),!0)}pasteFromSystemClipboard(t,e){let{selector:i}=this;navigator.clipboard.readText().then(s=>{let l=this.parseClipboardContent(s),r=i.ri;l.forEach(t=>{let e=i.ci;t.forEach(t=>{this.setCellText(r,e,t,"input"),e+=1}),r+=1}),t(),e(this.rows.getData())})}parseClipboardContent(t){let e=[],i=t.split("\n"),s=0;return i.forEach(t=>{e[s]=t.split("	"),s+=1}),e}pasteFromText(t){let e=[];if((e=/\r\n/.test(t)?t.split("\r\n").map(t=>t.replace(/"/g,"").split("	")):t.split("\n").map(t=>t.replace(/"/g,"").split("	"))).length){let{rows:t,selector:i}=this;this.changeData(()=>{t.paste(e,i.range)})}}autofill(t,e,i=()=>{}){let s=this.selector.range;return!!v.call(this,s,t,i)&&(this.changeData(()=>{w.call(this,s,t,e,!0)}),!0)}clearClipboard(){this.clipboard.clear()}calSelectedRangeByEnd(t,e){let{selector:i,rows:s,cols:l,merges:r}=this,{sri:n,sci:h,eri:a,eci:o}=i.range,c=i.ri,d=i.ci,[u,g]=[t,e];return t<0&&(u=s.len-1),e<0&&(g=l.len-1),u>c?[n,a]=[c,u]:[n,a]=[u,c],g>d?[h,o]=[d,g]:[h,o]=[g,d],i.range=r.union(new f.CellRange(n,h,a,o)),i.range=r.union(i.range),i.range}calSelectedRangeByStart(t,e){let{selector:i,rows:s,cols:l,merges:r}=this,n=r.getFirstIncludes(t,e);return null===n&&(n=new f.CellRange(t,e,t,e),-1===t&&(n.sri=0,n.eri=s.len-1),-1===e&&(n.sci=0,n.eci=l.len-1)),i.range=n,n}setSelectedCellAttr(t,e){this.changeData(()=>{let{selector:i,styles:s,rows:l}=this;if("merge"===t)e?this.merge():this.unmerge();else if("border"===t)y.call(this,e);else if("formula"===t){let{ri:t,ci:s,range:r}=i;if(i.multiple()){let[s,n]=i.size(),{sri:h,sci:a,eri:o,eci:c}=r;if(s>1)for(let t=a;t<=c;t+=1)l.getCellOrNew(o+1,t).text=`=${e}(${(0,g.xy2expr)(t,h)}:${(0,g.xy2expr)(t,o)})`;else n>1&&(l.getCellOrNew(t,c+1).text=`=${e}(${(0,g.xy2expr)(a,t)}:${(0,g.xy2expr)(c,t)})`)}else l.getCellOrNew(t,s).text=`=${e}()`}else i.range.each((i,r)=>{let n=l.getCellOrNew(i,r),h={};if(void 0!==n.style&&(h=o.default.cloneDeep(s[n.style])),"format"===t)h.format=e,n.style=this.addStyle(h);else if("font-bold"===t||"font-italic"===t||"font-name"===t||"font-size"===t){let i={};i[t.split("-")[1]]=e,h.font=Object.assign(h.font||{},i),n.style=this.addStyle(h)}else"strike"===t||"textwrap"===t||"underline"===t||"align"===t||"valign"===t||"color"===t||"bgcolor"===t?(h[t]=e,n.style=this.addStyle(h)):n[t]=e})})}setSelectedCellText(t,e="input"){let{autoFilter:i,selector:s,rows:l}=this,{ri:r,ci:n}=s,h=r;this.unsortedRowMap.has(r)&&(h=this.unsortedRowMap.get(r));let a=l.getCell(h,n),o=a?a.text:"";if(this.setCellText(h,n,t,e),i.active()){let e=i.getFilter(n);if(e){let i=e.value.findIndex(t=>t===o);i>=0&&e.value.splice(i,1,t)}}}getSelectedCell(){let{ri:t,ci:e}=this.selector,i=t;return this.unsortedRowMap.has(t)&&(i=this.unsortedRowMap.get(t)),this.rows.getCell(i,e)}xyInSelectedRect(t,e){let{left:i,top:s,width:l,height:r}=this.getSelectedRect(),n=t-this.cols.indexWidth,h=e-this.rows.height;return n>i&&n<i+l&&h>s&&h<s+r}getSelectedRect(){return this.getRect(this.selector.range)}getClipboardRect(){let{clipboard:t}=this;return t.isClear()?{left:-100,top:-100}:this.getRect(t.range)}getRect(t){let{scroll:e,rows:i,cols:s,exceptRowSet:l}=this,{sri:r,sci:n,eri:h,eci:a}=t;if(r<0&&n<0)return{left:0,l:0,top:0,t:0,scroll:e};let o=s.sumWidth(0,n),c=i.sumHeight(0,r,l),d=i.sumHeight(r,h+1,l),u=s.sumWidth(n,a+1),f=o-e.x,g=c-e.y,p=this.freezeTotalHeight(),m=this.freezeTotalWidth();return m>0&&m>o&&(f=o),p>0&&p>c&&(g=c),{l:o,t:c,left:f,top:g,height:d,width:u,scroll:e}}getCellRectByXY(t,e){let{scroll:i,merges:s,rows:l,cols:r}=this,{ri:n,top:h,height:a}=C.call(this,e,i.y),{ci:o,left:c,width:d}=k.call(this,t,i.x);if(-1===o&&(d=r.totalWidth()),-1===n&&(a=l.totalHeight()),n>=0||o>=0){let t=s.getFirstIncludes(n,o);t&&(n=t.sri,o=t.sci,{left:c,top:h,width:d,height:a}=this.cellRect(n,o))}return{ri:n,ci:o,left:c,top:h,width:d,height:a}}isSingleSelected(){let{sri:t,sci:e,eri:i,eci:s}=this.selector.range,l=this.getCell(t,e);if(l&&l.merge){let[r,n]=l.merge;if(t+r===i&&e+n===s)return!0}return!this.selector.multiple()}canUnmerge(){let{sri:t,sci:e,eri:i,eci:s}=this.selector.range,l=this.getCell(t,e);if(l&&l.merge){let[r,n]=l.merge;if(t+r===i&&e+n===s)return!0}return!1}merge(){let{selector:t,rows:e}=this;if(this.isSingleSelected())return;let[i,s]=t.size();if(i>1||s>1){let{sri:l,sci:r}=t.range;this.changeData(()=>{let n=e.getCellOrNew(l,r);n.merge=[i-1,s-1],this.merges.add(t.range),this.rows.deleteCells(t.range),this.rows.setCell(l,r,n)})}}unmerge(){let{selector:t}=this;if(!this.isSingleSelected())return;let{sri:e,sci:i}=t.range;this.changeData(()=>{this.rows.deleteCell(e,i,"merge"),this.merges.deleteWithin(t.range)})}canAutofilter(){return!this.autoFilter.active()}autofilter(){let{autoFilter:t,selector:e}=this;this.changeData(()=>{t.active()?(t.clear(),this.exceptRowSet=new Set,this.sortedRowMap=new Map,this.unsortedRowMap=new Map):t.ref=e.range.toString()})}setAutoFilter(t,e,i,s){let{autoFilter:l}=this;l.addFilter(t,i,s),l.setSort(t,e),this.resetAutoFilter()}resetAutoFilter(){let{autoFilter:t,rows:e}=this;if(!t.active())return;let{sort:i}=t,{rset:s,fset:l}=t.filteredRows((t,i)=>e.getCell(t,i)),r=Array.from(l),n=Array.from(l);i&&r.sort((t,e)=>"asc"===i.order?t-e:"desc"===i.order?e-t:0),this.exceptRowSet=s,this.sortedRowMap=new Map,this.unsortedRowMap=new Map,r.forEach((t,e)=>{this.sortedRowMap.set(n[e],t),this.unsortedRowMap.set(t,n[e])})}deleteCell(t="all"){let{selector:e}=this;this.changeData(()=>{this.rows.deleteCells(e.range,t),("all"===t||"format"===t)&&this.merges.deleteWithin(e.range)})}insert(t,e=1){this.changeData(()=>{let{sri:i,sci:s}=this.selector.range,{rows:l,merges:r,cols:n}=this,h=i;"row"===t?l.insert(i,e):"column"===t&&(l.insertColumn(s,e),h=s,n.len+=e,Object.keys(n._).reverse().forEach(t=>{let i=parseInt(t,10);i>=s&&(n._[i+e]=n._[i],delete n._[i])})),r.shift(t,h,e,(t,e,i,s)=>{let r=l.getCell(t,e);r.merge[0]+=i,r.merge[1]+=s})})}delete(t){this.changeData(()=>{let{rows:e,merges:i,selector:s,cols:l}=this,{range:r}=s,{sri:n,sci:h,eri:a,eci:o}=s.range,[c,d]=s.range.size(),u=n,f=c;"row"===t?e.delete(n,a):"column"===t&&(e.deleteColumn(h,o),u=r.sci,f=d,l.len-=o-h+1,Object.keys(l._).forEach(t=>{let e=parseInt(t,10);e>=h&&(e>o&&(l._[e-(o-h+1)]=l._[e]),delete l._[e])})),i.shift(t,u,-f,(t,i,s,l)=>{let r=e.getCell(t,i);r.merge[0]+=s,r.merge[1]+=l,0===r.merge[0]&&0===r.merge[1]&&delete r.merge})})}scrollx(t,e){let{scroll:i,freeze:s,cols:l}=this,[,r]=s,[n,h,a]=o.default.rangeReduceIf(r,l.len,0,0,t,t=>l.getWidth(t)),c=h;t>0&&(c+=a),i.x!==c&&(i.ci=t>0?n:0,i.x=c,e())}scrolly(t,e){let{scroll:i,freeze:s,rows:l}=this,[r]=s,[n,h,a]=o.default.rangeReduceIf(r,l.len,0,0,t,t=>l.getHeight(t)),c=h;t>0&&(c+=a),i.y!==c&&(i.ri=t>0?n:0,i.y=c,e())}cellRect(t,e){let{rows:i,cols:s}=this,l=s.sumWidth(0,e),r=i.sumHeight(0,t),n=i.getCell(t,e),h=s.getWidth(e),a=i.getHeight(t);if(null!==n&&n.merge){let[l,r]=n.merge;if(l>0)for(let e=1;e<=l;e+=1)a+=i.getHeight(t+e);if(r>0)for(let t=1;t<=r;t+=1)h+=s.getWidth(e+t)}return{left:l,top:r,width:h,height:a,cell:n}}getCell(t,e){return this.rows.getCell(t,e)}getCellTextOrDefault(t,e){let i=this.getCell(t,e);return i&&i.text?i.text:""}getCellStyle(t,e){let i=this.getCell(t,e);return i&&void 0!==i.style?this.styles[i.style]:null}getCellStyleOrDefault(t,e){let{styles:i,rows:s}=this,l=s.getCell(t,e),r=l&&void 0!==l.style?i[l.style]:{};return o.default.merge(this.defaultStyle(),r)}getSelectedCellStyle(){let{ri:t,ci:e}=this.selector;return this.getCellStyleOrDefault(t,e)}setCellText(t,e,i,s){let{rows:l,history:r,validations:n}=this;"finished"===s?(l.setCellText(t,e,""),r.add(this.getData()),l.setCellText(t,e,i)):(l.setCellText(t,e,i),this.change(this.getData())),n.validate(t,e,i)}freezeIsActive(){let[t,e]=this.freeze;return t>0||e>0}setFreeze(t,e){this.changeData(()=>{this.freeze=[t,e]})}freezeTotalWidth(){return this.cols.sumWidth(0,this.freeze[1])}freezeTotalHeight(){return this.rows.sumHeight(0,this.freeze[0])}setRowHeight(t,e){this.changeData(()=>{this.rows.setHeight(t,e)})}setColWidth(t,e){this.changeData(()=>{this.cols.setWidth(t,e)})}viewHeight(){let{view:t,showToolbar:e,showBottomBar:i}=this.settings,s=t.height();return i&&(s-=41),e&&(s-=41),s}viewWidth(){return this.settings.view.width()}freezeViewRange(){let[t,e]=this.freeze;return new f.CellRange(0,0,t-1,e-1,this.freezeTotalWidth(),this.freezeTotalHeight())}contentRange(){let{rows:t,cols:e}=this,[i,s]=t.maxCell(),l=t.sumHeight(0,i+1),r=e.sumWidth(0,s+1);return new f.CellRange(0,0,i,s,r,l)}exceptRowTotalHeight(t,e){let{exceptRowSet:i,rows:s}=this,l=Array.from(i),r=0;return l.forEach(i=>{if(i<t||i>e){let t=s.getHeight(i);r+=t}}),r}viewRange(){let{scroll:t,rows:e,cols:i,freeze:s,exceptRowSet:l}=this,{ri:r,ci:n}=t;r<=0&&([r]=s),n<=0&&([,n]=s);let[h,a]=[0,0],[o,c]=[e.len,i.len];for(let t=r;t<e.len&&(!l.has(t)&&(a+=e.getHeight(t),o=t),!(a>this.viewHeight()));t+=1);for(let t=n;t<i.len&&(h+=i.getWidth(t),c=t,!(h>this.viewWidth()));t+=1);return new f.CellRange(r,n,o,c,h,a)}eachMergesInView(t,e){this.merges.filterIntersects(t).forEach(t=>e(t))}hideRowsOrCols(){let{rows:t,cols:e,selector:i}=this,[s,l]=i.size(),{sri:r,sci:n,eri:h,eci:a}=i.range;if(s===t.len)for(let t=n;t<=a;t+=1)e.setHide(t,!0);else if(l===e.len)for(let e=r;e<=h;e+=1)t.setHide(e,!0)}unhideRowsOrCols(t,e){this[`${t}s`].unhide(e)}rowEach(t,e,i){let s=0,{rows:l}=this,r=this.exceptRowSet,n=[...r],h=0;for(let e=0;e<n.length;e+=1)n[e]<t&&(h+=1);for(let n=t+h;n<=e+h;n+=1)if(r.has(n))h+=1;else{let t=l.getHeight(n);if(t>0&&(i(n,s,t),(s+=t)>this.viewHeight()))break}}colEach(t,e,i){let s=0,{cols:l}=this;for(let r=t;r<=e;r+=1){let t=l.getWidth(r);if(t>0&&(i(r,s,t),(s+=t)>this.viewWidth()))break}}defaultStyle(){return this.settings.style}addStyle(t){let{styles:e}=this;for(let i=0;i<e.length;i+=1){let s=e[i];if(o.default.equals(s,t))return i}return e.push(t),e.length-1}changeData(t){this.history.add(this.getData()),t(),this.change(this.getData())}setData(t){return Object.keys(t).forEach(e=>{if("merges"===e||"rows"===e||"cols"===e||"validations"===e)this[e].setData(t[e]);else if("freeze"===e){let[i,s]=(0,g.expr2xy)(t[e]);this.freeze=[s,i]}else"autofilter"===e?this.autoFilter.setData(t[e]):void 0!==t[e]&&(this[e]=t[e])}),this}getData(){let{name:t,freeze:e,styles:i,merges:s,rows:l,cols:r,validations:n,autoFilter:h}=this;return{name:t,freeze:(0,g.xy2expr)(e[1],e[0]),styles:i,merges:s.getData(),rows:l.getData(),cols:r.getData(),validations:n.getData(),autofilter:h.getData()}}}},1933:function(t,e,i){"use strict";i.r(e),i.d(e,{fontSizes:function(){return l},baseFonts:function(){return s},getFontSizePxByPt:function(){return r}});let s=[{key:"Arial",title:"Arial"},{key:"Helvetica",title:"Helvetica"},{key:"Source Sans Pro",title:"Source Sans Pro"},{key:"Comic Sans MS",title:"Comic Sans MS"},{key:"Courier New",title:"Courier New"},{key:"Verdana",title:"Verdana"},{key:"Lato",title:"Lato"}],l=[{pt:7.5,px:10},{pt:8,px:11},{pt:9,px:12},{pt:10,px:13},{pt:10.5,px:14},{pt:11,px:15},{pt:12,px:16},{pt:14,px:18.7},{pt:15,px:20},{pt:16,px:21.3},{pt:18,px:24},{pt:22,px:29.3},{pt:24,px:32},{pt:26,px:34.7},{pt:36,px:48},{pt:42,px:56}];function r(t){for(let e=0;e<l.length;e+=1){let i=l[e];if(i.pt===t)return i.px}return t}},5854:function(t,e,i){"use strict";i.r(e),i.d(e,{formatm:function(){return h},baseFormats:function(){return n}});var s=i("2182");let l=t=>t,r=t=>{if(/^(-?\d*.?\d*)$/.test(t)){let[e,...i]=Number(t).toFixed(2).toString().split("\\.");return[e.replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"),...i]}return t},n=[{key:"normal",title:(0,s.tf)("format.normal"),type:"string",render:l},{key:"text",title:(0,s.tf)("format.text"),type:"string",render:l},{key:"number",title:(0,s.tf)("format.number"),type:"number",label:"1,000.12",render:r},{key:"percent",title:(0,s.tf)("format.percent"),type:"number",label:"10.12%",render:t=>`${t}%`},{key:"rmb",title:(0,s.tf)("format.rmb"),type:"number",label:"￥10.00",render:t=>`￥${r(t)}`},{key:"usd",title:(0,s.tf)("format.usd"),type:"number",label:"$10.00",render:t=>`$${r(t)}`},{key:"eur",title:(0,s.tf)("format.eur"),type:"number",label:"€10.00",render:t=>`€${r(t)}`},{key:"date",title:(0,s.tf)("format.date"),type:"date",label:"26/09/2008",render:l},{key:"time",title:(0,s.tf)("format.time"),type:"date",label:"15:59:00",render:l},{key:"datetime",title:(0,s.tf)("format.datetime"),type:"date",label:"26/09/2008 15:59:00",render:l},{key:"duration",title:(0,s.tf)("format.duration"),type:"date",label:"24:01:00",render:l}],h={};n.forEach(t=>{h[t.key]=t})},4913:function(t,e,i){"use strict";i.r(e),i.d(e,{formulam:function(){return h},formulas:function(){return n},baseFormulas:function(){return r}});var s=i("2182"),l=i("8666");let r=[{key:"SUM",title:(0,s.tf)("formula.sum"),render:t=>t.reduce((t,e)=>(0,l.numberCalc)("+",t,e),0)},{key:"AVERAGE",title:(0,s.tf)("formula.average"),render:t=>t.reduce((t,e)=>Number(t)+Number(e),0)/t.length},{key:"MAX",title:(0,s.tf)("formula.max"),render:t=>Math.max(...t.map(t=>Number(t)))},{key:"MIN",title:(0,s.tf)("formula.min"),render:t=>Math.min(...t.map(t=>Number(t)))},{key:"IF",title:(0,s.tf)("formula._if"),render:([t,e,i])=>t?e:i},{key:"AND",title:(0,s.tf)("formula.and"),render:t=>t.every(t=>t)},{key:"OR",title:(0,s.tf)("formula.or"),render:t=>t.some(t=>t)},{key:"CONCAT",title:(0,s.tf)("formula.concat"),render:t=>t.join("")}],n=r,h={};r.forEach(t=>{h[t.key]=t})},8666:function(t,e,i){"use strict";i.r(e),i.d(e,{numberCalc:function(){return r},default:function(){return n}});let s=(t={},...e)=>(e.forEach(e=>{Object.keys(e).forEach(i=>{let l=e[i];"string"==typeof l||"number"==typeof l||"boolean"==typeof l?t[i]=l:"function"!=typeof l&&!Array.isArray(l)&&l instanceof Object?(t[i]=t[i]||{},s(t[i],l)):t[i]=l})}),t);function l(t){let e=`${t}`,i=0,s=!1;for(let t=0;t<e.length;t+=1)!0===s&&(i+=1),"."===e.charAt(t)&&(s=!0);return i}function r(t,e,i){if(Number.isNaN(e)||Number.isNaN(i))return e+t+i;let s=l(e),r=l(i),n=Number(e),h=Number(i),a=0;if("-"===t)a=n-h;else if("+"===t)a=n+h;else if("*"===t)a=n*h;else if("/"===t)return l(a=n/h)>5?a.toFixed(2):a;return a.toFixed(Math.max(s,r))}var n={cloneDeep:function(t){return JSON.parse(JSON.stringify(t))},merge:(...t)=>s({},...t),equals:function t(e,i){let s=Object.keys(e);if(s.length!==Object.keys(i).length)return!1;for(let l=0;l<s.length;l+=1){let r=s[l],n=e[r],h=i[r];if(void 0===h)return!1;if("string"==typeof n||"number"==typeof n||"boolean"==typeof n){if(n!==h)return!1}else if(Array.isArray(n)){if(n.length!==h.length)return!1;for(let e=0;e<n.length;e+=1)if(!t(n[e],h[e]))return!1}else if("function"!=typeof n&&!Array.isArray(n)&&n instanceof Object&&!t(n,h))return!1}return!0},arrayEquals:function(t,e){if(t.length!==e.length)return!1;for(let i=0;i<t.length;i+=1)if(t[i]!==e[i])return!1;return!0},sum:(t,e=t=>t)=>{let i=0,s=0;return Object.keys(t).forEach(l=>{i+=e(t[l],l),s+=1}),[i,s]},rangeEach:function(t,e,i){for(let s=t;s<e;s+=1)i(s)},rangeSum:function(t,e,i){let s=0;for(let l=t;l<e;l+=1)s+=i(l);return s},rangeReduceIf:function(t,e,i,s,l,r){let n=i,h=s,a=t;for(;a<e&&!(n>l);a+=1)n+=h=r(a);return[a,n-h,h]},deleteProperty:function(t,e){let i=t[`${e}`];return delete t[`${e}`],i},numberCalc:r}},8303:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return s}});class s{constructor(){this.undoItems=[],this.redoItems=[]}add(t){this.undoItems.push(JSON.stringify(t)),this.redoItems=[]}canUndo(){return this.undoItems.length>0}canRedo(){return this.redoItems.length>0}undo(t,e){let{undoItems:i,redoItems:s}=this;this.canUndo()&&(s.push(JSON.stringify(t)),e(JSON.parse(i.pop())))}redo(t,e){let{undoItems:i,redoItems:s}=this;this.canRedo()&&(i.push(JSON.stringify(t)),e(JSON.parse(s.pop())))}}},7026:function(t,e,i){"use strict";i.r(e),i.d(e,{Merges:function(){return l}});var s=i("791");class l{constructor(t=[]){this._=t}forEach(t){this._.forEach(t)}deleteWithin(t){this._=this._.filter(e=>!e.within(t))}getFirstIncludes(t,e){for(let i=0;i<this._.length;i+=1){let s=this._[i];if(s.includes(t,e))return s}return null}filterIntersects(t){return new l(this._.filter(e=>e.intersects(t)))}intersects(t){for(let e=0;e<this._.length;e+=1)if(this._[e].intersects(t))return!0;return!1}union(t){let e=t;return this._.forEach(t=>{t.intersects(e)&&(e=t.union(e))}),e}add(t){this.deleteWithin(t),this._.push(t)}shift(t,e,i,s){this._.forEach(l=>{let{sri:r,sci:n,eri:h,eci:a}=l;"row"===t?r>=e?(l.sri+=i,l.eri+=i):r<e&&e<=h&&(l.eri+=i,s(r,n,i,0)):"column"===t&&(n>=e?(l.sci+=i,l.eci+=i):n<e&&e<=a&&(l.eci+=i,s(r,n,0,i)))})}move(t,e,i){this._.forEach(s=>{s.within(t)&&(s.eri+=e,s.sri+=e,s.sci+=i,s.eci+=i)})}setData(t){return this._=t.map(t=>s.CellRange.valueOf(t)),this}getData(){return this._.map(t=>t.toString())}}},8934:function(t,e,i){"use strict";i.r(e),i.d(e,{Rows:function(){return r}});var s=i("8666"),l=i("2014");class r{constructor({len:t,height:e}){this._={},this.len=t,this.height=e}getHeight(t){if(this.isHide(t))return 0;let e=this.get(t);return e&&e.height?e.height:this.height}setHeight(t,e){this.getOrNew(t).height=e}unhide(t){let e=t;for(;e>0;)if(e-=1,this.isHide(e))this.setHide(e,!1);else break}isHide(t){let e=this.get(t);return e&&e.hide}setHide(t,e){let i=this.getOrNew(t);!0===e?i.hide=!0:delete i.hide}setStyle(t,e){this.getOrNew(t).style=e}sumHeight(t,e,i){return s.default.rangeSum(t,e,t=>i&&i.has(t)?0:this.getHeight(t))}totalHeight(){return this.sumHeight(0,this.len)}get(t){return this._[t]}getOrNew(t){return this._[t]=this._[t]||{cells:{}},this._[t]}getCell(t,e){let i=this.get(t);return void 0!==i&&void 0!==i.cells&&void 0!==i.cells[e]?i.cells[e]:null}getCellMerge(t,e){let i=this.getCell(t,e);return i&&i.merge?i.merge:[0,0]}getCellOrNew(t,e){let i=this.getOrNew(t);return i.cells[e]=i.cells[e]||{},i.cells[e]}setCell(t,e,i,s="all"){let l=this.getOrNew(t);"all"===s?l.cells[e]=i:"text"===s?(l.cells[e]=l.cells[e]||{},l.cells[e].text=i.text):"format"===s&&(l.cells[e]=l.cells[e]||{},l.cells[e].style=i.style,i.merge&&(l.cells[e].merge=i.merge))}setCellText(t,e,i){let s=this.getCellOrNew(t,e);!1!==s.editable&&(s.text=i)}copyPaste(t,e,i,r=!1,n=()=>{}){let{sri:h,sci:a,eri:o,eci:c}=t,d=e.sri,u=e.sci,f=e.eri,g=e.eci,[p,m]=t.size(),[v,w]=e.size(),x=!0,b=0;(f<h||g<a)&&(x=!1,b=f<h?v:w);for(let t=h;t<=o;t+=1)if(this._[t]){for(let e=a;e<=c;e+=1)if(this._[t].cells&&this._[t].cells[e])for(let v=d;v<=f;v+=p)for(let w=u;w<=g;w+=m){let y=v+(t-h),C=w+(e-a),k=s.default.cloneDeep(this._[t].cells[e]);if(r&&k&&k.text&&k.text.length>0){let{text:t}=k,e=w-u+(v-d)+2;if(!x&&(e-=b+1),"="===t[0])k.text=t.replace(/[a-zA-Z]{1,3}\d+/g,t=>{let[i,s]=[0,0];return(h===d?i=e-1:s=e-1,/^\d+$/.test(t))?t:(0,l.expr2expr)(t,i,s)});else if(p<=1&&m>1&&(d>o||f<h)||m<=1&&p>1&&(u>c||g<a)||p<=1&&m<=1){let i=/[\\.\d]+$/.exec(t);if(null!==i){let s=Number(i[0])+e-1;k.text=t.substring(0,i.index)+s}}}this.setCell(y,C,k,i),n(y,C,k)}}}cutPaste(t,e){let i={};this.each(s=>{this.eachCells(s,l=>{let r=parseInt(s,10),n=parseInt(l,10);t.includes(s,l)&&(r=e.sri+(r-t.sri),n=e.sci+(n-t.sci)),i[r]=i[r]||{cells:{}},i[r].cells[n]=this._[s].cells[l]})}),this._=i}paste(t,e){if(t.length<=0)return;let{sri:i,sci:s}=e;t.forEach((t,e)=>{let l=i+e;t.forEach((t,e)=>{this.setCellText(l,s+e,t)})})}insert(t,e=1){let i={};this.each((s,r)=>{let n=parseInt(s,10);n>=t&&(n+=e,this.eachCells(s,(i,s)=>{s.text&&"="===s.text[0]&&(s.text=s.text.replace(/[a-zA-Z]{1,3}\d+/g,i=>(0,l.expr2expr)(i,0,e,(e,i)=>i>=t)))})),i[n]=r}),this._=i,this.len+=e}delete(t,e){let i=e-t+1,s={};this.each((r,n)=>{let h=parseInt(r,10);h<t?s[h]=n:r>e&&(s[h-i]=n,this.eachCells(r,(t,s)=>{s.text&&"="===s.text[0]&&(s.text=s.text.replace(/[a-zA-Z]{1,3}\d+/g,t=>(0,l.expr2expr)(t,0,-i,(t,i)=>i>e)))}))}),this._=s,this.len-=i}insertColumn(t,e=1){this.each((i,s)=>{let r={};this.eachCells(i,(i,s)=>{let n=parseInt(i,10);n>=t&&(n+=e,s.text&&"="===s.text[0]&&(s.text=s.text.replace(/[a-zA-Z]{1,3}\d+/g,i=>(0,l.expr2expr)(i,e,0,e=>e>=t)))),r[n]=s}),s.cells=r})}deleteColumn(t,e){let i=e-t+1;this.each((s,r)=>{let n={};this.eachCells(s,(s,r)=>{let h=parseInt(s,10);h<t?n[h]=r:h>e&&(n[h-i]=r,r.text&&"="===r.text[0]&&(r.text=r.text.replace(/[a-zA-Z]{1,3}\d+/g,t=>(0,l.expr2expr)(t,-i,0,t=>t>e))))}),r.cells=n})}deleteCells(t,e="all"){t.each((t,i)=>{this.deleteCell(t,i,e)})}deleteCell(t,e,i="all"){let s=this.get(t);if(null!==s){let l=this.getCell(t,e);null!==l&&!1!==l.editable&&("all"===i?delete s.cells[e]:"text"===i?(l.text&&delete l.text,l.value&&delete l.value):"format"===i?(void 0!==l.style&&delete l.style,l.merge&&delete l.merge):"merge"===i&&l.merge&&delete l.merge)}}maxCell(){let t=Object.keys(this._),e=t[t.length-1],i=this._[e];if(i){let{cells:t}=i,s=Object.keys(t),l=s[s.length-1];return[parseInt(e,10),parseInt(l,10)]}return[0,0]}each(t){Object.entries(this._).forEach(([e,i])=>{t(e,i)})}eachCells(t,e){this._[t]&&this._[t].cells&&Object.entries(this._[t].cells).forEach(([t,i])=>{e(t,i)})}setData(t){t.len&&(this.len=t.len,delete t.len),this._=t}getData(){let{len:t}=this;return Object.assign({len:t},this._)}}},4453:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return s}});class s{constructor(){this.x=0,this.y=0,this.ri=0,this.ci=0}}},1813:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return l}});var s=i("791");class l{constructor(){this.range=new s.CellRange(0,0,0,0),this.ri=0,this.ci=0}multiple(){return this.range.multiple()}setIndexes(t,e){this.ri=t,this.ci=e}size(){return this.range.size()}}},2006:function(t,e,i){"use strict";i.r(e),i.d(e,{Validations:function(){return n}});var s=i("5718"),l=i("791");class r{constructor(t,e,i){this.refs=e,this.mode=t,this.validator=i}includes(t,e){let{refs:i}=this;for(let s=0;s<i.length;s+=1)if(l.CellRange.valueOf(i[s]).includes(t,e))return!0;return!1}addRef(t){this.remove(l.CellRange.valueOf(t)),this.refs.push(t)}remove(t){let e=[];this.refs.forEach(i=>{let s=l.CellRange.valueOf(i);s.intersects(t)?s.difference(t).forEach(t=>e.push(t.toString())):e.push(i)}),this.refs=e}getData(){let{refs:t,mode:e,validator:i}=this,{type:s,required:l,operator:r,value:n}=i;return{refs:t,mode:e,type:s,required:l,operator:r,value:n}}static valueOf({refs:t,mode:e,type:i,required:l,operator:n,value:h}){return new r(e,t,new s.default(i,l,h,n))}}class n{constructor(){this._=[],this.errors=new Map}getError(t,e){return this.errors.get(`${t}_${e}`)}validate(t,e,i){let s=this.get(t,e),l=`${t}_${e}`,{errors:r}=this;if(null!==s){let[t,e]=s.validator.validate(i);t?r.delete(l):r.set(l,e)}else r.delete(l);return!0}add(t,e,{type:i,required:l,value:n,operator:h}){let a=new s.default(i,l,n,h),o=this.getByValidator(a);null!==o?o.addRef(e):this._.push(new r(t,[e],a))}getByValidator(t){for(let e=0;e<this._.length;e+=1){let i=this._[e];if(i.validator.equals(t))return i}return null}get(t,e){for(let i=0;i<this._.length;i+=1){let s=this._[i];if(s.includes(t,e))return s}return null}remove(t){this.each(e=>{e.remove(t)})}each(t){this._.forEach(e=>t(e))}getData(){return this._.filter(t=>t.refs.length>0).map(t=>t.getData())}setData(t){this._=t.map(t=>r.valueOf(t))}}},5718:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return h}});var s=i("2182"),l=i("8666");let r={phone:/^[1-9]\d{10}$/,email:/w+([-+.]w+)*@w+([-.]w+)*.w+([-.]w+)*/};function n(t,e,...i){let l="";return!t&&(l=(0,s.t)(`validation.${e}`,...i)),[t,l]}class h{constructor(t,e,i,s){this.required=e,this.value=i,this.type=t,this.operator=s,this.message=""}parseValue(t){let{type:e}=this;return"date"===e?new Date(t):"number"===e?Number(t):t}equals(t){let e=this.type===t.type&&this.required===t.required&&this.operator===t.operator;return e&&(e=Array.isArray(this.value)?l.default.arrayEquals(this.value,t.value):this.value===t.value),e}values(){return this.value.split(",")}validate(t){let{required:e,operator:i,value:s,type:l}=this;if(e&&/^\s*$/.test(t))return n(!1,"required");if(/^\s*$/.test(t))return[!0];if(r[l]&&!r[l].test(t))return n(!1,"notMatch");if("list"===l)return n(this.values().includes(t),"notIn");if(i){let e=this.parseValue(t);if("be"===i){let[t,i]=s;return n(e>=this.parseValue(t)&&e<=this.parseValue(i),"between",t,i)}if("nbe"===i){let[t,i]=s;return n(e<this.parseValue(t)||e>this.parseValue(i),"notBetween",t,i)}if("eq"===i)return n(e===this.parseValue(s),"equal",s);if("neq"===i)return n(e!==this.parseValue(s),"notEqual",s);if("lt"===i)return n(e<this.parseValue(s),"lessThan",s);if("lte"===i)return n(e<=this.parseValue(s),"lessThanEqual",s);if("gt"===i)return n(e>this.parseValue(s),"greaterThan",s);if("gte"===i)return n(e>=this.parseValue(s),"greaterThanEqual",s)}return[!0]}}},5151:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return d},spreadsheet:function(){return c}});var s=i("3129"),l=i("7488"),r=i("2367"),n=i("8467"),h=i("91"),a=i("2182");i("9500");class o{constructor(t,e={}){let i=t;this.options={showBottomBar:!0,...e},this.sheetIndex=1,this.datas=[],"string"==typeof t&&(i=document.querySelector(t)),this.bottombar=this.options.showBottomBar?new n.default(()=>{if("read"===this.options.mode)return;let t=this.addSheet();this.sheet.resetData(t)},t=>{let e=this.datas[t];this.sheet.resetData(e)},()=>{this.deleteSheet()},(t,e)=>{this.datas[t].name=e,this.sheet.trigger("change")}):null,this.data=this.addSheet();let l=(0,s.h)("div",`${h.cssPrefix}`).on("contextmenu",t=>t.preventDefault());i.appendChild(l.el),this.sheet=new r.default(l,this.data),null!==this.bottombar&&l.child(this.bottombar.el)}addSheet(t,e=!0){let i=t||`sheet${this.sheetIndex}`,s=new l.default(i,this.options);return s.change=(...t)=>{this.sheet.trigger("change",...t)},this.datas.push(s),null!==this.bottombar&&this.bottombar.addItem(i,e,this.options),this.sheetIndex+=1,s}deleteSheet(){if(null===this.bottombar)return;let[t,e]=this.bottombar.deleteItem();t>=0&&(this.datas.splice(t,1),e>=0&&this.sheet.resetData(this.datas[e]),this.sheet.trigger("change"))}loadData(t){let e=Array.isArray(t)?t:[t];if(null!==this.bottombar&&this.bottombar.clear(),this.datas=[],e.length>0)for(let t=0;t<e.length;t+=1){let i=e[t],s=this.addSheet(i.name,0===t);s.setData(i),0===t&&this.sheet.resetData(s)}return this}getData(){return this.datas.map(t=>t.getData())}cellText(t,e,i,s=0){return this.datas[s].setCellText(t,e,i,"finished"),this}cell(t,e,i=0){return this.datas[i].getCell(t,e)}cellStyle(t,e,i=0){return this.datas[i].getCellStyle(t,e)}reRender(){return this.sheet.table.render(),this}on(t,e){return this.sheet.on(t,e),this}validate(){let{validations:t}=this.data;return t.errors.size<=0}change(t){return this.sheet.on("change",t),this}static locale(t,e){(0,a.locale)(t,e)}}let c=(t,e={})=>new o(t,e);window&&(window.x_spreadsheet=c,window.x_spreadsheet.locale=(t,e)=>(0,a.locale)(t,e));var d=o},156:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return s}});var s={toolbar:{undo:"Undo",redo:"Redo",print:"Print",paintformat:"Paint format",clearformat:"Clear format",format:"Format",fontName:"Font",fontSize:"Font size",fontBold:"Font bold",fontItalic:"Font italic",underline:"Underline",strike:"Strike",color:"Text color",bgcolor:"Fill color",border:"Borders",merge:"Merge cells",align:"Horizontal align",valign:"Vertical align",textwrap:"Text wrapping",freeze:"Freeze cell",autofilter:"Filter",formula:"Functions",more:"More"},contextmenu:{copy:"Copy",cut:"Cut",paste:"Paste",pasteValue:"Paste values only",pasteFormat:"Paste format only",hide:"Hide",insertRow:"Insert row",insertColumn:"Insert column",deleteSheet:"Delete",deleteRow:"Delete row",deleteColumn:"Delete column",deleteCell:"Delete cell",deleteCellText:"Delete cell text",validation:"Data validations",cellprintable:"Enable export",cellnonprintable:"Disable export",celleditable:"Enable editing",cellnoneditable:"Disable editing"},print:{size:"Paper size",orientation:"Page orientation",orientations:["Landscape","Portrait"]},format:{normal:"Normal",text:"Plain Text",number:"Number",percent:"Percent",rmb:"RMB",usd:"USD",eur:"EUR",date:"Date",time:"Time",datetime:"Date time",duration:"Duration"},formula:{sum:"Sum",average:"Average",max:"Max",min:"Min",_if:"IF",and:"AND",or:"OR",concat:"Concat"},validation:{required:"it must be required",notMatch:"it not match its validation rule",between:"it is between {} and {}",notBetween:"it is not between {} and {}",notIn:"it is not in list",equal:"it equal to {}",notEqual:"it not equal to {}",lessThan:"it less than {}",lessThanEqual:"it less than or equal to {}",greaterThan:"it greater than {}",greaterThanEqual:"it greater than or equal to {}"},error:{pasteForMergedCell:"Unable to do this for merged cells"},calendar:{weeks:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"]},button:{next:"Next",cancel:"Cancel",remove:"Remove",save:"Save",ok:"OK"},sort:{desc:"Sort Z -> A",asc:"Sort A -> Z"},filter:{empty:"empty"},dataValidation:{mode:"Mode",range:"Cell Range",criteria:"Criteria",modeType:{cell:"Cell",column:"Colun",row:"Row"},type:{list:"List",number:"Number",date:"Date",phone:"Phone",email:"Email"},operator:{be:"between",nbe:"not betwwen",lt:"less than",lte:"less than or equal to",gt:"greater than",gte:"greater than or equal to",eq:"equal to",neq:"not equal to"}}}},2182:function(t,e,i){"use strict";i.r(e),i.d(e,{locale:function(){return o},t:function(){return h},tf:function(){return a}});var s=i("156");let l=["en"],r={en:s.default};function n(t,e){if(e)for(let i of l){if(!e[i])break;let s=e[i],l=t.match(/(?:\\.|[^.])+/g);for(let t=0;t<l.length;t+=1){let e=s[l[t]];if(!e)break;if(t===l.length-1)return e;s=e}}}function h(t){let e=n(t,r);return!e&&window&&window.x_spreadsheet&&window.x_spreadsheet.$messages&&(e=n(t,window.x_spreadsheet.$messages)),e||""}function a(t){return()=>h(t)}function o(t,e,i=!1){i?l=[t]:l.unshift(t),e&&(r[t]=e)}},227:function(t,e,i){"use strict";t.exports=i.p+"0a130caac2e225758721.svg"},9500:function(t,e,i){}},e={};function i(s){var l=e[s];if(void 0!==l)return l.exports;var r=e[s]={exports:{}};return t[s](r,r.exports,i),r.exports}i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||Function("return this")()}catch(t){if("object"==typeof window)return window}}(),i.d=function(t,e){for(var s in e)i.o(e,s)&&!i.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},!function(){i.g.importScripts&&(t=i.g.location+"");var t,e=i.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var s=e.getElementsByTagName("script");if(s.length){for(var l=s.length-1;l>-1&&!t;)t=s[l--].src}}if(!t)throw Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=t}();var s=i("5151");module.exports=s}();
//# sourceMappingURL=xspreadsheet.js.map