<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title><%= htmlWebpackPlugin.options.title %></title>
    
</head>
<body onload="load()">
  <div style="position: fixed; right: 0; top: .3em;">
  <iframe src="https://ghbtns.com/github-btn.html?user=myliang&repo=x-spreadsheet&type=star&count=true&size=large" frameborder="0" scrolling="0" width="160px" height="30px"></iframe>
  </div>
  <lable>import backup
  <input type="file" id="import-backup">
  </lable>
  <a id="json-backup-export" href="#">
    <svg width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
      <path fill="#000000" fill-rule="evenodd" d="M9.5,7 L7,7 L7,0 L5,0 L5,7 L2.5,7 L6,10.5 L9.5,7 L9.5,7 Z M0,12 L0,14 L12,14 L12,12 L0,12 L0,12 Z" transform="translate(3 2)"/>
    </svg>json</a>
  <a id="cvs-backup-export" href="#">
    <svg width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
      <path fill="#000000" fill-rule="evenodd" d="M9.5,7 L7,7 L7,0 L5,0 L5,7 L2.5,7 L6,10.5 L9.5,7 L9.5,7 Z M0,12 L0,14 L12,14 L12,12 L0,12 L0,12 Z" transform="translate(3 2)"/>
    </svg>cvs</a>
  <div id="x-spreadsheet-demo"></div>
  <script>
    function load(){
      // x.spreadsheet.locale('zh-cn');
      let state = {
        freeze: 'A2',
        styles: [
          {
            bgcolor: '#f4f5f8',
            textwrap: true,
            color: '#900b09',
            border: {
              top: ['thin', '#0366d6'],
              bottom: ['thin', '#0366d6'],
              right: ['thin', '#0366d6'],
              left: ['thin', '#0366d6'],
            },
          },
        ],
        merges: [
          'C3:D4',
        ],
        rows: {
          1: {
            cells: {
              0: { text: 'testingtesttestetst' },
              2: { text: 'testing' },
            },
          },
          2: {
            cells: {
              0: { text: 'render', style: 0 },
              1: { text: 'Hello' },
              2: { text: 'haha', merge: [1, 1] },
            }
          },
          8: {
            cells: {
              8: { text: 'border test', style: 0 },
            }
          }
        },
      };

      // x.spreadsheet.locale('zh-cn');
      const xs = x.spreadsheet('#x-spreadsheet-demo', {showToolbar: true, showGrid: true})
      xs.loadData(state).change((cdata) => {
        console.log(cdata);
        // console.log(xs.validate());
      });

      document.getElementById('json-backup-export').addEventListener('click', e => {
        e.target.href = BackupHandler.getDownloadButtonHrefValue({state});
        e.target.download = BackupHandler.getDownloadName();
      });

      document.getElementById('cvs-backup-export').addEventListener('click', e => {
        e.target.href = BackupHandler.getDownloadButtonHrefValue({state, useJson: false});
        e.target.download = BackupHandler.getDownloadName({fileType: 'csv'});
      });

      const importBtn = document.getElementById('import-backup');
      importBtn.addEventListener('change', e => {
        BackupHandler.importBackupFile({file: e.target.files[0], xs, state, debug: true});
      });
    }
  </script>
  <!--script type="text/javascript" src="https://unpkg.com/x-data-spreadsheet@1.0.20/dist/locale/zh-cn.js"></script-->
</body>
</html>
